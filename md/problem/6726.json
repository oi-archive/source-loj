{"title":"「eJOI2018」互素树 加强版","time_limit":1000,"memory_limit":256,"tags":["模拟退火","随机化","提交答案"],"operation":{"submit":"https://loj.ac/problem/6726#submit_code","submissions":"https://loj.ac/submissions?problem_id=6726","statistics":"https://loj.ac/problem/6726/statistics/fastest","testdata":"https://loj.ac/problem/6726/testdata","discussion":"https://loj.ac/discussion/problem/6726"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"本题为[「eJOI2018」互素树](https://loj.ac/problem/2817) 加强版。\r\n\r\n设有一棵有 $n$ 个结点的树，其结点编号为 $1$ 到 $n$ 。  \r\n对于其中的任意一条边 $(u, v)$ ，如果存在一个正整数 $d>1$ 满足 $ d \\mid u, d\\mid v$ ，我们称它为一条**坏的边**。  \r\n下图中的树有三条坏的边—— $(6, 4)$（都被 $2$ 整除）， $(2, 6)$（都被 $2$ 整除）， $(3, 6)$（都被 $3$ 整除）。\r\n\r\n![](https://i.loli.net/2018/08/17/5b7633a4ceb38.png)\r\n\r\n你的任务是将结点重新编号，使得图中坏的边的数量尽量少。  \r\n对于上图中的树，按照下图中的方式将结点重新编号，会只剩一条坏的边 $(3, 6)$ 。\r\n\r\n![](https://i.loli.net/2018/08/17/5b7633a4cfebf.png)\r\n\r\n重新编号后，坏的边越少，你的得分越高。\r\n\r\n**这是一道提交答案题。你应当点击上方的「附加文件」下载输入文件（其中，00为样例，01~05为测试数据；无需提交样例的答案），然后在本地运行你的程序，将输出结果上传。**"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"每个测试点中有多组测试数据。  \r\n第一行，一个整数 $T$，表示测试数据组数。  \r\n每组测试数据共 $n$ 行，其中 $n$ 表示树的结点个数。  \r\n第一行，一个整数 $n$；  \r\n接下来 $n-1$ 行，每行两个整数 $u$ 和 $v\\ ( 1 \\le u, v \\le n)$，表示一条边 $(u,v)$ 。\r\n**每个输入文件中，每棵树的结点个数相同。**"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"对于每组测试数据，输出一行 $n$ 个整数，表示原先编号为 $1$ 到 $n$ 的结点的新编号。   \r\n**每个结点的编号必须不同，也就是说同一组测试数据中输出的 $n$ 个整数必须互不相同。**"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 输入样例\r\n```\r\n2\r\n6\r\n1 3\r\n3 5\r\n3 6\r\n6 4\r\n6 2\r\n6\r\n1 2\r\n1 3\r\n1 4\r\n1 5\r\n1 6\r\n```\r\n#### 输出样例 1\r\n```\r\n2 5 3 1 4 6\r\n5 1 2 3 4 6\r\n```\r\n\r\n#### 输出样例 2\r\n```\r\n4 5 1 3 6 2 \r\n5 4 6 1 3 2 \r\n```\r\n#### 样例解释\r\n\r\n第一组测试数据已经在题目描述中讨论过。输出 1 中有一条坏的边 $(3, 6)$，输出 2 中没有坏的边。\r\n\r\n第二组测试数据中，输出 1 和输出 2 都没有出现坏的边。\r\n\r\n样例中，$M=2\\times 5 =10$。\r\n\r\n对于输出 1，$X = 1, R = \\frac1{10}=0.1$，该输出将得到 $5$ 分。\r\n\r\n对于输出 2，$X = 0, R = \\frac0{10} = 0$，该输出将得到 $10$ 分。"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"#### 计分方式\r\n\r\n对于每个测试点，设所有树的总边数为 $M=T \\times (n-1)$，你的输出中坏的边数为 $X$，记 $R=\\dfrac{X}{M}$ ，你的得分与 $R$ 的关系如下：\r\n\r\n|$R$|得分|$R$|得分|\r\n|:-:|:-:|:-:|:-:|\r\n|$0.1 < R \\le 0.2$|$2$|$0.001 < R \\le 0.004$|$12$|\r\n|$0.04 < R \\le 0.1$|$4$|$0.0004 < R \\le 0.001$|$14$|\r\n|$0.02 < R \\le 0.04$|$6$|$0.0002 < R \\le 0.0004$|$16$|\r\n|$0.01 < R \\le 0.02$|$8$|$0  < R \\le 0.0002$|$18$|\r\n|$0.004 < R \\le 0.01$|$10$|$R=0$|$20$|\r\n\r\n当 $R > 0.2$ 时，不能得分。\r\n\r\n**对于所有的测试点，保证存在 $X=0$ 的输出。对于每组数据，标准程序得到 $X=0$ 的输出的运行时间不超过 $700$ 秒。**\r\n\r\n#### 数据范围\r\n\r\n|测试点编号|样例|1|2|3|4|5|\r\n|:-:|:-:|:-:|:-:|:-:|:-:|:-:|\r\n|文件名|`00`|`01`|`02`|`03`|`04`|`05`|\r\n|$T$|$2$|$10$|$5$|$3$|$2$|$1$|\r\n|$n$|$6$|$50000$|$50000$|$50000$|$50000$|$50000$|"}]}