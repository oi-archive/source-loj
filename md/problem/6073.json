{"title":"「2017 山东一轮集训 Day5」距离","time_limit":4000,"memory_limit":1024,"tags":["2017","山东省队集训","标签待整理"],"operation":{"submit":"https://loj.ac/problem/6073#submit_code","submissions":"https://loj.ac/submissions?problem_id=6073","statistics":"https://loj.ac/problem/6073/statistics/fastest","testdata":"https://loj.ac/problem/6073/testdata","discussion":"https://loj.ac/discussion/problem/6073"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"给定一棵 $ n $ 个点的边带权的树，以及一个排列 $ p $，有 $ q $ 个询问，给定点 $ u, v, k $，设 $ \\text{path}(u, v) $ 表示 $ u $ 到 $ v $ 的路径，$ \\text{dist}(u, v) $ 表示 $ u $ 到 $ v $ 的距离，希望你求出\r\n\r\n$$ \\sum\\limits_{i \\in \\text{path}(u, v)} \\text{dist}(p_i, k) $$"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行一个整数 $ \\text{type} $ 表示这个测试点的数据类型。  \r\n第二行两个整数 $ n, q $。  \r\n接下来 $ n - 1 $ 行，每行三个整数 $ u_i, v_i, c_i $，代表树上有一条连接 $ u_i, v_i $ 的权值为 $ c_i $ 的边。  \r\n接下来一行 $ n $ 个正整数表示给定的排列 $ p $。  \r\n接下来 $ q $ 行，每行三个整数 $ u', v', k' $，记 $ \\text{lastAns} $ 为上一次询问的答案，假如这是第一次则 $ \\text{lastAns} = 0 $，那么这个询问对应的 $ u, v, k $ 满足 $ u = u' \\mathbin{\\text{xor}} (\\text{lastAns} \\times \\text{type}), v = v' \\mathbin{\\text{xor}} (\\text{lastAns} \\times \\text{type}), k = k' \\mathbin{\\text{xor}} (\\text{lastAns} \\times \\text{type}) $。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出 $ q $ 行，代表每个询问的答案。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n```plain\r\n0\r\n5 3\r\n1 5 3\r\n1 3 9\r\n1 2 10\r\n1 4 7\r\n1 3 5 2 4\r\n5 4 5\r\n2 3 3\r\n4 3 1\r\n```\r\n\r\n#### 样例输出\r\n```plain\r\n26\r\n21\r\n13\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于 $ 20\\% $ 的数据，$ n, q \\leq 5000 $；  \r\n对于 $ 40\\% $ 的数据，$ n, q \\leq 50000 $；  \r\n对于另外 $ 10\\% $ 的数据，$ p_i = i $；  \r\n对于另外 $ 20\\% $ 的数据，$ \\text{type} = 0 $；  \r\n对于 $ 100\\% $ 的数据，$ 1 \\leq n, q \\leq 200000; 0 \\leq c_i \\leq 10 ^ 9; 1 \\leq u, v, k \\leq n $。"}]}