{"title":"Runs","time_limit":1000,"memory_limit":256,"tags":["模板","后缀数组","字符串"],"operation":{"submit":"https://loj.ac/problem/173#submit_code","submissions":"https://loj.ac/submissions?problem_id=173","statistics":"https://loj.ac/problem/173/statistics/fastest","testdata":"https://loj.ac/problem/173/testdata","discussion":"https://loj.ac/discussion/problem/173"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"定义一个字符串 $|S|$ 里的一个 run，指其内部一段两侧都不能扩展的**周期子串**，且周期至少完整出现两次。\r\n\r\n严格地说，一个 run 是一个 三元组 $(i,j,p)$，满足 $p$ 是 $S[i..j]$ 的最小周期，$j-i+1 \\ge 2p$，且满足如下两个条件：\r\n\r\n+ 要么 $i=1$，要么 $S[i-1]\\ne S[i-1+p]$；\r\n+ 要么 $j=n$，要么 $S[j+1] \\ne S[j+1-p]$。\r\n\r\n给定字符串 $S$，求他的所有 runs。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"一行一个字符串 $S$，保证其只由小写字母构成。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"第一行一个整数 $m$，表示 runs 的数量。\r\n\r\n接下来 $m$ 行，每行三个整数 $i,j,p$ 描述一个 runs。\r\n\r\n你应该以第一个字符的位置为第一关键词，最后一个字符的位置为第二关键词对所有的 runs 进行排序。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n```plain\r\naababaababb\r\n```\r\n\r\n#### 样例输出\r\n```plain\r\n7\r\n1 2 1\r\n1 10 5\r\n2 6 2\r\n4 9 3\r\n6 7 1\r\n7 10 2\r\n10 11 1\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于 $60\\%$ 的数据，$|S| \\le 2 \\times 10^5$。\r\n\r\n对于 $100\\%$ 的数据，$|S| \\le 10^6$。\r\n"}]}