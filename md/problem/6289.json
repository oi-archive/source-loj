{"title":"花朵","time_limit":6000,"memory_limit":512,"tags":["原创","DFT（含 NTT）及FFT","树链剖分","分治"],"operation":{"submit":"https://loj.ac/problem/6289#submit_code","submissions":"https://loj.ac/submissions?problem_id=6289","statistics":"https://loj.ac/problem/6289/statistics/fastest","testdata":"https://loj.ac/problem/6289/testdata","discussion":"https://loj.ac/discussion/problem/6289"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"小 F 的生日还有一个多月，大 F 早早地准备起了礼物。\r\n\r\n> “你想要什么礼物呀？嗯...要不要好吃的？”\r\n\r\n> “才不要呢，我想要好看的花，永远不会凋谢的花。”\r\n\r\n小 F 和大 F 一起生活的国家—— Fairy 国，可以抽象成一棵 $N$ 个节点的树，每个节点就是一个城市，编号为 $1\\ldots N$。\r\n\r\n大 F 要游历各个城市，为心爱的小 F 寻找好看的花。\r\n\r\nFairy 国的每个城市都有一座山，山上有恰好一朵永远不会凋谢的花，编号为 $i$ 的城市的花的美丽值为 $B_i$。大 F 要在 $N$ 个城市中选出**恰好** $M$ 个，并摘来这 $M$ 个城市中的 $M$ 朵花送给小F。可是呢，如果树上的一条边连接的两个城市的花都被摘去，这条边就会塌陷，Fairy 国就会陷入分裂，大 F 作为一个善良的人，不希望这样的情况发生。所以，**一种摘法合法，当且仅当对于每条边，这条边相连的两个节点的花不被同时摘去**。\r\n\r\n大 F 希望小 F 快乐，小 F 的快乐程度将是摘来的 $M$ 朵花的美丽程度的积。大 F 今天闲着没事，想要求出对于所有合法的摘法，小 F 的快乐程度之和对\r\n $998244353$ 取模的结果。\r\n"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行两个正整数 $N$ 和 $M$，表示节点的个数与大 F 要为小 F 摘的花的朵数。\r\n\r\n第二行 $N$ 个整数 $B_{1\\ldots N}$，表示 $N$ 朵花的美丽程度。\r\n\r\n接下来 $N-1$ 行，每行两个正整数，描述树上的一条边，保证形成一棵树。\r\n"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"一个整数，表示对于所有合法的摘法，小 F 的快乐程度之和对 $998244353$ 取模的结果。\r\n"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n5 3\r\n3 5 4 8 11\r\n1 2\r\n1 3\r\n2 4\r\n2 5\r\n```\r\n#### 样例输出 1\r\n```plain\r\n616\r\n```\r\n#### 样例解释 1\r\n有两种选法，选的点集分别是 $\\{1,4,5\\}$ 和 $\\{3,4,5\\}$，所以答案是 $3\\times 8 \\times 11 + 4 \\times 8 \\times 11$，即 $616$。\r\n#### 样例输入 2\r\n```plain\r\n15 6\r\n9 10 2 7 2 4 5 9 3 2 1 9 3 10 7\r\n12 3\r\n4 3\r\n15 8\r\n2 14\r\n7 14\r\n8 14\r\n3 15\r\n6 1\r\n11 1\r\n7 11\r\n9 14\r\n8 5\r\n10 5\r\n13 15\r\n```\r\n#### 样例输出 2\r\n```plain\r\n8214265\r\n```\r\n#### 样例解释 2\r\n这个样例解释，真要写起来的话就会很长，所以我不解释了，你自己写个暴力看看题意有没有理解错吧 QAQ ，辛苦啦。\r\n"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于所有数据，保证 $1 \\le M \\le N \\le 8 \\times 10^4$，$0 \\le B_i < 998244353$。\r\n\r\n下表为各个 Subtask 的额外限制与得分，空格表示该项无额外限制。你只有通过一个 Subtask 的所有数据才能得到该 Subtask 的分。\r\n\r\n| Subtask 编号 | $N$ | $M$ | 特殊限制 | 分值 |\r\n| :-: | :-: | :-: | :-: | :-: |\r\n| 1 | $\\le 500$ | | | 7 |\r\n| 2 | $\\le 4000$ | | | 15 |\r\n| 3 | | $\\le 10$ | | 15 |\r\n| 4 | | | $\\forall 1\\le i < N$，读入的第 $i$ 条边是 $(i,i+1)$ | 18 |\r\n| 5 | | | $\\forall 1\\le i < N$，读入的第 $i$ 条边是 $(1,i+1)$ | 20 |\r\n| 6 | | | | 25 |\r\n"}]}