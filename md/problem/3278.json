{"title":"「JOISC 2020 Day3」收获","time_limit":3000,"memory_limit":512,"tags":["JOISC","2020","树状数组","基环树"],"operation":{"submit":"https://loj.ac/problem/3278#submit_code","submissions":"https://loj.ac/submissions?problem_id=3278","statistics":"https://loj.ac/problem/3278/statistics/fastest","testdata":"https://loj.ac/problem/3278/testdata","discussion":"https://loj.ac/discussion/problem/3278"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"**题目译自 [JOISC 2020](https://www.ioi-jp.org/camp/2020/2020-sp-tasks/index.html) Day3 T2「[収穫](https://www.ioi-jp.org/camp/2020/2020-sp-tasks/day3/harvest.pdf) / [Harvest](https://www.ioi-jp.org/camp/2020/2020-sp-tasks/day3/harvest-en.pdf)」，感谢 [@Chanis](https://loj.ac/user/5837) 提供翻译。**\r\n\r\nIOI 庄园有 $N$ 个员工，$M$ 棵苹果树种在湖岸。湖的周长为 $L$ 米。\r\n\r\n一开始员工 $i$ 位于从湖的最北端向顺时针方向前进 $A_i$ 米处，所有 $A_i$ 互异。苹果树 $j$ 生长在从湖的最北端向顺时针方向前进 $B_j$ 米处，所有 $B_j$ 互异。\r\n\r\n每棵苹果树最多长一个苹果，收获后 $C$ 秒会长出一个新的。时刻 $0$ 时，所有的苹果树上都有一个苹果。员工从时刻 $0$ 开始从各自的地点以 $1\\text{m/s}$ 的速度顺时针前进，遇到成熟的苹果就将其摘下（若到达时刚长出苹果，也要摘下），摘苹果的时间忽略不计。\r\n\r\n现给出 $Q$ 个询问，第 $k$ 次询问员工 $V_k$ 在时刻 $T_k$ 结束时一共收获到几个苹果。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"输入第一行为四个整数 $N,M,L,C$，意义由题面所示。\r\n\r\n第二行为 $N$ 个整数 $A_1,\\ldots,A_N$。\r\n\r\n第三行为 $M$ 个整数 $B_1,\\ldots,B_M$。\r\n\r\n第四行为一个整数 $Q$，即询问的数量。\r\n\r\n接下来的 $Q$ 行，每行两个整数 $V_i,T_i$。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出共 $Q$ 行，第 $k$ 行输出一个整数为第 $k$ 个问题的答案。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n3 2 7 3\r\n1 4 6\r\n0 5\r\n3\r\n1 7\r\n2 3\r\n3 8\r\n```\r\n#### 样例输出 1\r\n```plain\r\n2\r\n1\r\n1\r\n```\r\n#### 样例解释 1\r\n\r\n- 在第 $1$ 个时刻，员工 $2$ 从第 $2$ 棵苹果树上收获了苹果，员工 $3$ 从第 $1$ 棵苹果树上收获了苹果。\r\n\r\n- 在第 $3$ 个时刻，员工 $2$ 到达了第 $1$ 棵苹果树。但是因为那时树上没果子所以没收获。\r\n\r\n- 在第 $4$ 个时刻，员工 $1$ 从第 $2$ 棵苹果树上收获了苹果。\r\n\r\n- 在第 $6$ 个时刻，员工 $1$ 从第 $1$ 棵苹果树上收获了苹果，员工 $3$ 到达了第 $2$ 棵苹果树，但还是因为那时树上没果子所以没收获。\r\n\r\n- 在第 $8$ 个时刻，员工 $2$ 从第 $2$ 棵苹果树上收获了苹果，员工 $3$ 到达了第 $1$ 棵苹果树，但再一次因为那时树上没果子所以没收获。\r\n\r\n到第 $7$ 个时刻为止，员工 $1$ 收获了 $2$ 个苹果，故第一行输出 $2$。\r\n\r\n#### 样例输入 2\r\n```plain\r\n5 3 20 6\r\n0 4 8 12 16\r\n2 11 14\r\n9\r\n4 1932\r\n2 93787\r\n1 89\r\n5 98124798\r\n1 2684\r\n1 137598\r\n3 2\r\n3 8375\r\n4 237\r\n```\r\n#### 样例输出 2\r\n```plain\r\n146\r\n7035\r\n7\r\n7359360\r\n202\r\n10320\r\n0\r\n628\r\n18\r\n```\r\n#### 样例输入 3\r\n```plain\r\n8 15 217 33608\r\n0 12 71 96 111 128 152 206\r\n4 34 42 67 76 81 85 104 110 117 122 148 166 170 212\r\n14\r\n2 223544052420046341\r\n3 86357593875941375\r\n4 892813012303440034\r\n1 517156961659770735\r\n7 415536186438473633\r\n6 322175014520330760\r\n7 557706040951533058\r\n6 640041274241532527\r\n5 286263974600593111\r\n8 349405886653104871\r\n1 987277313830536091\r\n5 989137777159975413\r\n2 50689028127994215\r\n7 445686748471896881\r\n```\r\n#### 样例输出 3\r\n```plain\r\n33230868503053\r\n3\r\n5\r\n1\r\n123542793648997\r\n8\r\n165811220737767\r\n8\r\n7\r\n1\r\n1\r\n7\r\n7535161012043\r\n132506837660717\r\n```\r\n"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于 $100\\%$ 的数据，$1 \\leq N,M \\leq 2\\times 10^5$，$N+M \\leq L \\leq 10^9$，$1 \\leq C \\leq 10^9$，$1 \\leq Q \\leq 2\\times 10^5$，保证：\r\n- $0 \\leq A_{i}<L(1 \\leq i \\leq N)$；\r\n- $A_{i}<A_{i+1}(1 \\leq i \\leq N-1)$；\r\n- $0 \\leq B_{j}<L(1 \\leq j \\leq M)$；\r\n- $B_{j}<B_{j+1}(1 \\leq j \\leq M-1)$；\r\n- $A_{i} \\neq B_{j}(1 \\leq i \\leq N, 1 \\leq j \\leq M)$；\r\n- $1 \\leq V_{k} \\leq N(1 \\leq k \\leq Q)$；\r\n- $1 \\leq T_{k} \\leq 1000000000000000000=10^{18}(1 \\leq k \\leq Q)$。\r\n\r\n详细子任务及附加限制如下表：\r\n\r\n| 子任务编号 |      附加限制       | 分值 |\r\n| :--------: | :-----------------: | :--: |\r\n|    $1$     |      $N,M,Q\\leq 3000$      | $5$  |\r\n|    $2$     | $T_k\\geq 10^{15}$ | $20$ |\r\n|    $3$     |     无附加限制      | $75$ |"}]}