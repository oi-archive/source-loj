{"title":"「COCI 2018.12」Praktični","time_limit":1000,"memory_limit":64,"tags":["2018","COCI"],"operation":{"submit":"https://loj.ac/problem/3130#submit_code","submissions":"https://loj.ac/submissions?problem_id=3130","statistics":"https://loj.ac/problem/3130/statistics/fastest","testdata":"https://loj.ac/problem/3130/testdata","discussion":"https://loj.ac/discussion/problem/3130"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"**译自 [COCI 2018/2019 Contest #3](https://hsin.hr/coci/archive/2018_2019/) T5「[Praktični](https://hsin.hr/coci/archive/2018_2019/contest3_tasks.pdf)」**\r\n\r\n给一个有权无向图，我们称一个图是好的，当且仅当其每个简单环上的权值的异或和为 $0$。你一次操作可以选定图的一个边集以及一个数 $X$，操作是将该边集包含的边的权值都异或上 $X$。请求出至少需要多少次操作可以使给定的图变好。\r\n\r\n"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行输入两个正整数 $N,M$，表示图的点数和边数。\r\n\r\n接下来 $M$ 行第 $i$ 行三个整数 $a_i, b_i, p_i$，表示第 $i$ 条边连接 $a_i, b_i$，权值为 $p_i$。保证图是联通的且没有重边。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"第一行输出一个整数 $K$，表示需要的最少操作次数。\r\n\r\n接下来 $K$ 行每行第一个整数 $x$ 表示要异或的值，第二个整数 $B$ 表示选择的边集大小，接下来 $B$ 个整数第 $i$ 个 $E_i$ 表示所选取的第 $i$ 条边是输入中的第 $E_i$ 条，要求 $E_i$ 互不相同。请保证输入的数均不超过 $2 \\times 10^9$。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n\r\n```plain\r\n4 4\r\n1 2 10\r\n2 3 9\r\n3 4 8\r\n4 1 7\r\n```\r\n\r\n#### 样例输出 1\r\n\r\n```plain\r\n1\r\n12 3 1 2 3\r\n```\r\n\r\n#### 样例解释 1\r\n\r\n这是修改前的图\r\n\r\n![page9image15200.jpg](https://loj-img.upyun.menci.memset0.cn/2019/05/22/5ce53ed4f0c28.jpg)\r\n\r\n这是修改后的图\r\n\r\n![page9image15368.jpg](https://loj-img.upyun.menci.memset0.cn/2019/05/22/5ce53ed5c4014.jpg)\r\n\r\n#### 样例输入 2\r\n\r\n```plain\r\n2 1\r\n1 2 3\r\n```\r\n\r\n#### 样例输出 2\r\n\r\n```plain\r\n0\r\n```\r\n\r\n#### 样例解释 2\r\n\r\n这个图中没有简单环，因此不需要修改，显然满足条件。\r\n\r\n#### 样例输入 3\r\n\r\n```plain\r\n6 8\r\n1 2 6\r\n2 3 1\r\n3 5 6\r\n3 1 5\r\n4 5 0\r\n3 6 0\r\n4 2 8\r\n4 1 1\r\n```\r\n\r\n#### 样例输出 3\r\n\r\n```plain\r\n2\r\n2 2 4 6\r\n15 1 7\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于 $20\\%$ 的数据，保证最优操作次数不超过 $1$。\r\n\r\n对于另外 $40\\%$ 的数据，保证输入的数都不超过 $10^6$。\r\n\r\n对于 $100\\%$ 的数据，保证：\r\n- $1\\le N, M \\le 10^5$\r\n- $1\\le a_i, b_i \\le N, a_i \\neq b_i$\r\n- $0\\le p_i \\le 10^9$\r\n"}]}