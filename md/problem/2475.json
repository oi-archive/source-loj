{"title":"「2018 集训队互测 Day 3」白云的旅行","time_limit":3000,"memory_limit":1024,"tags":["2018","集训队互测","多项式 / 形式幂级数","DFT（含 NTT）及FFT","仙人掌","生成函数"],"operation":{"submit":"https://loj.ac/problem/2475#submit_code","submissions":"https://loj.ac/submissions?problem_id=2475","statistics":"https://loj.ac/problem/2475/statistics/fastest","testdata":"https://loj.ac/problem/2475/testdata","discussion":"https://loj.ac/discussion/problem/2475"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"白云开始了一段旅程。\r\n\r\n旅途中一共有 $n$ 个城市，编号为 $1$ 到 $n$，城市之间有一些道路相连。其道路结构可以抽象为一棵仙人掌。如果一个无向连通图的任意一条边最多属于一个简单环，我们就称之为仙人掌。所谓简单环即不经过重复的结点的环。\r\n\r\n![what-is-cactus.png](https://i.loli.net/2018/04/07/5ac8381c2d2dd.png)\r\n\r\n白云对这些城市间的每条道路都有一个喜爱度。一条路径的喜爱度是其上所有道路的喜爱度的乘积。\r\n\r\n现在白云在 $1$ 号城市准备出发。为了制定合理的路线，白云会时不时问白兔：“从 $1$ 号城市出发**不经过重复道路**到达 $k$ 号城市的所有路径喜爱度之和是多少？”\r\n\r\n这可难倒了白兔，请你帮忙对于 $k=1,2,\\ldots,n$ 求出相应答案。只需要输出答案对$998244353( = 7\\times 17\\times 2^{23}+1,$一个质数$)$取模后的值。\r\n"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第 $1$ 行两个正整数 $n,m$ 表示城市的个数和道路的条数。保证 $n \\ge 2$。\r\n\r\n接下来 $m$ 行每行两个正整数 $v,u,w(1 \\le v,u \\le n,1 \\le w < 998244353)$ 表示一条连接城市 $v$ 和 $u$ 的喜爱度为 $w$ 的道路。\r\n\r\n保证输入的图是一棵仙人掌，没有自环，但可能有重边。\r\n"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出 $n$ 行，第 $i$ 行包含一个整数表示 $k=i$ 时的答案。\r\n"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n11 11\r\n1 2 1\r\n2 3 1\r\n3 4 1\r\n4 5 1\r\n5 6 1\r\n6 1 1\r\n2 7 10\r\n3 8 20\r\n4 9 30\r\n5 10 40\r\n6 11 50\r\n```\r\n\r\n#### 样例输出 1\r\n```plain\r\n3\r\n2\r\n2\r\n2\r\n2\r\n2\r\n20\r\n40\r\n60\r\n80\r\n100\r\n```\r\n\r\n#### 样例解释 1\r\n\r\n注意，两条路径不同为它们经过的边数不同或存在一个满足 $1 \\le x \\le$ 路径长度 的 $x$ 使得这两条路径经过的第 $x$ 条边不同。\r\n\r\n长度为$0$的路径也是合法路径，权值视为 $1$。\r\n"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于所有数据，$n \\le 10^5,1 \\le w < 998244353$。\r\n\r\n| 子任务编号 | $n \\leq$ | $w \\leq$    | 其它约定               |\r\n| -----      | -------  | ------      | ------                 |\r\n| 1          | $10^5$   | $1$         | $m=n-1$                |\r\n| 2          | $10^5$   | $998244352$ | $m=n-1$                |\r\n| 3          | $8$      | $998244352$ |                        |\r\n| 4          | $10^5$   | $1$                | 一个点最多只在一个环中     |\r\n| 5          | $10^5$   | $998244352$ | 一个点最多只在一个环中     |\r\n| 6          | $500$    | $998244352$ |                        |\r\n| 7        | $3000$   | $1$ |                        |\r\n| 8        | $3000$   | $998244352$ |                        |\r\n| 9       | $10^5$   | $1$ |                        |\r\n| 10       | $10^5$   | $998244352$ |    |                    |\r\n\r\n虽然我没有给 $m$ 的范围，但是熟悉仙人掌的小朋友都知道对于仙人掌肯定满足 $n-1 \\le m \\le 2n-2$。"}]}