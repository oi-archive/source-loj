{"title":"「CCO 2017」Vera 与现代艺术","time_limit":4000,"memory_limit":256,"tags":["2017","CCO","数据结构"],"operation":{"submit":"https://loj.ac/problem/2752#submit_code","submissions":"https://loj.ac/submissions?problem_id=2752","statistics":"https://loj.ac/problem/2752/statistics/fastest","testdata":"https://loj.ac/problem/2752/testdata","discussion":"https://loj.ac/discussion/problem/2752"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"**译自 [CCO 2017](https://cemc.math.uwaterloo.ca/contests/computing/2017/) Day1 「[Vera and Modern Art](https://cemc.math.uwaterloo.ca/contests/computing/2017/stage%202/day1.pdf)」**\r\n\r\n在受到大画家毕加索的启发后， Vera 决定创造她的杰作。她有一张可以被简化成无限大的二维平面的画布。 Vera 喜欢 $2$ 的整数次幂 $(1,\\, 2,\\, 4,\\, 8,\\, 16,\\, \\ldots)$，并且将以 $2$ 的整数幂为步长给一些点染色。\r\n\r\nVera 将会染 $N$ 次，第 $i$ 次染色可以用三个整数 $x_i,\\, y_i,\\, v_i$ 描述。令 $a_i$ 为最大的不大于 $x_i$ 的 $2$ 的整数次幂， $b_i$ 为最大的不大于 $y_i$ 的 $2$ 的整数次幂， Vera 会用第 $v_i$ 种颜色在所有坐标满足 $(x_i + a_ip,\\, y_i + b_iq)$ 的点上染色（$p,\\, q$ 为非负整数）。一个点可以被不同的颜色分别染多次，也可以被同种颜色重复染多次，一个点的颜色为所有染过这个点的颜色之和。\r\n\r\n接下来 Vera 将提出 $Q$ 个问题。对于第 $j$ 个问题，她希望知道坐标为 $(r_j,\\, c_j)$ 的点是什么颜色。如果一个点没有被染过色，这个点的颜色就为 $0$。\r\n\r\n因为你被迫做 Vera 的助手，你不得不回答 Vera 的问题。\r\n"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行包括两个整数 $N,\\, Q$ ，用一个空格分隔。\r\n\r\n接下来 $N$ 行，每行三个空格隔开的整数 $x_i,\\, y_i,\\, v_i$，表示用第 $v_i$ 种颜色进行题目中的染色操作，参数为 $x_i$ 和 $y_i$。\r\n\r\n再接下来 $Q$ 行，每行两个空格隔开的整数 $r_j,\\, c_j$，表示询问点 $(r_j,\\, c_j)$ 的颜色。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出共有 $Q$ 行，每行一个整数，第 $j$ 行的整数表示点$(r_j,\\, c_j)$ 的颜色。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n\r\n```plain\r\n5 6\r\n1 2 1\r\n3 4 2\r\n4 5 3\r\n6 3 4\r\n7 1 5\r\n2 6\r\n7 8\r\n5 9\r\n11 2\r\n10 7\r\n4 5\r\n\r\n```\r\n\r\n#### 样例输出\r\n\r\n```plain\r\n1\r\n8\r\n0\r\n6\r\n4\r\n3\r\n\r\n```\r\n\r\n#### 样例解释\r\n\r\n令颜色 $1,\\, 2,\\, 3,\\, 4,\\, 5$ 分别为红色、蓝色、绿色、橙色和紫色。\r\n\r\n令 $p,\\, q$为非负整数，则：\r\n\r\n - 坐标为 $(1 + p,\\, 2 + 2q)$ 的点被染成了红色；\r\n - 坐标为 $(3 + 2p,\\, 4 + 4q)$ 的点被染成了蓝色；\r\n - 坐标为 $(4 + 4p,\\, 5 + 4q)$ 的点被染成了绿色；\r\n - 坐标为 $(6 + 4p,\\, 3 + 2q)$ 的点被染成了橙色；\r\n - 坐标为 $(7 + 4p,\\, 1 + q)$ 的点被染成了紫色；\r\n\r\n从 $(0,\\, 0)$ 到 $(11,\\, 11)$ 的坐标纸如图所示：\r\n\r\n我们可以发现：\r\n\r\n - $(2,\\, 6)$ 被染成了红色，所以它的颜色为 $1$；\r\n - $(7,\\, 8)$ 被染成了红色、蓝色和紫色，所以它的颜色为 $1 + 2 + 5 = 8$；\r\n - $(5,\\, 9)$ 没有被染色，所以它的颜色为 $0$；\r\n - $(11,\\, 2)$ 被染成了红色和紫色，所以它的颜色为 $1 + 5 = 6$；\r\n - $(10,\\, 7)$ 被染成了橙色，所以它的颜色为 $4$；\r\n - $(4,\\, 5)$ 被染成了绿色，所以它的颜色为 $3$。\r\n\r\n![](https://i.loli.net/2018/08/08/5b6af80174186.png)\r\n"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于 $20\\%$ 的数据， $N,\\, Q\\leqslant 2000$；  \r\n对于另外 $20\\%$ 的数据， $y_i = 1(1\\leqslant i\\leqslant N)$；  \r\n对于另外 $20\\%$ 的数据， $N,\\, Q\\leqslant 10^5$ 且 $1\\leqslant r_j,\\, c_j\\leqslant 10^9(1\\leqslant j\\leqslant Q)$。  \r\n对于全部的数据， $1\\leqslant N,\\, Q\\leqslant 2\\cdot 10^5$，$i\\leqslant i\\leqslant N;\\, 1\\leqslant v_i\\leqslant 10\\, 000;\\, 1\\leqslant x_i,\\, y_i\\leqslant 10^{18}$，$1\\leqslant j\\leqslant Q;\\, 1\\leqslant r_j\\leqslant 10^{18};\\, 1\\leqslant c_j\\leqslant 10^{18}$。  \r\n\r\n**请注意在 LibreOJ 上共有 $5$ 个子任务，其中第一个子任务为样例。**"}]}