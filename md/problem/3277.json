{"title":"「JOISC 2020 Day3」星座 3","time_limit":1000,"memory_limit":512,"tags":["JOISC","2020","启发式合并","笛卡尔树 / Kruskal 重构树","线段树合并","DP"],"operation":{"submit":"https://loj.ac/problem/3277#submit_code","submissions":"https://loj.ac/submissions?problem_id=3277","statistics":"https://loj.ac/problem/3277/statistics/fastest","testdata":"https://loj.ac/problem/3277/testdata","discussion":"https://loj.ac/discussion/problem/3277"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"**题目译自 [JOISC 2020](https://www.ioi-jp.org/camp/2020/2020-sp-tasks/index.html) Day3 T1「[星座 3](https://www.ioi-jp.org/camp/2020/2020-sp-tasks/day3/constellation3.pdf) / [Constellation 3](https://www.ioi-jp.org/camp/2020/2020-sp-tasks/day3/constellation3-en.pdf)」，感谢 [@Chanis](https://loj.ac/user/5837) 提供翻译**。\r\n\r\nJOI 君拍了一张 $N\\times N$ 的星空图，将左起第 $X$ 列，下起第 $Y$ 行的像素点称为像素 $(X,Y)$。\r\n\r\n画面里有白色的大楼，黄色的星星，黑色的空格。第 $i$ 列从最下方到自下数起第 $A_i$ 行都是白色的大楼。有 $M$ 个星星，第 $j$ 个星星位于像素点 $(X_j,Y_j)$。此外，所有的像素点都是黑色。\r\n\r\n若一个长方形区域可以称作星座，则满足以下条件：\r\n\r\n1. 不含白色像素点。\r\n\r\n2. 至少存在两个星星。\r\n\r\n看厌了星座的 JOI 君要把一些黄色的星星涂成黑色，使得没有星座存在。将第 $j$ 个星星涂成黑色会使照片的不自然度增加 $C_j$，最初不自然度为 $0$。求不自然度的最小值。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"输入第一行为一个整数 $N$，表示地图的边长大小。\r\n\r\n第二行为 $N$ 个整数 $A_1,\\ldots,A_N$，描述如题目。\r\n\r\n第三行为一个整数 $M$，表示星星的个数。\r\n\r\n接下来的 $M$ 行，每行三个整数 $X_i,Y_i,C_i$，即对第 $i$ 个星星的描述。\r\n\r\n"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出不自然度的最小值。\r\n"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n5\r\n1 3 4 2 3\r\n3\r\n1 5 3\r\n4 3 2\r\n2 4 2\r\n```\r\n#### 样例输出 1\r\n```plain\r\n2\r\n```\r\n#### 样例解释 1\r\n\r\n![QQ图片20200322145805.png](https://loj-img.upyun.menci.memset0.cn/2020/03/22/5e770cc138ae9.png)\r\n\r\n\r\n可以发现把第三个星删了之后它就和一号构不成星座，且比删去一号花费少。\r\n\r\n#### 样例输入 2\r\n```plain\r\n7\r\n5 6 2 3 6 7 6\r\n5\r\n7 7 5\r\n3 3 7\r\n3 7 10\r\n1 7 6\r\n4 7 8\r\n```\r\n#### 样例输出 2\r\n```plain\r\n16\r\n```\r\n\r\n#### 样例解释 2\r\n\r\n删去三号和四号。"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于 $100\\%$ 的数据，$1 \\leq N,M \\leq 200 000$，保证：\r\n\r\n- $1 \\leq A_i \\leq N (1 \\leq i \\leq N)$；\r\n\r\n- $1 \\leq X_j,Y_j \\leq N (1 \\leq j \\leq M)$；\r\n\r\n- $1 \\leq C_j \\leq 10^9 (1 \\leq j \\leq M)$；\r\n\r\n- $A_{X_j} < Y_j (1 \\leq j \\leq M)$；\r\n\r\n- $(X_j, Y_j)\\neq (X_k, Y_k) (1 \\leq j < k \\leq M)$。\r\n\r\n详细子任务及附加限制如下表：\r\n\r\n| 子任务编号 |      附加限制       | 分值 |\r\n| :--------: | :-----------------: | :--: |\r\n|    $1$     |      $N,M\\leq 300$      | $14$  |\r\n|    $2$     | $N,M\\leq 2000$ | $21$ |\r\n|    $3$     |     无附加限制      | $65$ |"}]}