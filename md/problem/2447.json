{"title":"「NOI2011」兔兔与蛋蛋的游戏","time_limit":1000,"memory_limit":256,"tags":["2011","NOI"],"operation":{"submit":"https://loj.ac/problem/2447#submit_code","submissions":"https://loj.ac/submissions?problem_id=2447","statistics":"https://loj.ac/problem/2447/statistics/fastest","testdata":"https://loj.ac/problem/2447/testdata","discussion":"https://loj.ac/discussion/problem/2447"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"这些天，兔兔和蛋蛋喜欢上了一种新的棋类游戏。\r\n\r\n这个游戏是在一个 $n$ 行 $m$ 列的棋盘上进行的。游戏开始之前，棋盘上有一个格子是空的，其它的格子中都放置了一枚棋子，棋子或者是黑色，或者是白色。\r\n\r\n每一局游戏总是兔兔先操作，之后双方轮流操作，具体操作为：\r\n* 兔兔每次操作时，选择一枚与空格相邻的白色棋子，将它移进空格。\r\n* 蛋蛋每次操作时，选择一枚与空格相邻的黑色棋子，将它移进空格。\r\n\r\n第一个不能按照规则操作的人输掉游戏。为了描述方便，下面将操作“将第 $x$ 行第 $y$ 列中的棋子移进空格中”记为 $M(x,y)$。\r\n\r\n例如下面是三个游戏的例子。\r\n\r\n![](https://i.loli.net/2018/06/11/5b1e029d60b0d.png)\r\n\r\n![](https://i.loli.net/2018/06/11/5b1e029d6886a.png)\r\n\r\n![](https://i.loli.net/2018/06/11/5b1e029d7f3b9.png)\r\n\r\n最近兔兔总是输掉游戏，而且蛋蛋格外嚣张，于是兔兔想请她的好朋友——你——来帮助她。她带来了一局输给蛋蛋的游戏的实录，请你指出这一局游戏中所有她“犯错误”的地方。\r\n\r\n注意：\r\n* 两个格子相邻当且仅当它们有一条公共边。\r\n* 兔兔的操作是“犯错误”的，当且仅当，在这次操作前兔兔有必胜策略，而这次操作后蛋蛋有必胜策略。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"输入的第一行包含两个正整数 $n$、$m$。\r\n\r\n接下来 $n$ 行描述初始棋盘。其中第 $i$ 行包含 $m$ 个字符，每个字符都是大写英文字母 `X`、大写英文字母 `O` 或点号 `.` 之一，分别表示对应的棋盘格中有黑色棋子、有白色棋子和没有棋子。其中点号 `.` 恰好出现一次。\r\n\r\n接下来一行包含一个整数 $k$（$1 \\le k \\le 1000$），表示兔兔和蛋蛋各进行了 $k$ 次操作。\r\n\r\n接下来 $2k$ 行描述一局游戏的过程。其中第 $2i – 1$ 行是兔兔的第 $i$ 次操作（编号为 $i$ 的操作），第 $2i$ 行是蛋蛋的第 $i$ 次操作。每个操作使用两个整数 $x,y$ 来描述，表示将第 $x$ 行第 $y$ 列中的棋子移进空格中。\r\n\r\n输入保证整个棋盘中只有一个格子没有棋子，游戏过程中兔兔和蛋蛋的每个操作都是合法的，且最后蛋蛋获胜。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出文件的第一行包含一个整数 $r$，表示兔兔犯错误的总次数。\r\n\r\n接下来 $r$ 行按递增的顺序给出兔兔“犯错误”的操作编号。其中第 $i$ 行包含一个整数 $a_i$ 表示兔兔第 $i$ 个犯错误的操作是他在游戏中的第 $a_i$ 次操作。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n1 6\r\nXO.OXO\r\n1\r\n1 2\r\n1 1\r\n```\r\n\r\n#### 样例输出 1\r\n```plain\r\n1\r\n1\r\n```\r\n\r\n#### 样例输入 2\r\n```plain\r\n3 3\r\nXOX\r\nO.O\r\nXOX\r\n4\r\n2 3\r\n1 3\r\n1 2\r\n1 1\r\n2 1\r\n3 1\r\n3 2\r\n3 3\r\n```\r\n\r\n#### 样例输出 2\r\n```plain\r\n0\r\n```\r\n\r\n#### 样例输入 3\r\n```plain\r\n4 4\r\nOOXX\r\nOXXO\r\nOO.O\r\nXXXO\r\n2\r\n3 2\r\n2 2\r\n1 2\r\n1 3\r\n```\r\n\r\n#### 样例输出 3\r\n```plain\r\n2\r\n1\r\n2\r\n```\r\n\r\n#### 样例解释\r\n样例 1 对应图一中的游戏过程。\r\n样例 2 对应图三中的游戏过程。"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"| 测试点编号 | $n$ 的规模 | $m$ 的规模 |\r\n| :-: | :-: | :-: |\r\n| 1 | $n = 1$ | $1 \\le m \\le 20$ |\r\n| 2 | $n = 1$ | $1 \\le m \\le 20$ |\r\n| 3 | $n = 3$ | $m = 4$ |\r\n| 4 | $n = 4$ | $m = 4$ |\r\n| 5 | $n = 4$ | $m = 4$ |\r\n| 6 | $n = 4$ | $m = 5$ |\r\n| 7 | $n = 4$ | $m = 5$ |\r\n| 8 | $n = 3$ | $m = 7$ |\r\n| 9 | $n = 2$ | $1 \\le m \\le 40$ |\r\n| 10 | $n = 2$ | $1 \\le m \\le 40$ |\r\n| 11 | $n = 2$ | $1 \\le m \\le 40$ |\r\n| 12 | $n = 2$ | $1 \\le m \\le 40$ |\r\n| 13 | $n = 2$ | $1 \\le m \\le 40$ |\r\n| 14 | $n = 2$ | $1 \\le m \\le 40$ |\r\n| 15 | $1 \\le n \\le 16$ | $1 \\le m \\le 16$ |\r\n| 16 | $1 \\le n \\le 16$ | $1 \\le m \\le 16$ |\r\n| 17 | $1 \\le n \\le 40$ | $1 \\le m \\le 40$ |\r\n| 18 | $1 \\le n \\le 40$ | $1 \\le m \\le 40$ |\r\n| 19 | $1 \\le n \\le 40$ | $1 \\le m \\le 40$ |\r\n| 20 | $1 \\le n \\le 40$ | $1 \\le m \\le 40$ |"}]}