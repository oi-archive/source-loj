{"title":"「LibreOJ β Round #2」数学上来先打表","time_limit":2333,"memory_limit":50,"tags":["LibreOJ β Round","离线","分块及按大小分类","启发式合并","bitset"],"operation":{"submit":"https://loj.ac/problem/519#submit_code","submissions":"https://loj.ac/submissions?problem_id=519","statistics":"https://loj.ac/problem/519/statistics/fastest","testdata":"https://loj.ac/problem/519/testdata","discussion":"https://loj.ac/discussion/problem/519"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"\r\n给你一个图，每个点有点权，最开始没有边。\r\n\r\n有一些操作：\r\n\r\n 1. 添加一条 $x$ 与 $y$ 之间的双向边。\r\n\r\n 2. 回到第 $x$ 次操作后的状态。（注意这里的 $x$ 可以是 $0$，即回到初始状态）\r\n\r\n 3. 查询 $x$ 所在联通块能到的点中点权第 $y$ 小的值，如果不存在，那么输出 $-1$。\r\n"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行输入两个数 $n,m$，表示有 $n$ 个点，$m$ 个操作。  \r\n之后一行 $n$ 个数，表示每个点的点权。  \r\n之后 $m$ 行，每行有三种可能的操作：\r\n\r\n- `1 x y`\r\n- `2 x`\r\n- `3 x y`\r\n\r\n意义见题面。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"对于所有的 3 操作，输出一个数表示答案。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n```plain\r\n6 10\r\n816801151 223885531 110182151 94271893 319888699 106363731 \r\n1 1 3\r\n1 3 5\r\n1 2 4\r\n1 4 6\r\n1 1 2\r\n3 1 1\r\n2 4\r\n1 1 2\r\n3 1 4\r\n2 7\r\n```\r\n#### 样例输出\r\n```plain\r\n94271893\r\n223885531\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"$1 \\le n,m \\le 100000$\r\n\r\n点权在 `int` 范围内。"}]}