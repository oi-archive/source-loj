{"title":"「CTSC2017」最长上升子序列","time_limit":1000,"memory_limit":512,"tags":["2017","CTSC","费用流","Dilworth 定理","杨氏矩阵","网络流"],"operation":{"submit":"https://loj.ac/problem/2265#submit_code","submissions":"https://loj.ac/submissions?problem_id=2265","statistics":"https://loj.ac/problem/2265/statistics/fastest","testdata":"https://loj.ac/problem/2265/testdata","discussion":"https://loj.ac/discussion/problem/2265"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"猪小侠最近学习了最长上升子序列的相关知识。对于一个整数序列 $ A = (a_1, a_2, \\cdots, a_k) $，定义 $ A $ 的子序列为：从 $ A $ 中删除若干个元素后（允许不删，也允许将所有 $ k $ 个元素都删除），剩下的元素按照原来的顺序所组成的序列。如果这个子序列的元素从左到右严格递增，则称它为 $ A $ 的一个上升子序列。其中包含元素数量最多的上升子序列称为 $ A $ 的最长上升子序列。例如，$ (2, 4, 5, 6) $ 和 $ (1, 4, 5, 6) $ 都是 $ (2, 1, 1, 4, 7, 5, 6) $ 的最长上升子序列，长度都为 $ 4 $。\r\n\r\n现在猪小侠遇到了这样一个问题：给定一个序列 $ B_m = (b_1, b_2, \\cdots, b_m) $，设 $ C $ 是 $ B_m $ 的子序列，且 $ C $ 的最长上升子序列的长度不超过 $ k $，则 $ C $ 的长度最大能是多少？\r\n\r\n猪小侠觉得这个问题太简单了，缺乏挑战，他决定提出一个更难的问题。于是他给了你这样一个序列 $ B = (b_1, b_2, \\ldots, b_n) $，以及若干次询问。每次询问会给定两个整数 $ m $ 和 $ k $，你需要对于 $ B $ 序列的前 $ m $ 个元素构成的序列 $ B_m = (b_1, b_2, \\cdots, b_m) $ 和 $ k $ 回答上述问题。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行两个整数 $ n, q $，其中 $ n $ 是序列 $ B $ 的长度，$ q $ 是询问次数。  \r\n第二行是空格隔开的 $ n $ 个正整数 $ b_1, b_2, \\cdots, b_n $。  \r\n接下来 $ q $ 行，其中第 $ i $ 行包含两个整数 $ m_i, k_i $，表示对 $ m = m_i, k = k_i $ 进行询问。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出共 $ q $ 行，按顺序每行一个整数作为回答。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n```plain\r\n11 6\r\n9 6 3 1 5 12 8 4 2 2 2\r\n5 1\r\n7 2\r\n9 1\r\n9 2\r\n11 1\r\n11 11\r\n```\r\n\r\n#### 样例输出\r\n```plain\r\n4\r\n6\r\n5\r\n8\r\n7\r\n11\r\n```\r\n\r\n#### 样例解释\r\n询问 1：对于序列 $ (9, 6, 3, 1, 5) $，可以选取子序列 $ (9, 6, 3, 1) $，它的最长上升子序列长度为 $ 1 $。  \r\n询问 2：对于序列 $ (9, 6, 3, 1, 5, 12, 8) $，可以选取子序列 $ (9, 6, 3, 1, 12, 8) $，它的最长上升子序列长度为 $ 2 $。  \r\n询问 3：对于序列 $ (9, 6, 3, 1, 5, 12, 8, 4, 2) $，可以选取子序列 $ (9, 6, 5, 4, 2) $，它的最长上升子序列长度为 $ 1 $。  \r\n询问 4：对于序列 $ (9, 6, 3, 1, 5, 12, 8, 4, 2) $，可以选取子序列 $ (9, 6, 3, 1, 12, 8, 4, 2) $，它的最长上升子序列长度为 $ 2 $。  \r\n询问 5：对于序列 $ (9, 6, 3, 1, 5, 12, 8, 4, 2, 2, 2) $，可以选取子序列 $ (9, 6, 5, 4, 2, 2, 2) $，它的最长上升子序列长度为 $ 1 $。  \r\n询问 6：对于序列 $ (9, 6, 3, 1, 5, 12, 8, 4, 2, 2, 2) $，可以选取子序列 $ (9, 6, 3, 1, 5, 12, 8, 4, 2, 2, 2) $，它的最长上升子序列长度为 $ 3 $。\r\n"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"<!-- BEGIN: Migrated markdown table -->\n\n| 测试点 | $ n $ | 约束 |\n|-|-|-|\n| 1 | $ \\leq 50000 $ | $ k_i = 1 $ |\n| 2 | $ \\leq 300 $ | $ k_i \\leq 2 $ |\n| 3 | $ \\leq 3000 $ | $ k_i \\leq 2 $ |\n| 4 | $ \\leq 50000 $ | $ b_i \\leq 5 $ |\n| 5 | $ \\leq 50000 $ | $ b_i \\leq 8 $ |\n| 6 | $ \\leq 100 $ | $ m_i = n $ |\n| 7 | $ \\leq 100 $ | $ m_i = n $ |\n| 8 | $ \\leq 800 $ | $ m_i = n, k_i \\leq 10 $ |\n| 9 | $ \\leq 1500 $ | $ m_i = n, k_i \\leq 10 $ |\n| 10 | $ \\leq 10000 $ | $ m_i = n, k_i \\leq 30 $ |\n| 11 | $ \\leq 15000 $ | $ m_i = n, k_i \\leq 40 $ |\n| 12 | $ \\leq 20000 $ | $ m_i = n, k_i \\leq 50 $ |\n| 13 | $ \\leq 20000 $ | $ k_i \\geq 10000 $ |\n| 14 | $ \\leq 8000 $ | $ m_i = n $ |\n| 15 | $ \\leq 25000 $ | 没有约束 |\n| 16 | $ \\leq 40000 $ | 没有约束 |\n| 17 | $ \\leq 45000 $ | 没有约束 |\n| 18 | $ \\leq 50000 $ | 没有约束 |\n| 19 | $ \\leq 50000 $ | 没有约束 |\n| 20 | $ \\leq 50000 $ |\n\n<!-- Migrated from original HTML table:\n<table class=\"ui center aligned table\">\r\n<thead>\r\n<tr>\r\n<th>测试点</th>\r\n<th> $ n $ </th>\r\n<th>约束</th>\r\n</tr>\r\n</thead>\r\n<tbody>\r\n<tr>\r\n<td> 1 </td>\r\n<td> $ \\leq 50000 $ </td>\r\n<td> $ k_i = 1 $ </td>\r\n</tr>\r\n<tr>\r\n<td> 2 </td>\r\n<td> $ \\leq 300 $ </td>\r\n<td rowspan=\"2\"> $ k_i \\leq 2 $ </td>\r\n</tr>\r\n<tr>\r\n<td> 3 </td>\r\n<td> $ \\leq 3000 $ </td>\r\n</tr>\r\n<tr>\r\n<td> 4 </td>\r\n<td rowspan=\"2\"> $ \\leq 50000 $ </td>\r\n<td> $ b_i \\leq 5 $ </td>\r\n</tr>\r\n<tr>\r\n<td> 5 </td>\r\n<td> $ b_i \\leq 8 $ </td>\r\n</tr>\r\n<tr>\r\n<td> 6 </td>\r\n<td rowspan=\"2\"> $ \\leq 100 $ </td>\r\n<td rowspan=\"2\"> $ m_i = n $ </td>\r\n</tr>\r\n<tr>\r\n<td> 7 </td>\r\n</tr>\r\n<tr>\r\n<td> 8 </td>\r\n<td> $ \\leq 800 $ </td>\r\n<td rowspan=\"2\"> $ m_i = n, k_i \\leq 10 $ </td>\r\n</tr>\r\n<tr>\r\n<td> 9 </td>\r\n<td> $ \\leq 1500 $ </td>\r\n</tr>\r\n<tr>\r\n<td> 10 </td>\r\n<td> $ \\leq 10000 $ </td>\r\n<td> $ m_i = n, k_i \\leq 30 $ </td>\r\n</tr>\r\n<tr>\r\n<td> 11 </td>\r\n<td> $ \\leq 15000 $ </td>\r\n<td> $ m_i = n, k_i \\leq 40 $ </td>\r\n</tr>\r\n<tr>\r\n<td> 12 </td>\r\n<td rowspan=\"2\"> $ \\leq 20000 $ </td>\r\n<td> $ m_i = n, k_i \\leq 50 $ </td>\r\n</tr>\r\n<tr>\r\n<td> 13 </td>\r\n<td> $ k_i \\geq 10000 $ </td>\r\n</tr>\r\n<tr>\r\n<td> 14 </td>\r\n<td> $ \\leq 8000 $ </td>\r\n<td> $ m_i = n $ </td>\r\n</tr>\r\n<tr>\r\n<td> 15 </td>\r\n<td> $ \\leq 25000 $ </td>\r\n<td rowspan=\"5\"> 没有约束 </td>\r\n</tr>\r\n<tr>\r\n<td> 16 </td>\r\n<td> $ \\leq 40000 $ </td>\r\n</tr>\r\n<tr>\r\n<td> 17 </td>\r\n<td> $ \\leq 45000 $ </td>\r\n</tr>\r\n<tr>\r\n<td> 18 </td>\r\n<td rowspan=\"3\"> $ \\leq 50000 $ </td>\r\n</tr>\r\n<tr>\r\n<td> 19 </td>\r\n</tr>\r\n<tr>\r\n<td> 20 </td>\r\n</tr>\r\n</tbody>\r\n</table>\n-->\n\n<!-- END: Migrated markdown table -->"}]}