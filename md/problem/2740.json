{"title":"「JOISC 2016 Day 4」最差记者 2","time_limit":2000,"memory_limit":256,"tags":["2016","JOISC","线段树","贪心"],"operation":{"submit":"https://loj.ac/problem/2740#submit_code","submissions":"https://loj.ac/submissions?problem_id=2740","statistics":"https://loj.ac/problem/2740/statistics/fastest","testdata":"https://loj.ac/problem/2740/testdata","discussion":"https://loj.ac/discussion/problem/2740"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"**题目译自 [JOISC 2016](https://www.ioi-jp.org/camp/2016/2016-sp-tasks/index.html) Day4 T3 「[最悪の記者 2](https://www.ioi-jp.org/camp/2016/2016-sp-tasks/2016-sp-d4.pdf)」**\r\n\r\n时间来到了 22 世纪，程序设计竞赛已经作为一种智力运动被广泛接受，并且经常出现在各种新闻媒体中，如电视和报纸。\r\n\r\n你是 JOI 新闻社的一名记者，负责写报道程序设计竞赛的文章。\r\n\r\n昨天举行了一场世界级的程序设计竞赛，共有 $N$ 名选手参加。为了写一篇关于这个竞赛的文章，你得知了如下信息：\r\n\r\n- 作为国际奥林匹克竞赛，选手来自于不同的国家。国家从 $1$ 到 $N$ 编号，可能有多于一名选手来自同一国家，也可能有一些国家的选手没有参赛；\r\n- 比赛共 $5$ 小时；\r\n- 选手在比赛中获得的分数不会在获得之后减少；\r\n- 在比赛开始两小时的时候，不存在两名选手平手。在此时的榜单上，排名第 $i\\ (1\\le i\\le N)$ 的选手来自国家 $A_i$，并获得了 $B_i$ 分；\r\n- 在比赛结束的时候，不存在两名选手平手。在终榜上，排名第 $i\\ (1\\le i\\le N)$ 的选手来自国家 $C_i$，并获得了 $D_i$ 分。\r\n\r\n然而，在写文章的阶段，发现榜上显示的选手国家是有问题的。榜上选手的国籍可能显示有误，但是显示的选手分数是一定正确的。\r\n\r\n所以，你可以通过修改同一选手的国籍来避免矛盾（但是你不能修改选手的得分）。也就是说，我们要通过修改 $A_1,A_2,\\ldots,A_N,C_1,C_2,\\ldots C_N$ 中尽可能少的值，使得满足以下条件：\r\n\r\n- 存在一个 $1\\ldots N$ 的排列 $x_1,x_2,\\ldots x_N$，对于每个 $i=1,2,\\ldots N$，满足 $A_i=C_{x_i}$ 且 $B_i\\le D_{x_i}$。\r\n\r\n请求出最少要做出多少次修改才能使给出的信息不会互相矛盾。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行一个整数 $N$；\r\n\r\n接下来 $N$ 行中的第 $i$ 行，每行两个整数 $A_i,B_i$，表示比赛开始两小时后，排名第 $i$ 的选手来自国家 $A_i$ 并获得了 $B_i$ 分；\r\n\r\n接下来 $N$ 行中的第 $i$ 行，每行两个整数 $C_i,D_i$，表示比赛结束后，排名第 $i$ 的选手来自国家 $C_i$ 并获得了 $D_i$ 分。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出一行一个整数，表示要使给出的榜单不互相矛盾的话至少要改多少次。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n3\r\n3 500\r\n2 200\r\n1 100\r\n1 1000\r\n3 700\r\n3 400\r\n```\r\n#### 样例输出 1\r\n```plain\r\n1\r\n```\r\n#### 样例说明 1\r\n这里将 $C_3$ 的值修改为 $2$，就可以使得给出信息不互相矛盾了：\r\n- 比赛开始两小时的时候，来自国家 $3$ 的选手获得了 $500$ 分并排名第一，结束时排名第二，获得了 $700$ 分；\r\n- 比赛开始两小时的时候，来自国家 $2$ 的选手获得了 $200$ 分并排名第二，结束时排名第三，获得了 $400$ 分；\r\n- 比赛开始两小时的时候，来自国家 $1$ 的选手获得了 $100$ 分并排名第三，结束时排名第一，获得了 $1000$ 分。\r\n\r\n如果将 $C_2$ 修改为 $2$，那么来自国家 $3$ 的选手在比赛开始两小时时获得了 $500$ 分，但结束时获得了 $400$ 分，与规则矛盾。\r\n\r\n$1$ 是可能修改的最少次数，因此输出 $1$。\r\n\r\n#### 样例输入 2\r\n```plain\r\n3\r\n3 3\r\n3 2\r\n1 1\r\n3 4\r\n3 2\r\n1 1\r\n```\r\n#### 样例输出 2\r\n```plain\r\n0\r\n```\r\n#### 样例说明 2\r\n这组样例中，即使信息可能有误，但是两份榜单不互相矛盾，所以输出 $0$。注意可以有选手在比赛开始两小时之后成绩没有增加，也可以有多个选手来自同一国家。\r\n\r\n#### 样例输入 3\r\n```plain\r\n6\r\n1 70\r\n4 50\r\n1 30\r\n2 20\r\n1 10\r\n3 0\r\n6 100\r\n2 90\r\n1 80\r\n2 60\r\n4 40\r\n1 10\r\n```\r\n#### 样例输出 3\r\n```plain\r\n3\r\n```\r\n#### 样例说明 3\r\n将 $A_1$ 改为 $2$，$A_6$ 改为 $4$，$C_1$ 改为 $4$，榜单就不会互相矛盾了。"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于全部数据，$2\\le N\\le 2\\times 10^5,1\\le A_i,C_i\\le N,0\\le B_i,D_i\\le 10^9$。输入保证 $B_i>B_{i+1},D_i>D_{i+1}\\ (1\\le i<N)$，并且保证存在至少一组修改方案使得榜单不会互相矛盾。\r\n\r\n详细子任务及附加限制如下表：\r\n\r\n|子任务编号|$N$|分值|\r\n|:-:|:-:|:-:|\r\n|$1$|$\\le 16$|$15$|\r\n|$2$|$\\le 50$|$15$|\r\n|$3$|$\\le 5\\times 10^3$|$30$|\r\n|$4$|无附加限制|$40$|"}]}