{"title":"「LNOI2014」LCA","time_limit":1000,"memory_limit":128,"tags":["2014","LNOI","Link-Cut Tree","线段树","树链剖分","点分治","可持久化","树状数组","LCA","数据结构"],"operation":{"submit":"https://loj.ac/problem/2558#submit_code","submissions":"https://loj.ac/submissions?problem_id=2558","statistics":"https://loj.ac/problem/2558/statistics/fastest","testdata":"https://loj.ac/problem/2558/testdata","discussion":"https://loj.ac/discussion/problem/2558"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"给出一个 $n$ 个节点的有根树（编号为 $0$ 到 $n-1$，根节点为 $0$）。一个点的深度定义为这个节点到根的距离 $+1$。\r\n\r\n设 $\\mathrm{dep}[i]$ 表示点i的深度，$\\mathrm{LCA}(i,j)$ 表示 $i$ 与 $j$ 的最近公共祖先。\r\n\r\n有 $q$ 次询问，每次询问给出 $\\texttt{l r z}$，求 $\\sum\\limits_{l\\leq i\\leq r} \\mathrm{dep}[\\mathrm{LCA}(i,z)]$。\r\n\r\n"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行 $2$ 个整数 $n,q$。\r\n\r\n接下来 $n-1$ 行，分别表示点 $1$ 到点 $n-1$ 的父节点编号。\r\n\r\n接下来 $q$ 行，每行 $3$ 个整数 $\\texttt{l r z}$。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出 $q$ 行，每行表示一个询问的答案。每个答案对 $201314$ 取模输出。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n```plain\r\n5 2\r\n0\r\n0\r\n1\r\n1\r\n1 4 3\r\n1 4 2\r\n```\r\n\r\n#### 样例输出\r\n```plain\r\n8\r\n5\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"共 $5$ 组数据，$n$ 与 $q$ 的规模分别为 $10000,20000,30000,40000,50000$。"}]}