{"title":"「ROI 2019 Day2」模式串查找","time_limit":5000,"memory_limit":1024,"tags":["ROI","2019","平衡树","可持久化","字符串"],"operation":{"submit":"https://loj.ac/problem/3194#submit_code","submissions":"https://loj.ac/submissions?problem_id=3194","statistics":"https://loj.ac/problem/3194/statistics/fastest","testdata":"https://loj.ac/problem/3194/testdata","discussion":"https://loj.ac/discussion/problem/3194"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"**译自 [ROI 2019](http://neerc.ifmo.ru/school/archive/2018-2019.html) Day2 T4.** ***[Поиск идеи](http://neerc.ifmo.ru/school/archive/2018-2019/ru-olymp-roi-2019-day2.pdf)***\r\n\r\n给出模式串 $p$，其长度为 $m$。又给出「压缩后的」文本串 $t$，试求 $p$ 在 $t$ 中出现的次数。两个字符串均只包含小写英文字母。\r\n\r\n压缩后的 $t$ 分为 $n$ 个有顺序的块。块的类型及解压方式如下：\r\n\r\n+ 开始解压时 $t$ 为空串。\r\n+ $\\tt1\\it\\ w$，其中 $w$ 是一个字符串。在解压过程中，当读取到这一块时，将 $w$ 放在 $t$ 的末尾。\r\n+ $\\tt2\\rm\\ pos\\ len$，将 $t_{\\rm pos}$ 复制到 $t$ 的末尾，再将 $t_{\\mathrm{pos}+1}$ 复制到 $t$ 的末尾……共复制 $\\rm len$ 个字符。比如，如果 $t=\\tt aba$，当前块为 $2\\ 1\\ 7$，则 $t$ 会变为 $\\tt abaabaabaa$。\r\n\r\n\r\n"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"$m,n$  \r\n$p$  \r\n接下来 $n$ 行，每行一个块"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n```plain\r\n3 4\r\naba\r\n1 ab\r\n2 1 3\r\n2 3 3\r\n2 1 8\r\n```\r\n\r\n#### 样例输出\r\n```plain\r\n6\r\n```\r\n\r\n#### 样例说明\r\n开始：空串  \r\n读取第一块后：$\\tt ab$  \r\n读取第二块后：$\\tt ababa$  \r\n读取第三块后：$\\tt ababaaba$  \r\n读取第四块后：$\\tt ababaabaababaaba$\r\n\r\n$$\\tt ababaabaababaaba\\\\aba\\ \\ aba\\ \\ aba\\ \\ \\ \\\\\\ \\ aba\\ \\ \\ aba\\ \\ aba$$"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"用 $L_i$ 表示读取第 $i$ 块后 $t$ 的长度。\r\n如果第 $i$ 个块属于第二类块，我们用 $\\mathrm{pos}_i$ 和 $\\mathrm{len}_i$ 特指这个块的 $\\rm pos$ 和 $\\rm len$。\r\n\r\n|子任务 #|分值|$m⩽$|$n⩽$|$L_n⩽$|额外条件|\r\n|:------:|:--:|:--:|:--:|:----:|:------:|\r\n|1|6|$\\color{#068}{2000}$|$\\color{#000}{=1}$|$\\color{#068}{1000}$||\r\n|2|10|$\\color{#0a5}{10^5}$|$\\color{#068}{2000}$|$\\color{#960}{10^6}$||\r\n|3|10$ $|$\\color{#068}{2000}$|$\\color{#068}{2000}$|$\\color{#a50}{10^{10}}$|对于任意一个第二类块，<br> $\\mathrm{pos}_i=1$，$\\mathrm{len}_i$ 是 $L_1$ 的因数|\r\n|4|10|$\\color{#068}{2000}$|$\\color{#068}{2000}$|$\\color{#a50}{10^{10}}$|$\\mathrm{pos}_i = L_{i−1}$|\r\n|5|10$ $|$\\color{#000}{20}$|$\\color{#068}{2000}$|$\\color{#a50}{10^{10}}$|$\\mathrm{pos}_i=1, \\mathrm{len}_i⩽10^7$|\r\n|6|4|$\\color{#068}{2000}$|$\\color{#068}{2000}$|$\\color{#a50}{10^{10}}$|$\\mathrm{pos}_i=1, \\mathrm{len}_i⩽10^7$|\r\n|7|10|$\\color{#000}{20}$|$\\color{#000}{20} $|$\\color{#a50}{10^{10}}$|文本串里只包含 $\\tt a$<br>$\\mathrm{pos}_i+\\mathrm{len}i-1⩽L_{i–1}$|\r\n|8|6|$\\color{#000}{20}$|$\\color{#000}{20} $|$\\color{#a50}{10^{10}}$|$\\mathrm{pos}_i+\\mathrm{len}_i-1⩽L_{i–1}$|\r\n|9|2|$\\color{#000}{=1}$|$\\color{#068}{2000}$|$\\color{#a50}{10^{10}}$|文本串里只包含 $\\tt a$|\r\n|10|4|$\\color{#000}{20}$|$\\color{#068}{2000}$|$\\color{#a50}{10^{10}}$|文本串里只包含 $\\tt a$|\r\n|11|5|$\\color{#000}{20}$|$\\color{#068}{2000}$|$\\color{#a50}{10^{10}}$||\r\n|12|14|$\\color{#0a5}{10^5}$|$\\color{#068}{2000}$|$\\color{#a50}{10^{10}}$||\r\n|13|9|$\\color{#790}{2×10^5}$|$\\color{#085}{10^4}$|$\\color{#e30}{10^{15}}$||\r\n\r\n对于所有子任务，保证 $\\sum |w_i|\\le 2\\times 10^5$。"}]}