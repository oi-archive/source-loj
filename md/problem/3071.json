{"title":"「2019 集训队互测 Day 2」神树大人挥动魔杖","time_limit":3000,"memory_limit":512,"tags":["集训队互测","2019","矩阵","多项式 / 形式幂级数","DFT（含 NTT）及FFT","数学"],"operation":{"submit":"https://loj.ac/problem/3071#submit_code","submissions":"https://loj.ac/submissions?problem_id=3071","statistics":"https://loj.ac/problem/3071/statistics/fastest","testdata":"https://loj.ac/problem/3071/testdata","discussion":"https://loj.ac/discussion/problem/3071"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"#### 题目背景\r\n>神树大人想要做一根魔杖，这样他就可以使用「鸽子固定咒」把神 J 固定住了。  \r\n第一天，神树大人在自己身上找了一根木头。神树大人使用了树顶上连神 J 都够不到的树枝。由于这根木头不能被凡人所理解，所以神树大人称它为「迷之木」。  \r\n第二天，神树大人需要为施法创造环境。于是神树大人花了数小时造了一个完整的魔法世界，由于这个世界不能被凡人所理解，所以神树大人称它为「大象世界」。  \r\n第三天，神树大人需要对迷之木附魔。于是神树大人写了一段咒语并让它在大象世界里运行，由于这段咒语不能被凡人所理解，所以神树大人称它为「花之语」。  \r\n神树大人邀请神J来到大象世界游玩，神 J 迟了若干天才到。神 J 见神树大人嘴里念念有词，便问道：「你在干什么？」神树大人立即掏出迷之木，对准神 J 大喊道：  \r\n「system call Joker remove pigeon protection！system call Joker Δεσμευτική！system call Joker ログアウト禁止！...」  \r\n神 J 立刻被固定住了。神树大人很满意，于是离开了大象世界，并命令神 J 留在里面做题。由于这些题不能被凡人所理解，所以神 J 只把简化版给了你\r\n\r\n#### 题目描述\r\n有一排 $N$ 个格子，有 $M$ 个人，初始都在 $1$ 号格。\r\n\r\n每个人可以选择往前跳一格或者跳两格，跳一格的方法数为 $p$，跳两格的方法数为 $q$，跳出 $N$ 个格子则停止，注意在第 $N$ 个格子仍然能选择跳一或两格。\r\n\r\n你需要计算有多少种方法使得每个格子都至少被一个人踩过。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行输入四个整数表示 $N,M,p,q$。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出答案对 $998244353$ 取模。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n\r\n```\r\n10 3 5 6\r\n```\r\n\r\n#### 样例输出 1\r\n\r\n```\r\n273459417\r\n```\r\n\r\n#### 样例输入 2\r\n\r\n```\r\n2 1 3 4\r\n```\r\n\r\n#### 样例输出 2\r\n\r\n```\r\n21\r\n```\r\n\r\n#### 样例输入 3\r\n\r\n```\r\n20010910 666 1 1\r\n```\r\n\r\n#### 样例输出 3\r\n\r\n```\r\n773849796\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于所有数据，$N\\leq 10^9,M\\leq 60000,p,q\\in[0,998244353)$。\r\n\r\n各子任务限制如下：\r\n\r\n- 子任务 $1$（$20$ 分）：$N\\leq 10^9,M\\leq 100$；\r\n- 子任务 $2$（$10$ 分）：$N\\leq 10^3$；\r\n- 子任务 $3$（$10$ 分）：$N\\leq 10^5$；\r\n- 子任务 $4$（$20$ 分）：$N\\leq 10^9,M\\leq 30000,p=q=1$；\r\n- 子任务 $5$（$40$ 分）：无特殊限制。"}]}