{"title":"「HAOI2018」奇怪的背包","time_limit":2000,"memory_limit":512,"tags":["背包 DP","数论"],"operation":{"submit":"https://loj.ac/problem/2523#submit_code","submissions":"https://loj.ac/submissions?problem_id=2523","statistics":"https://loj.ac/problem/2523/statistics/fastest","testdata":"https://loj.ac/problem/2523/testdata","discussion":"https://loj.ac/discussion/problem/2523"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"小C非常擅长背包问题，他有一个奇怪的背包，这个背包有一个参数 $P$ ，当他向这个背包内放入若干个物品后，背包的重量是物品总体积对 $P$ 取模后的结果．\r\n\r\n现在小C有 $n$ 种体积不同的物品，第 $i$ 种占用体积为 $V_i$ ，每种物品都有无限个．他会进行 $q$ 次询问，每次询问给出重量 $w_i$ ，你需要回答有多少种放入物品的方案，能将一个初始为空的背包的重量变为 $w_i$ ．注意，两种方案被认为是不同的，当且仅当放入物品的种类不同，而与每种物品放入的个数无关．不难发现总的方案数为 $2^n$ .\r\n\r\n由于答案可能很大，你只需要输出答案对 $10^9 + 7$ 取模的结果．\r\n\r\n"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行三个整数 $n, q, P$ ，含义见问题描述.\r\n\r\n接下来一行 $n$ 个整数表示 $V_i$ .\r\n\r\n接下来一行 $q$ 个整数表示 $w_i$ .\r\n\r\n"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出 $q$ 行，每行一个整数表示答案．"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n\r\n```plain\r\n3 3 6\r\n1 3 4\r\n5 2 3\r\n```\r\n\r\n#### 样例输出\r\n\r\n```plain\r\n5 \r\n6\r\n6\r\n```\r\n\r\n#### 样例解释\r\n\r\n对于第一个询问 $5$ ，选择 $\\{1\\}, \\{1, 3\\}, \\{1, 4\\}, \\{3, 4\\}, \\{1, 3, 4\\}$ 都是合法的方案．\r\n"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于所有数据，有 $1 \\le n, q \\le 10^6, 3 \\le P \\le 10^9, 0 < V_i, w_i < P$ . \r\n\r\n保证 $V_i$ 两两不同.\r\n"}]}