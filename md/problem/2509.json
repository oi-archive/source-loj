{"title":"「AHOI / HNOI2018」排列","time_limit":1000,"memory_limit":256,"tags":["HNOI","2018","AHOI"],"operation":{"submit":"https://loj.ac/problem/2509#submit_code","submissions":"https://loj.ac/submissions?problem_id=2509","statistics":"https://loj.ac/problem/2509/statistics/fastest","testdata":"https://loj.ac/problem/2509/testdata","discussion":"https://loj.ac/discussion/problem/2509"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"给定 $n$ 个整数 $a_1, a_2, \\ldots , a_n(0 \\le a_i \\le n)$，以及 $n$ 个整数 $w_1, w_2, …, w_n$。称 $a_1, a_2, \\ldots , a_n$ 的一个排列 $a_{p[1]}, a_{p[2]}, \\ldots , a_{p[n]}$ 为 $a_1, a_2, \\ldots , a_n$ 的一个合法排列，当且仅当该排列满足：对于任意的 $k$ 和任意的 $j$，如果 $j \\le k$，那么 $a_{p[j]}$ 不等于 $p[k]$。（换句话说就是：对于任意的 $k$ 和任意的 $j$，如果 $p[k]$ 等于 $a_{p[j]}$，那么 $k<j$。）\r\n\r\n定义这个合法排列的权值为 $w_{p[1]} + 2w_{p[2]} + \\ldots + nw_{p[n]}$。你需要求出在所有合法排列中的最大权值。如果不存在合法排列，输出 $-1$。\r\n\r\n样例解释中给出了合法排列和非法排列的实例。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行一个整数 $n$。\r\n\r\n接下来一行 $n$ 个整数，表示 $a_1,a_2,\\ldots , a_n$。\r\n\r\n接下来一行 $n$ 个整数，表示 $w_1,w_2,\\ldots ,w_n$。\r\n"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出一个整数表示答案。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n3\r\n0 1 1\r\n5 7 3\r\n```\r\n\r\n#### 样例输出 1\r\n```plain\r\n32\r\n```\r\n\r\n#### 样例解释 1\r\n对于 $a_1=0,a_2=1,a_3=1$，其排列有\r\n* $a_1=0,a_2=1,a_3=1$，是合法排列，排列的权值是 $1*5+2*7+3*3=28$；\r\n* $a_2=1,a_1=0,a_3=1$，是非法排列，因为 $a_{p[1]}$ 等于 $p[2]$；\r\n* $a_1=0,a_3=1,a_2=1$，是合法排列，排列的权值是 $1*5+2*3+3*7=32$；\r\n* $a_3=1,a_1=0,a_2=1$，是非法排列，因为 $a_{p[1]}$ 等于 $p[2]$；\r\n* $a_2=1,a_3=1,a_1=0$，是非法排列，因为 $a_{p[1]}$ 等于 $p[3]$；\r\n* $a_3=1,a_2=1,a_1=0$，是非法排列，因为 $a_{p[1]}$ 等于 $p[3]$。\r\n\r\n因此该题输出最大权值 $32$。\r\n\r\n#### 样例输入 2\r\n```plain\r\n3\r\n2 3 1\r\n1 2 3\r\n```\r\n\r\n#### 样例输出 2\r\n```plain\r\n-1\r\n```\r\n\r\n#### 样例解释 2\r\n对于 $a_1=2,a_2=3,a_3=1$，其排列有：\r\n* $a_1=2,a_2=3,a_3=1$，是非法排列，因为 $a_{p[1]}$ 等于 $p[2]$；\r\n* $a_2=3,a_1=2,a_3=1$，是非法排列，因为 $a_{p[1]}$ 等于 $p[3]$；\r\n* $a_1=2,a_3=1,a_2=3$，是非法排列，因为 $a_{p[1]}$ 等于 $p[3]$；\r\n* $a_3=1,a_1=2,a_2=3$，是非法排列，因为 $a_{p[2]}$ 等于 $p[3]$；\r\n* $a_2=3,a_3=1,a_1=2$，是非法排列，因为 $a_{p[2]}$ 等于 $p[3]$；\r\n* $a_3=1,a_2=3,a_1=2$，是非法排列，因为 $a_{p[1]}$ 等于 $p[3]$。\r\n\r\n因此该题没有合法排列。\r\n\r\n#### 样例输入 3\r\n```plain\r\n10\r\n6 6 10 1 7 0 0 1 7 7\r\n16 3 10 20 5 14 17 17 16 13\r\n```\r\n\r\n#### 样例输出 3\r\n```plain\r\n809\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于前 $20\\%$ 的数据，$1 \\le n \\le 10$；\r\n\r\n对于前 $40\\%$ 的数据，$1 \\le n \\le 15$；\r\n\r\n对于前 $60\\%$ 的数据，$1 \\le n \\le 1000$；\r\n\r\n对于前 $80\\%$ 的数据，$1 \\le n \\le 100000$；\r\n\r\n对于 $100\\%$ 的数据，$1 \\le n \\le 500000$，$0 \\le a_i \\le n (1 \\le i \\le n)$，$1 \\le w_i \\le 10^9$ ，所有 $w_i$ 的和不超过 $1.5 \\times 10^{13}$。\r\n"}]}