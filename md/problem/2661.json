{"title":"「POI2007」驾驶考试 Driving Exam","time_limit":1000,"memory_limit":32,"tags":["POI","早于 2010"],"operation":{"submit":"https://loj.ac/problem/2661#submit_code","submissions":"https://loj.ac/submissions?problem_id=2661","statistics":"https://loj.ac/problem/2661/statistics/fastest","testdata":"https://loj.ac/problem/2661/testdata","discussion":"https://loj.ac/discussion/problem/2661"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"**译自 POI 2007 Stage 3. Day 2「[Egzamin na prawo jazdy](https://szkopul.edu.pl/problemset/problem/nLSrpyeJ1JnFGbBORYVVavIQ/site/?key=statement)」**\r\n\r\nByteotian 驾驶考试所在的区域有 $n$ 条互相平行的自南向北的道路，每条道路长为 $m$ 米，且在同一条水平线上开始、结束。另有 $p$ 条自东向西或自西向东的道路，连接两条相邻的自南向北的道路。注意可能有两条自东向西的道路和自西向东的道路重合，相当于一条双向道路。\r\n\r\n![egz1.png](https://loj-img.upyun.menci.memset0.cn/2020/01/27/5e2e8790ec919.png)\r\n\r\n上图为 $n=4,m=3,p=5$ 的例子。\r\n\r\n考生可以选择一条自南向北的道路作为起始点，且从该道路开始必须能到达其它所有的道路。\r\n\r\n你需要添加至多 $k$ 条东西向的道路，使得满足条件的起始点最多。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行四个整数 $n,m,p,k$（$2 \\le n \\le 100\\ 000,1 \\le m,k \\le 100\\ 000,0 \\le p \\le 100\\ 000$），分别表示自南向北的道路数量、这些道路的长度、初始时已有的自东向西或自西向东的道路数量、可以添加的道路的数量。自南向北的道路从西向东编号为 $1 \\ldots n$。\r\n\r\n接下来 $p$ 行每行三个整数 $n_i, m_i, d_i (1 \\le n_i \\lt n,0 \\le m_i \\lt m,d_i \\in \\{0,1\\})$，表示一条连接第 $n_i$ 和 $n_i+1$ 条自南向北的道路、且距离起点 $m_i$ 米的东西向道路。$d_i = 0$ 时为向东的道路，$d_i = 1$ 时为向西的道路。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出一行，表示**新产生**的起始点的最大数量。添加的东西向道路**不一定**要在整点和南北向道路相交。自东向西的道路和自西向东的可以重叠，相当于双向道路。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n```plain\r\n4 3 5 2\r\n2 0 0\r\n2 2 1\r\n3 3 1\r\n1 1 1\r\n3 3 0\r\n```\r\n\r\n#### 样例输出\r\n```plain\r\n2\r\n```\r\n\r\n#### 样例解释\r\n![egz2.png](https://loj-img.upyun.menci.memset0.cn/2020/01/27/5e2e879002222.png)"}]}