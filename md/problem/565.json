{"title":"「LibreOJ Round #10」mathematican 的二进制","time_limit":2000,"memory_limit":512,"tags":["LibreOJ Round","DFT（含 NTT）及FFT","概率与期望","生成函数","数学","二进制","递推"],"operation":{"submit":"https://loj.ac/problem/565#submit_code","submissions":"https://loj.ac/submissions?problem_id=565","statistics":"https://loj.ac/problem/565/statistics/fastest","testdata":"https://loj.ac/problem/565/testdata","discussion":"https://loj.ac/discussion/problem/565"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"有一个长度很大的二进制串，初始时它的每一位都为 0。现在有 $m$ 个操作，其中第 $i$ 个操作是将这个二进制串的数值加上 ${2}^{a_i}$ $({0}\\leq{a_i}\\leq{n})$，或者说，给第 $a_i$ 位加上 $1$ 并进位，我们称每次操作的代价是这次操作改变的位的数量。例如，当前的二进制串是 $10111$ 时，如果给它加上 $2^0$，串就变成了 $11000$，其中从低到高第 $0,1,2,3$ 位发生了改变，那么这次操作代价为 $4$。\r\n\r\n我们以一定概率执行这些操作：第 $i$ 个操作有 $p_i$ 的概率执行，否则不执行。请求出所有执行的操作的代价和的期望。\r\n\r\n你只需要求出期望改变的位数在模 $998244353$ 意义下的值。具体来说，如果你算出来的期望$E = {\\frac{P}{Q}}$，其中 $P,Q$ 互质，那么你只要输出 $({P}{Q^{-1}})\\pmod{998244353}$，其中 $Q^{-1}\\pmod{998244353}$ 表示 $Q$ 在 $\\pmod{998244353}$ 意义下的逆元。\r\n\r\n**注意：执行完操作后，该串去除前导 $0$ 后的长度可能大于 $n$。**"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行两个用空格分隔的正整数 $n,m$，分别表示 $a_i$ 的范围和操作数，如上文所述。\r\n\r\n接下来 $m$ 行，每行三个正整数 $a_i, x_i, y_i$，其中 $p_i = {\\frac{x_i}{y_i}}$。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"仅一行，表示答案。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n4 4\r\n0 1 2\r\n0 1 2\r\n0 1 2\r\n0 1 2\r\n```\r\n\r\n#### 样例输出 1\r\n```plain\r\n187170819\r\n```\r\n\r\n#### 样例输入 2\r\n```plain\r\n233 6\r\n1 166 233\r\n2 233 666\r\n3 166 266\r\n4 233 266\r\n5 233 666\r\n6 166 233\r\n```\r\n\r\n#### 样例输出 2\r\n```plain\r\n56615945\r\n```\r\n\r\n#### 样例 3\r\n见附加文件。"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于所有数据，$1\\le {n,m} \\leq{200000}, 0\\le x<998244353,1\\le y<998244353$。\r\n\r\n|子任务编号|分值|$n \\leq$|$m\\leq$|特殊限制|\r\n|:------------:|:----:|:------------:|:--------:|:--------:|\r\n|1|$5$|$17$|$17$|-|\r\n|2|$15$|$1$|$3000$|$a_i=0$|\r\n|3|$20$|$1$|$2\\times 10^5$|$a_i=0$|\r\n|4|$20$|$3000$|$3000$|-|\r\n|5|$40$|$2\\times 10^5$|$2\\times 10^5$|-|\r\n"}]}