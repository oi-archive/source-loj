{"title":"「SNOI2020」区间和","time_limit":3000,"memory_limit":512,"tags":["SNOI","2020","线段树","复杂度分析"],"operation":{"submit":"https://loj.ac/problem/3325#submit_code","submissions":"https://loj.ac/submissions?problem_id=3325","statistics":"https://loj.ac/problem/3325/statistics/fastest","testdata":"https://loj.ac/problem/3325/testdata","discussion":"https://loj.ac/discussion/problem/3325"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"有一个长度为 $n$ 的整数数列 $a_1, a_2, \\dots, a_n$（可能含有负数）。现在对其进行 $q$ 次操作，每次操作是以下二者之一：\r\n\r\n- `0 l r x` 表示对于 $i = l, l+1, \\dots, r$，将 $a_i$ 赋值为 $\\max(a_i, x)$；\r\n- `1 l r` 求区间 $[l, r]$ 的最大子段和。即：$\\max(0, \\max_{l\\le u\\le v\\le r} (\\sum_{i=u}^v a_i))$。\r\n"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行两个正整数 $n,q$，分别表示序列长度和操作次数；\r\n\r\n第二行 $n$ 个正整数 $a_1, a_2, \\dots, a_n$ 表示初始的序列；\r\n\r\n接下来 $q$ 行，每行形如 `0 l r x` 或 `1 l r` 表示一次操作。\r\n"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"对于每个形如 `1 l r` 的操作，输出一行一个整数表示答案。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n\r\n```plain\r\n5 7\r\n2 -4 6 -5 5\r\n1 1 5\r\n0 1 5 -4\r\n1 1 5\r\n0 3 4 -1\r\n1 1 5\r\n0 1 3 -1\r\n1 1 5\r\n```\r\n\r\n#### 样例输出\r\n\r\n```plain\r\n6\r\n7\r\n10\r\n11\r\n```\r\n\r\n#### 样例解释\r\n\r\n- 第 $1$ 次询问时序列为 $2,-4,6,-5,5$，最大子段和为 $6$；\r\n- 第 $2$ 次询问时序列为 $2,-4,6,-4,5$，最大子段和为 $6+(-4)+5=7$；\r\n- 第 $3$ 次询问时序列为 $2,-4,6,-1,5$，最大子段和为 $6+(-1)+5=10$；\r\n- 第 $4$ 次询问时序列为 $2,-1,6,-1,5$，最大子段和为 $2+(-1)+6+(-1)+5=11$；\r\n"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于所有数据，$1\\le n\\le10^5, 1\\le q\\le 2\\times 10^5, |a_i|, |x|\\le 10^9$。\r\n\r\n- 对于 $10\\%$ 的数据，$n,q\\le 200$；\r\n- 对于另外 $10\\%$ 的数据，$n,q\\le 2000$；\r\n- 对于另外 $25\\%$ 的数据，每次操作 $0$ 均满足 $l=r$（即，只有单点修改）；\r\n- 对于另外 $20\\%$ 的数据，每次操作 $1$ 均满足 $l = 1, r = n$（即，只有全局询问）；\r\n- 对于余下 $35\\%$ 的数据，无特殊限制。"}]}