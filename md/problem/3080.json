{"title":"「2019 集训队互测 Day 5」国际象棋","time_limit":3000,"memory_limit":512,"tags":["集训队互测","2019","概率与期望","高斯消元"],"operation":{"submit":"https://loj.ac/problem/3080#submit_code","submissions":"https://loj.ac/submissions?problem_id=3080","statistics":"https://loj.ac/problem/3080/statistics/fastest","testdata":"https://loj.ac/problem/3080/testdata","discussion":"https://loj.ac/discussion/problem/3080"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"英国之王 <b>C<font color=red>auchySheep</font></b> 最近在研究国际象棋。<b>C<font color=red>auchySheep</font></b> 认为棋盘太小了，所以他自创了一套规则：\r\n\r\n在本题中，国际象棋的棋盘是一个 $n\\times m$ 的网格，第 $i(1\\le i\\le n)$ 行第 $j(1\\le j\\le m)$ 个格子简记为 $(i, j)$ 。为了简化问题，棋盘上只有一枚棋子：骑士。\r\n\r\n现在 <b>C<font color=red>auchySheep</font></b> 将骑士放在 $(sx, sy)$ ，然后开始随机游走。具体地，每个回合，假设骑士当前在 $(x,y)$ ，则它：\r\n\r\n- 有 $p_1$ 的概率走到 $(x-2,y-1)$ 。\r\n- 有 $p_2$ 的概率走到 $(x-1,y-2)$ 。\r\n- 有 $p_3$ 的概率走到 $(x+1,y-2)$ 。\r\n- 有 $p_4​$ 的概率走到 $(x+2,y-1)​$ 。\r\n- 有 $p_5$ 的概率走到 $(x+2,y+1)$ 。\r\n- 有 $p_6$ 的概率走到 $(x+1,y+2)$ 。\r\n- 有 $p_7$ 的概率走到 $(x-1,y+2)$ 。\r\n- 有 $p_8$ 的概率走到 $(x-2,y+1)$ 。\r\n\r\n当骑士走出棋盘时，游戏就结束了。\r\n\r\n现在 <b>C<font color=red>auchySheep</font></b> 想要知道游戏期望经过多少个回合结束。<b>C<font color=red>auchySheep</font></b> 当然会做这个题，但是他想考考你。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"从标准输入读入数据。 \r\n\r\n第一行两个正整数 $n,m$ 。\r\n\r\n第二行 $8$ 个正整数 $w_1, w_2, \\cdots, w_8$ 用于计算 $p$ ， $p_i = \\frac{w_i}{\\sum_{j=1}^8 w_j}$ 。\r\n\r\n第三行一个正整数 $q$ 表示询问个数。\r\n\r\n接下来 $q$ 行，每行两个正整数 $sx, sy$ 表示起始坐标。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出到标准输出中。 \r\n\r\n对于每个询问，输出一行一个整数表示答案在模 $998244353$ 意义下的值。具体地，假设答案化成既约分数后是 $\\frac{p}{q}$ ，则你只需要输出 $pq^{-1}\\bmod 998244353$ 的值即可。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n\r\n```\r\n3 3\r\n1 1 1 1 1 1 1 1\r\n2\r\n2 2\r\n1 1\r\n```\r\n\r\n#### 样例输出 1\r\n\r\n```\r\n1\r\n332748119\r\n```\r\n\r\n#### 样例解释 1\r\n\r\n当 $(sx, sy) = (2, 2)$ 时，骑士不管怎么走都会一步走出棋盘，答案为 $1$ 。\r\n\r\n当 $(sx, sy) = (1, 1)$ 时，答案为 $\\frac{4}{3}$ 。\r\n\r\n#### 样例输入 2\r\n\r\n```\r\n8 8\r\n1 2 3 4 5 6 7 8\r\n4\r\n1 2\r\n3 4\r\n5 6\r\n7 8\r\n```\r\n\r\n#### 样例输出 2\r\n\r\n```\r\n691709817\r\n186871978\r\n807608945\r\n374193381\r\n```\r\n\r\n#### 样例解释 2\r\n\r\n我有一个绝妙的解释，可是这里地方太小，写不下。"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于所有数据，满足 $2\\le n, m\\le 200, 1\\le w_i\\le 100, 1\\le q\\le nm$，询问的 $(sx, sy)$ 互不相同。\r\n\r\n共有六个子任务，每个子任务的特殊限制和分值如下：\r\n\r\n* 子任务 $1$（$10$ 分）：$n, m\\le 20$；\r\n* 子任务 $2$（$10$ 分）：$n, m\\le 50$；\r\n* 子任务 $3$（$20$ 分）：$n, m\\le 80$，$q=1$；\r\n* 子任务 $4$（$20$ 分）：$n, m\\le 80$；\r\n* 子任务 $5$（$20$ 分）：$m$ 是偶数；\r\n* 子任务 $6$（$20$ 分）：没有附加限制。"}]}