{"title":"「LibreOJ β Round」ZQC 的截图","time_limit":3000,"memory_limit":128,"tags":["原创","LibreOJ β Round","hash","hash 表","随机化"],"operation":{"submit":"https://loj.ac/problem/502#submit_code","submissions":"https://loj.ac/submissions?problem_id=502","statistics":"https://loj.ac/problem/502/statistics/fastest","testdata":"https://loj.ac/problem/502/testdata","discussion":"https://loj.ac/discussion/problem/502"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"一个阳光明媚的午后，ZQC 在水 QQ 群，突然他发现一位神犇发了一条装弱消息，机智的 ZQC 立即截图保存。接着，不出 ZQC 所料，群里发生了著名的“无穷递降装弱效应”。“无穷递降装弱效应”是指一位神犇装弱后，只要有一个人截图，就会发生大量的人嵌套截图的现象 ……\r\n\r\nZQC 对屏幕上不断滚动的嵌套截图消息十分感兴趣，他想让你帮他算一个东西。在这之前，他认为有必要再强调一些关于截图消息的概念：\r\n\r\n一条截图消息 $M$ 可以由一个二元组 $ (u,M') $ 来表示，其中 $ u $ 是这条消息的发送者，$M'$ 是另一条截图消息或 $\\mathrm{NIL}$。$ M'=\\mathrm{NIL} $ 表示这条消息记录是最开始的装弱消息。\r\n\r\n例如，这条消息（最开始的装弱消息）可以表示为 $ (A,\\mathrm{NIL}) $：\r\n\r\n![1.png](https://ooo.0o0.ooo/2017/06/14/5940d178596fb.png)\r\n\r\n而这条消息可以表示为 $ (B,(A,\\mathrm{NIL})) $：\r\n\r\n![2.png](https://ooo.0o0.ooo/2017/06/14/5940d1787d0f2.png)\r\n\r\n如果设第一条消息为 $ S=(A,\\mathrm{NIL}) $，第二条消息也可以表示为 $ (B,S) $。\r\n\r\n消息中一个人的出现次数定义如下： 设 $ f(M,v) $ 表示消息 $ M=(u,M') $ 中 $ v $ 的出现次数，则：\r\n\r\n$$\r\nf(M,v)=\\begin{cases}\r\n[u=v]& M'=\\mathrm{NIL}\\\\\r\nf(M',v)+[u=v]& M'\\neq\\mathrm{NIL}\r\n\\end{cases}\r\n$$\r\n\r\n其中 $[u=v]$ 这个表达式当 $u=v$ 时值为 1，否则为 0。\r\n\r\nZQC 终于想好要考你什么了。对于每条消息，你需要帮他算出这些：\r\n\r\n1. 是否这条消息中所有人的出现次数都是 $3$ 的倍数。\r\n2. 如果 1 的答案是“否”，这条消息中是否只有一个人的出现次数不是 $3$ 的倍数。 \r\n3. 如果 2 的答案是“是”，那个人是谁。\r\n\r\n因为屏幕上的消息是一条一条发出来的，所以你也需要一条一条依序回答。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行两个正整数 $ n,m $ 表示 ZQC 所在的群里有 $ n(3\\leq n \\leq 10^6)$ 个成员，一共发了 $ m(1\\leq m\\leq 2\\times 10^6) $ 条消息。  \r\n接下来 $ m $ 行每行两个正整数 $u_i,M'_i$，表示第 $ i $ 条消息是 $ (u_i,M'_i) $。$M'_i=0$ 表示 $\\mathrm{NIL}$，否则表示第 $M'_i$ 条消息。保证 $ 1\\leq u_i\\leq n,0\\leq M'_i<i $。  \r\n为了体现回答的顺序性，设上次的答案为 $\\mathrm{lastans}$，你需要给输入的 $u_i,M'_i$ 分别异或上 $\\mathrm{lastans}$ 之后才能得到真实的输入。对于第一次询问，$\\mathrm{lastans}=0$。注意，这里**做异或请用 32 位有符号整数**。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出 $ m $ 行，第 $ i $ 行一个整数表示对于第 $ i $ 条消息的计算结果。  \r\n如果 1 的答案是“是”，请输出 `-1`；  \r\n否则如果 2 的答案是“否”，请输出 `-2`；  \r\n否则，输出一个正整数表示那个人的编号。  "},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n2 5\r\n2 0\r\n3 3\r\n-1 -4\r\n-1 -3\r\n0 3\r\n```\r\n\r\n#### 样例输出 1\r\n```plain\r\n2\r\n-2\r\n-2\r\n2\r\n2\r\n```\r\n\r\n#### 样例解释 1\r\n真实输入如下：\r\n```plain\r\n2 5\r\n2 0\r\n1 1\r\n1 2\r\n1 3\r\n2 1\r\n```\r\n\r\n第 1 条消息中出现的人：$\\{2\\}$，只有 $2$ 的出现次数不是 $3$ 的倍数。  \r\n第 2 条消息中出现的人：$\\{2,1\\}$，$1,2$ 的出现次数都不是 $3$ 的倍数。  \r\n第 3 条消息中出现的人：$\\{2,1,1\\}$，$1,2$ 的出现次数都不是 $3$ 的倍数。  \r\n第 4 条消息中出现的人：$\\{2,1,1,1\\}$，只有 $2$ 的出现次数不是 $3$ 的倍数。  \r\n第 5 条消息中出现的人：$\\{2,2\\}$，只有 $2$ 的出现次数不是 $3$ 的倍数。  \r\n\r\n#### 样例输入 2\r\n```plain\r\n13 15\r\n5 0\r\n0 4\r\n2 4\r\n-5 -4\r\n-8 -4\r\n-7 -5\r\n0 7\r\n-6 -2\r\n3 6\r\n-3 -7\r\n2 10\r\n-5 -4\r\n-4 -13\r\n8 7\r\n0 7\r\n```\r\n\r\n#### 样例输出 2\r\n```plain\r\n5\r\n5\r\n-2\r\n-1\r\n-2\r\n5\r\n-1\r\n5\r\n-2\r\n3\r\n-2\r\n-1\r\n3\r\n11\r\n11\r\n```\r\n\r\n#### 样例解释 2\r\n真实输入如下：\r\n\r\n```plain\r\n13 15\r\n5 0\r\n5 1\r\n7 1\r\n5 2\r\n7 3\r\n7 5\r\n5 2\r\n5 1\r\n6 3\r\n3 7\r\n1 9\r\n5 2\r\n3 12\r\n11 4\r\n11 12\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"出题人的关怀：由于输入规模较大，建议使用读入优化。"}]}