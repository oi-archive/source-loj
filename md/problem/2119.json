{"title":"「HEOI2015」公约数数列","time_limit":1000,"memory_limit":256,"tags":["2015","HEOI","分块及按大小分类"],"operation":{"submit":"https://loj.ac/problem/2119#submit_code","submissions":"https://loj.ac/submissions?problem_id=2119","statistics":"https://loj.ac/problem/2119/statistics/fastest","testdata":"https://loj.ac/problem/2119/testdata","discussion":"https://loj.ac/discussion/problem/2119"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"设计一个数据结构. 给定一个正整数数列 $a_0, a_1, \\ldots , a_{n - 1}$，你需要支持以下两种操作：\r\n\r\n1. ``MODIFY id x``: 将 $a_{\\text{id}}$ 修改为 $x$.\r\n2. ``QUERY x``: 求最小的整数 $p$ ($0 \\leq p < n$)，使得 $\\text{gcd}(a_0, a_1, ..., a_p) \\cdot \\text{XOR}(a_0, a_1, ..., a_p) = x$. 其中 $\\text{XOR}(a_0, a_1, ..., a_p)$ 代表 $a_0, a_1, \\ldots , a_p$ 的异或和，$\\text{gcd}$ 表示最大公约数。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"输入数据的第一行包含一个正整数 $n$。\r\n\r\n接下来一行包含 $n$ 个正整数 $a_0, a_1, ..., a_{n - 1}$。\r\n\r\n之后一行包含一个正整数 $q$，表示询问的个数。\r\n\r\n之后 $q$ 行，每行包含一个询问。格式如题目中所述。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"对于每个 ``QUERY`` 询问，在单独的一行中输出结果。如果不存在这样的 $p$，输出 ``no``."},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n```plain\r\n10\r\n1353600 5821200 10752000 1670400 3729600 6844320 12544000 117600 59400 640\r\n10\r\nMODIFY 7 20321280\r\nQUERY 162343680\r\nQUERY 1832232960000\r\nMODIFY 0 92160\r\nQUERY 1234567\r\nQUERY 3989856000\r\nQUERY 833018560\r\nMODIFY 3 8600\r\nMODIFY 5 5306112\r\nQUERY 148900352\r\n```\r\n\r\n#### 样例输出\r\n```plain\r\n6\r\n0\r\nno\r\n2\r\n8\r\n8\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于 $100\\%$ 的数据，$n \\leq 100000, \\  q \\leq 10000, \\ a_i \\leq 10^9 (0 \\leq i < n)$，``QUERY x`` 中的 $x \\leq 10^{18}$，``MODIFY id x`` 中的 $0 \\leq \\text{id} < n, \\ 1 \\leq x \\leq 10^9$。"}]}