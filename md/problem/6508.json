{"title":"「雅礼集训 2018 Day7」B","time_limit":1000,"memory_limit":512,"tags":["雅礼集训","2018","线段树","数据结构","数学"],"operation":{"submit":"https://loj.ac/problem/6508#submit_code","submissions":"https://loj.ac/submissions?problem_id=6508","statistics":"https://loj.ac/problem/6508/statistics/fastest","testdata":"https://loj.ac/problem/6508/testdata","discussion":"https://loj.ac/discussion/problem/6508"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"给定一个长度为 $n$ 的 01 串 $S$ 和一个长度为 $m$ 的 01 串 $T$。\r\n\r\n$S$ 通过给定的参数 $a, b, c$ 构造，其中 $a$ 满足 ${\\rm gcd}(a, n) = 1$：\r\n\r\n$$S_i = [(a\\cdot i + b)\\ {\\rm mod}\\ n \\geq c]$$\r\n\r\n现在有 $q$ 个操作或询问：\r\n\r\n- `1 p`：询问 $S$ 的第 $p$ 位开始往后取 $m$ 位得到的字符串与 $T$ 有多少位不同\r\n- `2 p`：将 $T$ 的第 $p$ 位取反\r\n"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行五个正整数 $n, a, b, c, m$。\r\n\r\n第二行一个长度为 $m$ 的字符串表示 $T$。\r\n\r\n第三行一个整数 $q$。\r\n\r\n接下来 $q$ 行，一行表示一个操作或询问，格式如上文所述。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"对于每一个询问，输出一行一个整数表示答案。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n9 5 6 4 3\r\n101\r\n11\r\n1 0\r\n1 1\r\n1 2\r\n1 3\r\n1 4\r\n1 5\r\n1 6\r\n1 7\r\n1 8\r\n2 1\r\n1 3\r\n```\r\n\r\n#### 样例输出 1\r\n```plain\r\n0\r\n3\r\n0\r\n2\r\n2\r\n0\r\n3\r\n0\r\n3\r\n1\r\n```\r\n"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于全部数据，$1 \\leq a, b, p, m < n \\leq 10^9, 1 \\leq m, q \\leq 100000, {\\rm gcd}(a, n) = 1$。\r\n\r\n- 存在 $40 \\%$ 的数据， $n, m, q \\leq 5000$。"}]}