{"title":"「ROI 2017 Day 2」水星上的服务器","time_limit":700,"memory_limit":512,"tags":["2017","ROI"],"operation":{"submit":"https://loj.ac/problem/2771#submit_code","submissions":"https://loj.ac/submissions?problem_id=2771","statistics":"https://loj.ac/problem/2771/statistics/fastest","testdata":"https://loj.ac/problem/2771/testdata","discussion":"https://loj.ac/discussion/problem/2771"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"**题目译自 [ROI 2017](http://neerc.ifmo.ru/school/archive/2016-2017.html) Day 2 T2.** ***[Серверы на Меркурии](http://neerc.ifmo.ru/school/archive/2016-2017/ru-olymp-roi-2017-day2.pdf)***\r\n\r\n水星上有编号为 $1$ 到 $N$ 的 $N$ 台服务器，这些服务器的通讯呈链式结构。具体来说，我们用 $N-1$ 条信道（视为无向边）连接了这些服务器，第 $i$ 条信道连接 $i$ 号服务器和 $i+1$ 号服务器。  \r\n假设 $j$ 号服务器收到了地球发来的补丁。你需要尽快将补丁传输到其他服务器。  \r\n一台服务器收到补丁后，会立刻安装这个补丁（安装时间忽略不计），并且将补丁在这台服务器的缓冲区里保留 $t_j$ 秒，之后将其删除。  \r\n由于太阳活动的影响，第 $i$ 条通信信道只能在时段 $[l_i, r_i]$（时刻 $l_i$ 到时刻 $r_i$）接通。某条通信信道接通后，如果信道一端的服务器 A 的缓冲区里有补丁，而另一端的服务器 B 没有安装这个补丁，A 就会通过信道向 B 传输这个补丁。请注意，传输补丁的时间忽略不计。注意，你可以**任选**地球把补丁发给 $j$ 号服务器的时刻。  \r\n\r\n对于每个 $j$ $(1\\le j\\le N)$，假设 $j$ 号服务器第一个收到补丁，试求：最早在什么时候把补丁发给 $j$ 号服务器，才能保证所有服务器最后都能装上补丁，如果不可能，请输出 `-1`。\r\n"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行有一个整数 $n$。  \r\n第二行有 $n$ 个整数 $t_1,$ $t_2,$ $\\ldots,$ $t_n$。  \r\n在接下来的 $n-1$ 行中，每行两个整数 $l_i,$ $r_i$。\r\n"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出 $n$ 行，每行一个整数，表示：最早在什么时候把补丁发给 $j$ 号服务器，才能保证所有服务器最后都能装上补丁。若不可能，请输出 `-1`。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n1\r\n10\r\n```\r\n\r\n#### 样例输出 1\r\n```plain\r\n0\r\n```\r\n\r\n#### 样例输入 2\r\n```plain\r\n2\r\n3 5\r\n6 8\r\n```\r\n\r\n#### 样例输出 2\r\n```plain\r\n3\r\n1\r\n```\r\n\r\n#### 样例输入 3\r\n```plain\r\n3\r\n1 2 4\r\n7 10\r\n3 5\r\n```\r\n\r\n#### 样例输出 3\r\n```plain\r\n-1\r\n5\r\n5\r\n```\r\n\r\n#### 样例解释 3\r\n如果 $1$ 号服务器首先收到补丁，$3$ 号服务器就无法得到补丁，因为 $2$ 号信道在 $1$ 号信道开启前就关闭了。  \r\n如果 $2$ 号服务器在第 $5$ 秒收到补丁，则 $3$ 号服务器可以立即收到补丁，之后，等到第 $7$ 秒时 $1$ 号信道开启时，$1$ 号服务器就会收到补丁。  \r\n如果 $3$ 号服务器在第 $5$ 秒收到补丁，则 $2$ 号服务器可以立即收到补丁，之后，等到第 $7$ 秒时 $1$ 号信道开启时，$1$ 号服务器就会收到补丁。\r\n\r\n#### 样例输入 4\r\n```plain\r\n4\r\n1 0 3 2\r\n4 6\r\n5 5\r\n7 10\r\n```\r\n\r\n#### 样例输出 4\r\n```plain\r\n5\r\n5\r\n4\r\n-1\r\n```\r\n\r\n#### 样例解释 4\r\n若 $2$ 号服务器首先收到补丁，由于 $2$ 号服务器从不缓存，且 $2$ 号信道只在第 $5$ 秒开启，为了让 $3$ 号服务器拿到补丁，你只能选择在第 $5$ 秒把补丁发给 $2$ 号服务器。  \r\n若 $3$ 号服务器首先收到补丁，不妨选择第 $4$ 秒，$3$ 号服务器会将其缓存至第 $7$ 秒，这样 $2$ 号和 $4$ 号服务器都能拿到补丁。"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于所有数据，$0 ⩽ l_i ⩽ r_i ⩽ 10^9$。\r\n\r\n|子任务编号|分值|$n$|$t_i$|$r_i$|\r\n|:-:|:-:|:-:|:-:|:-:|\r\n|1|20|$1 ⩽ n ⩽ 500$|$0 ⩽ t_i ⩽ 500$|$0 ⩽ r_i ⩽ 500$|\r\n|2|10|$1 ⩽ n ⩽ 5000$|$t_i = 5000$|$0 ⩽ r_i ⩽ 5000$|\r\n|3|&nbsp;10&nbsp;|$1 ⩽ n ⩽ 5000$|$0 ⩽ t_i ⩽ 5000$|$r_i = 5000$|\r\n|4|10|$1 ⩽ n ⩽ 5000$|$0 ⩽ t_i ⩽ 5000$|$0 ⩽ r_i ⩽ 5000$|\r\n|5|15|$1 ⩽ n ⩽ 2\\times 10^5$|$t_i = 10^9$|$0 ⩽ r_i ⩽ 10^9$|\r\n|6|&nbsp;15&nbsp;|$1 ⩽ n ⩽ 2\\times 10^5$|$0 ⩽ t_i ⩽ 10^9$|$r_i = 10^9$|\r\n|7|20|$1 ⩽ n ⩽ 2\\times 10^5$|$0 ⩽ t_i ⩽ 10^9$|$0 ⩽ r_i ⩽ 10^9$|"}]}