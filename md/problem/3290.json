{"title":"「CEOI2014」蛋糕","time_limit":2000,"memory_limit":1024,"tags":["2014","CEOI","线段树","数据结构"],"operation":{"submit":"https://loj.ac/problem/3290#submit_code","submissions":"https://loj.ac/submissions?problem_id=3290","statistics":"https://loj.ac/problem/3290/statistics/fastest","testdata":"https://loj.ac/problem/3290/testdata","discussion":"https://loj.ac/discussion/problem/3290"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"**译自 [CEOI 2014](http://web.archive.org/web/20140628072203/http://ceoi2014.informatik-olympiade.de/?page_id=473) Day2 T2「[Cake](http://web.archive.org/web/20140630103647/http://ceoi2014.informatik-olympiade.de/wp-content/uploads/2014/06/cake.pdf)」，原网站因为神秘原因没法访问了，这里用的 Web Archive 链接。**\r\n\r\nLeopold 和 Molly 都喜欢蛋糕：Leopold 喜欢吃蛋糕，Molly 喜欢看 Leopold 吃蛋糕。\r\n\r\n现在有 $n$ 块蛋糕排成一排，从左到右数的第 $i$ 块蛋糕编号为 $i$，每块蛋糕有一个美味度 $d_i$。\r\n\r\nLeopold 会先吃掉编号为 $a$ 的蛋糕，这样位置 $a$ 就空了。接下来每次他会选择一个与空出的位置相邻的蛋糕中美味度最小的蛋糕吃掉（要把好吃的留到最后）。你可以发现空出的位置一定是一个连续的区间。\r\n\r\n为了让事情更加有趣，Molly 有时会给某一块蛋糕上加一点装饰，以增加它的美味度。她保证做完此操作后，这块蛋糕的美味度会变成所有蛋糕中前 $10$ 大的。而且在任何时候任意两块蛋糕的美味度都不同。\r\n\r\n有时 Molly 好奇在 Leopold 吃掉某块特定的编号为 $b$ 的蛋糕之前，他会吃掉多少块蛋糕。\r\n\r\n请你帮助 Molly 编写一个程序，给出操作序列，回答 Molly 的询问。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行两个正整数 $n, a$，分别表示蛋糕总块数以及 Leopold 第一次会吃掉哪一块蛋糕。  \r\n第二行 $n$ 个互不相同的正整数 $d_1, d_2, \\ldots , d_n$，表示蛋糕的初始美丽度。  \r\n第三行一个正整数 $q$，表示操作的个数。  \r\n接下来 $q$ 行，每行形如 `E i e` 或 `F b` 表示一次操作：\r\n\r\n- `E i e`：将编号为 $i$ 的蛋糕的美味度提升至第 $e$ 美味的。保证在操作之前比编号为 $i$ 的蛋糕美味的蛋糕的数量至少为 $e$。\r\n\r\n- `F b`：询问 Leopold 在吃掉编号为 $b$ 的蛋糕之前会吃掉多少块蛋糕。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"对于每个 `F` 操作，输出一行一个数表示答案。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n```plain\r\n5 3\r\n5 1 2 4 3\r\n17\r\nF 1\r\nF 2\r\nF 3\r\nF 4\r\nF 5\r\nE 2 1\r\nF 1\r\nF 2\r\nF 3\r\nF 4\r\nF 5\r\nE 5 2\r\nF 1\r\nF 2\r\nF 3\r\nF 4\r\nF 5\r\n```\r\n\r\n#### 样例输出\r\n```plain\r\n4\r\n1\r\n0\r\n2\r\n3\r\n4\r\n3\r\n0\r\n1\r\n2\r\n4\r\n3\r\n0\r\n1\r\n2\r\n```\r\n\r\n#### 样例解释\r\n在第一次增加美味度之前，编号为 $3, 2, 4, 5, 1$ 的蛋糕会依次被吃掉。但接下来编号为 $1$ 的蛋糕太好吃了以至于它不会先被吃掉，编号为 $4$ 和 $5$ 的蛋糕先被吃掉了。注意最后一次对编号为 $5$ 的蛋糕的美味度的增加不会改变吃蛋糕的顺序。"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于所有数据，保证 $1 \\le n \\le 2.5 \\times {10}^5$，$1 \\le q \\le 5 \\times {10}^5$，$1 \\le d_i, a, i, b \\le n$，$1 \\le e \\le 10$。\r\n\r\n| 子任务编号 | 分值 | 特殊限制 |\r\n| :-: | :-: | :-: |\r\n| $1$ | $15$ | $n, q \\le {10}^4$ |\r\n| $2$ | $15$ | $n \\le 2.5 \\times {10}^4$ 且 `F` 操作的数量不超过 $500$ |\r\n| $3$ | $20$ | $q \\le {10}^5$ 且 `E` 操作的数量不超过 $100$ |\r\n| $4$ | $50$ | 无特殊限制 |"}]}