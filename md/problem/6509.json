{"title":"「雅礼集训 2018 Day7」C","time_limit":1000,"memory_limit":512,"tags":["雅礼集训","2018","概率与期望"],"operation":{"submit":"https://loj.ac/problem/6509#submit_code","submissions":"https://loj.ac/submissions?problem_id=6509","statistics":"https://loj.ac/problem/6509/statistics/fastest","testdata":"https://loj.ac/problem/6509/testdata","discussion":"https://loj.ac/discussion/problem/6509"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"给定一棵 $n$ 个点的树，树上每个点初始有一个 $0$ 或 $1$ 的数字。\r\n\r\n考虑这样一个过程：\r\n\r\n1. 等概率随机选择一个点作为起点\r\n2. 等概率随机选择一个新点并沿着树上的路径移动过去，最后反转这个新点上的数字（注意只反转这个新点上的数字而非经过的所有点的数字）\r\n3. 如果此时整棵树上的所有数字相同，则过程结束；否则回到步骤 $2$\r\n\r\n求出期望的移动距离，对 $10^9 + 7$ 取模。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行一个整数 $n$。\r\n\r\n第二行一个长度为 $n$ 的 $01$ 串，表示每个点的初始数字。\r\n\r\n接下来 $n - 1$ 行，其中第 $i$ 行一个整数 $f$ 表示一条连接 $i + 1$ 和 $f$ 的边。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"一行一个整数表示答案。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n2\r\n01\r\n1\r\n```\r\n\r\n#### 样例输出 1\r\n```plain\r\n500000004\r\n```\r\n\r\n#### 样例解释 1\r\n\r\n- 初始点为 $1$，选择的新点为 $1$，过程结束，距离为 $0$\r\n- 初始点为 $1$，选择的新点为 $2$，过程结束，距离为 $1$\r\n- 初始点为 $2$，选择的新点为 $2$，过程结束，距离为 $0$\r\n- 初始点为 $2$，选择的新点为 $1$，过程结束，距离为 $1$\r\n\r\n答案为 $\\frac{1}{2}$，对 $10 ^ 9 + 7$ 取模等于 $500000004$。\r\n\r\n#### 样例输入 2\r\n```plain\r\n3\r\n001\r\n1\r\n1\r\n```\r\n\r\n#### 样例输出 2\r\n```plain\r\n638888896\r\n```\r\n\r\n#### 样例解释 2\r\n\r\n一种可能的方案如下：\r\n\r\n1. 从 $2$ 号点出发，选择了 $2$ 号点自己，这一步的移动步数为 $0$， $2$ 号点数字变为 $1$\r\n2. 选择 $3$ 号点，这一步的移动步数为 $2$， $3$ 号点数字变为 $0$\r\n3. 选择 $2$ 号点，这一步的移动步数为 $2$， $2$ 号点数字变为 $0$\r\n4. 此时所有点均变为 $0$，过程结束，总移动步数为 $4$\r\n\r\n最终答案为 $\\frac{95}{36}$，对 $10^9 + 7$ 取模等于 $638888896$。"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于全部数据， $3 \\leq n \\leq 100000$，保证初始局面不满足终止条件。\r\n\r\n- 存在 $10 \\%$的数据， $n \\leq 5$。\r\n- 存在 $30 \\%$的数据， $n \\leq 20$。\r\n- 存在 $50 \\%$的数据， $n \\leq 100$。\r\n- 存在 $70 \\%$的数据， $n \\leq 1000$。"}]}