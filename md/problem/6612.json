{"title":"「THUPC 2019」不用找的树 / tree","time_limit":6000,"memory_limit":512,"tags":["THUPC","2019","分块及按大小分类","数据结构"],"operation":{"submit":"https://loj.ac/problem/6612#submit_code","submissions":"https://loj.ac/submissions?problem_id=6612","statistics":"https://loj.ac/problem/6612/statistics/fastest","testdata":"https://loj.ac/problem/6612/testdata","discussion":"https://loj.ac/discussion/problem/6612"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"给出一棵 $n$ 个节点的树，结点标号从 $1$ 到 $n$。\r\n\r\n定义树上两点 $a,b$ 间的距离 $d\\left( a,b\\right)$ 是最小的非负整数 $k$，满足存在结点序列 $v_0,v_1,\\dots ,v_k$，满足 $v_0=a$，$v_k=b$，且对于 $0\\leq i\\leq k-1$ 有 $v_i$ 和 $v_{i+1}$ 之间在树上有一条边相连。\r\n\r\n有 $m$ 个询问，每个询问包含参数 $p_0,d_0,p_1,d_1$，求：\r\n\r\n$$\\sum\\limits_{d\\left(p_0,a\\right)\\leq d_0} {\\sum\\limits_{d\\left(p_1,b\\right)\\leq d_1} {d(a,b)}}$$\r\n"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行一个整数 $n$，表示树的节点数目。\r\n\r\n接下来一行 $n-1$ 个整数 $f_2 ,f_3 ,\\dots, f_n$，依次表示 $i$ 和 $f_i$（$1\\leq f_i\\leq i-1$）之间有一条边。\r\n\r\n接下来一行一个整数 $m$，表示询问数目。\r\n\r\n接下来 $m$ 行依次描述所有询问：每行四个整数 $p_0,d_0,p_1,d_1$（$1\\leq p_0 ,p_1\\leq n$，$0\\leq d_0 ,d_1\\leq n-1$）描述一组询问。\r\n\r\n保证 $1\\leq n\\leq 10^5$，$1\\leq m\\leq 10^5$。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"共 $m$ 行，依次回答各组询问：每行输出一行一个整数表示这组询问的答案。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"##### 样例输入 1\r\n\r\n```plain\r\n7\r\n1 1 2 3 5 2\r\n5\r\n5 1 5 0\r\n2 0 5 0\r\n2 2 4 5\r\n7 2 2 4\r\n3 2 5 4\r\n```\r\n\r\n##### 样例输出 1\r\n\r\n```plain\r\n2\r\n3\r\n69\r\n57\r\n70\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2019。\r\n\r\n题解等资源可在 https://github.com/wangyurzee7/THUPC2019 查看。"}]}