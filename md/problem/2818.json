{"title":"「eJOI2018」循环排序","time_limit":1000,"memory_limit":512,"tags":["2018","eJOI"],"operation":{"submit":"https://loj.ac/problem/2818#submit_code","submissions":"https://loj.ac/submissions?problem_id=2818","statistics":"https://loj.ac/problem/2818/statistics/fastest","testdata":"https://loj.ac/problem/2818/testdata","discussion":"https://loj.ac/discussion/problem/2818"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"**本题译自 [eJOI2018](http://ejoi2018.org/) Problem F.** ***Cycle Sort***\r\n\r\n给定一个长为 $n$ 的数列 $\\{a_i\\}$ ，你可以多次进行如下操作：  \r\n选定 $k$ 个不同的下标 $i_1, i_2, \\cdots, i_k$（其中 $1 \\le i_j \\le n$），然后将 $a_{i_1}$ 移动到下标 $i_2$ 处，将 $a_{i_2}$ 移动到下标 $i_3$ 处，……，将 $a_{i_{k-1}}$ 移动到下标 $i_{k}$ 处，将 $a_{i_k}$ 移动到下标 $i_1$ 处。\r\n  \r\n换言之，你可以按照如下的顺序轮换元素：$i_1 \\rightarrow i_2 \\rightarrow i_3 \\rightarrow \\cdots \\rightarrow i_{k-1} \\rightarrow i_k \\rightarrow i_1$。\r\n\r\n例如：$n=4, \\{a_i\\}=\\{ 10, 20, 30, 40\\}, i_1=2, i_2=3, i_3=4$ ，则操作完成后的 $a$ 数列变为 $\\{ 10, 40, 20, 30\\}$。\r\n\r\n你的任务是用操作次数最少的方法将整个数列排序成不降的。注意，**所有操作中选定下标的个数总和不得超过** $s$ 。如果不存在这样的方法（无解），输出 $\\texttt{-1}$。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行， $2$ 个整数， $n$ 和 $s\\ (1 \\le n \\le 2 \\times 10^5, 0 \\le s \\le 2 \\times 10^5)$ 。  \r\n第二行， $n$ 个整数 $a_1, a_2, a_3, \\cdots a_n$，表示数列 $\\{a_i\\}$ ，其中 $1 \\le a_i \\le 10^9$ 。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"如果无解，仅输出 $\\texttt{-1}$ 。  \r\n否则，第一行输出一个整数 $q$ （可以为 $0$ ，参见样例 3 ），表示最少需要进行的操作次数。  \r\n接下来 $2 \\times q$ 行描述每次操作。  \r\n对于每次操作，先输出一个整数 $k$ 表示此操作选定的下标数量，然后在下一行中输出 $k$ 个整数 $i_1, i_2, \\cdots, i_k$。  \r\n在操作次数 $q$ 最少的情况下，你可以输出任意一种可行方案。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n5 5\r\n3 2 3 1 1\r\n```\r\n\r\n#### 样例输出 1\r\n```plain\r\n1\r\n5\r\n1 4 2 3 5\r\n```\r\n\r\n#### 样例解释 1\r\n\r\n你可以用两次操作 $1 \\rightarrow 4 \\rightarrow 1$ 和 $2 \\rightarrow 3 \\rightarrow  5 \\rightarrow  2$ 排序数组，但这样会 WA，因为你的任务是最小化 $q$ ，而最优解的 $q=1$。  \r\n一种可行的方法是 $1 \\rightarrow 4 \\rightarrow 2 \\rightarrow 3 \\rightarrow 5 \\rightarrow 1$，即样例输出。\r\n\r\n#### 样例输入 2\r\n```plain\r\n4 3\r\n2 1 4 3\r\n```\r\n\r\n#### 样例输出 2\r\n```plain\r\n-1\r\n```\r\n\r\n#### 样例解释 2\r\n\r\n所有操作中选定下标的个数总和的最小值为 $4$ （一种可行的方法是 $1 \\rightarrow 2 \\rightarrow 1$ 和 $3 \\rightarrow 4 \\rightarrow 3$），因此无解。\r\n\r\n#### 样例输入 3\r\n```plain\r\n2 0\r\n2 2\r\n```\r\n\r\n#### 样例输出 3\r\n```plain\r\n0\r\n```\r\n\r\n#### 样例解释 3\r\n\r\n数组已经有序，因此不需要进行操作。\r\n\r\n#### 样例输入 4\r\n```plain\r\n6 9\r\n6 5 4 3 2 1\r\n```\r\n\r\n#### 样例输出 4\r\n```plain\r\n2\r\n6\r\n1 6 2 5 3 4\r\n3\r\n3 2 1\r\n```\r\n\r\n#### 样例输入 5\r\n```plain\r\n6 8\r\n6 5 4 3 2 1\r\n```\r\n\r\n#### 样例输出 5\r\n```plain\r\n3\r\n2\r\n3 4\r\n4\r\n1 6 2 5\r\n2\r\n2 1\r\n```\r\n\r\n#### 补充说明\r\n\r\n样例 4 和 5 满足子任务 6 和 7 的限制。"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"#### 数据限制\r\n\r\n|子任务编号|分数|限制|\r\n|:-:|:-:|:-:|\r\n|$1$|$0$|样例|\r\n|$2$|$5$<!---->|$n, s \\le 2$ 且 $1 \\le a_i \\le 2$|\r\n|$3$|$5$|$n \\le 5$|\r\n|$4$|$5$<!---->|$1 \\le a_i \\le 2$|\r\n|$5$|$10$|$\\{a_i\\}$ 中 $1$ 到 $n$ 的所有正整数出现且恰好只出现一次， $s=2 \\times n$|\r\n|$6$|$10$<!---->|$\\{a_i\\}$ 中 $1$ 到 $n$ 的所有正整数出现且恰好只出现一次， $n \\le 1000$|\r\n|$7$|$15$|$\\{a_i\\}$ 中 $1$ 到 $n$ 的所有正整数出现且恰好只出现一次|\r\n|$8$|$15$<!---->|$s=2 \\times n$|\r\n|$9$|$15$|$n \\le 1000$|\r\n|$10$|$20$|无特殊限制|"}]}