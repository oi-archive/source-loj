{"title":"「COCI 2018.10」Teoretičar","time_limit":6000,"memory_limit":256,"tags":["2018","COCI","构造","分治"],"operation":{"submit":"https://loj.ac/problem/3126#submit_code","submissions":"https://loj.ac/submissions?problem_id=3126","statistics":"https://loj.ac/problem/3126/statistics/fastest","testdata":"https://loj.ac/problem/3126/testdata","discussion":"https://loj.ac/discussion/problem/3126"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"**译自 [COCI 2018/2019 Contest #1](https://hsin.hr/coci/archive/2018_2019/) T5「[Teoretičar](https://hsin.hr/coci/archive/2018_2019/contest1_tasks.pdf)」**\r\n\r\n有这样一个二分图上的问题：给你一个二分图，请用尽量少的颜色给边染色，使得每个顶点的出边颜色互不相同。\r\n\r\n你只需要解决这个问题的放宽限制的版本，现在假设对于给定二分图的答案是 $C$，记 $X$ 是大于等于 $C$ 的最小的 $2$ 的整次幂，你只需要给出一个方案，使得颜色数量不多于 $X$。\r\n"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行三个正整数 $L, R, M$，表示二分图左部点数，右部点数以及边数。\r\n\r\n接下来 $M$ 行，每行两个整数 $a_i, b_i(1\\le a_i \\le L, 1\\le b_i \\le R)$，表示左部到右部的一条连边。保证没有重边。\r\n"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"第一行输出一个正整数 $K$，表示你所用的颜色数。\r\n\r\n接下来 $M$ 行每行一个正整数 $c_i(1\\le c_i \\le K)$，表示第 $i$ 条边的颜色。\r\n"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n\r\n```plain\r\n3 3 5\r\n1 1\r\n1 2\r\n2 2\r\n2 3\r\n3 3\r\n```\r\n\r\n#### 样例输出 1\r\n\r\n```plain\r\n2\r\n1\r\n2\r\n1\r\n2\r\n1\r\n```\r\n\r\n#### 样例输入 2\r\n\r\n```plain\r\n2 4 4\r\n1 1\r\n1 2\r\n1 3\r\n2 4\r\n```\r\n\r\n#### 样例输出 2\r\n\r\n```plain\r\n4\r\n1\r\n2\r\n3\r\n4\r\n```\r\n\r\n#### 样例解释 2\r\n\r\n注意此二分图的最优方案是 $3$ 种颜色，因此 $4$ 种颜色也符合条件。"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于 $20\\%$ 的数据，保证 $L, R \\le 100$。\r\n\r\n对于 $40\\%$ 的数据，保证 $L, R \\le 5 \\times 10^3$。\r\n\r\n对于 $100\\%$ 的数据，保证 $1\\le L, R\\le 10^5, 1\\le M \\le 5\\times 10^5$。"}]}