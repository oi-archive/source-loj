{"title":"「USACO 2018 US Open Platinum」Disruption","time_limit":1000,"memory_limit":256,"tags":["2018","USACO Contest","最小生成树","图论"],"operation":{"submit":"https://loj.ac/problem/2871#submit_code","submissions":"https://loj.ac/submissions?problem_id=2871","statistics":"https://loj.ac/problem/2871/statistics/fastest","testdata":"https://loj.ac/problem/2871/testdata","discussion":"https://loj.ac/discussion/problem/2871"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"**题目译自 [USACO 2018 US Open Contest, Platinum](http://usaco.org/index.php?page=open18results) Problem 3. [Disruption](http://usaco.org/index.php?page=viewproblem2&cpid=842)**\r\n\r\nFarmer John 自豪于他所经营的交通发达的农场。这个农场是由 $N$ 块牧场组成的，$N−1$ 条双向道路将它们连接起来，每一条道路的长度都为 $1$ 单位长度。Farmer John 注意到，任意两个牧场都是互相可达的。\r\n\r\n尽管 FJ 的农场现在是连通的，但他担心如果有一条道路被阻断会发生什么。事实上，这会将他的农场分为两个不相交的牧场集合，奶牛们只能在一个集合内移动但不能在集合间移动。于是 FJ 又建造了 $M$ 条额外的双向道路，每一条的长度均为一个至多为 $10^9$ 的正整数。奶牛们仍然可以使用未被阻断的原有道路进行移动。\r\n\r\n如果某条原有的道路被阻断了，农场就会被分为两块不相交的区域，那么 FJ 就会从他的额外修建的道路中选择一条能够使这两块区域连通的，取代原来那条，从而奶牛们又可以从任何一块牧场去往另一块牧场。\r\n\r\n对于农场上每一条原有的道路，帮助 FJ 选出最短的替代用的道路。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"输入的第一行包含 $N$ 和 $M$。\r\n\r\n接下来的 $N−1$ 行，每行用整数 $p$ 和 $q$ 描述了一条原有的道路，其中 $p,q$ 是这条道路连接的两块牧场。\r\n\r\n剩下的 $M$ 行，每行用三个整数 $p,q$ 和 $r$ 描述了一条额外的道路，其中 $r$ 是这条道路的长度。任何两块牧场之间至多只有一条额外的道路。 "},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"对原有的 $N−1$ 条道路的每一条，按照它们在输入中出现的顺序，输出如果这条道路被阻断的话，能够重新连接农场的最短的替代用道路的长度。如果不存在合适的替代用的道路，输出 $-1$。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n```plain\r\n6 3\r\n1 2\r\n1 3\r\n4 1\r\n4 5\r\n6 5\r\n2 3 7\r\n3 6 8\r\n6 4 5\r\n```\r\n#### 样例输出\r\n```plain\r\n7\r\n7\r\n8\r\n5\r\n5\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于全部数据，$2\\le N\\le 5\\times 10^4,1\\le M\\le 5\\times 10^4,1\\le p,q\\le N,p \\neq q$。\r\n\r\nProblem credits: Brian Dean"}]}