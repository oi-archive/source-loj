{"title":"NOIP2017 普及组题目大融合","time_limit":2000,"memory_limit":256,"tags":["原创","单调队列","DP"],"operation":{"submit":"https://loj.ac/problem/6373#submit_code","submissions":"https://loj.ac/submissions?problem_id=6373","statistics":"https://loj.ac/problem/6373/statistics/fastest","testdata":"https://loj.ac/problem/6373/testdata","discussion":"https://loj.ac/discussion/problem/6373"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"牛牛，小 D 和小 R 来到了第 2017 届 OI 游戏比赛。\r\n\r\n游戏规则：三人一组，在棋盘上玩跳房子。这个棋盘是 $n\\times n$ 大小的，每个格子要么是红色，要么是黄色。每个格子都有一个分数值 $f_{i,j}$ （可以为负）。\r\n\r\n牛牛，小 D 和小 R 的机器人（姑且叫 $A,B,C$ 吧）刚开始都在棋盘的左上角。每个机器人的跳跃距离为 $d$。如果花了 $g$ 枚金币，那么每个机器人可以跳跃的距离范围就在 $[\\max(1,d-g),d+g]$ 之间。\r\n\r\n每次机器人可以选择往正下或者往正右跳。每跳到一个格子就会得到这个格子的分数值。如果跳之前和跳之后的格子同色，那么会额外获得 $1$ 分。每个机器人的游戏可以在任意时候结束。各个机器人的游戏互不干扰。\r\n\r\n最终成绩 $S=A\\times 20\\%+B\\times 30\\%+C\\times 50\\%$。如果你得到了 $S$ 分，你将会获得 $\\lfloor S\\rfloor$ RMB。\r\n\r\n牛牛，小 D 和小 R 理所当然的在一组参加比赛。小 D 是一名图书管理员，他有数不完的金币。现在小 D 的图书馆没多少书，但有很多读者前来借书。他们如果借不到书会不满意，你必须要~~贿赂~~用 RMB 说服他们，所以小 D 要让 $S$ 很大，大到可以说服所有不满意的读者，否则图书馆的口碑变差了，没人来看书就完了。\r\n\r\n现在图书馆里已经有 $m$ 本书，每本书都有一个编码 $c_i$。还有 $q$ 个读者，想要看编码以 $b_i$ 结尾的书，不满意的话需要 $w_i$ 元说服。现在牛牛，小 D 和小 R 想问你，要想满足所有读者，至少要在比赛中花多少金币？（也就是求 $g$ 的最小值）"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行四个整数 $n,m,q,d$，分别表示棋盘的大小，图书馆里原有的书数量，图书馆里的读者数量，以及一开始机器人的跳跃距离。  \r\n接下来 $m$ 行，每行一个数 $c_i$ 表示第 $i$ 本书的编码。  \r\n接下来 $q$ 行，每行三个数 $l_i,b_i$ 和 $w_i$，分别表示 TA 需要的需求码长度，TA 的需求码和说服 TA 需要的 RMB。保证 $b_i$ 没有前导 0 。  \r\n接下来 $n$ 行，每行 $n$ 个数，第 $i$ 行第 $j$ 列的数 $x_{i,j}$ 表示在棋盘第 $i$ 行第 $j$ 列的格子的颜色，$1$ 表示红色，$2$ 表示黄色。  \r\n接下来 $n$ 行，每行 $n$ 个数，第 $i$ 行第 $j$ 列的数 $f_{i,j}$ 表示在棋盘第 $i$ 行第 $j$ 列的格子的分数值。保证棋盘的左上角， $f_{1,1}=0$。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"一行， $g$ 的最小值，也就是需要花的金币的最小值。如果无论如何都无法满足所有读者，输出 $-1$。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 输入样例 1\r\n```plain\r\n5 5 7 2\r\n1\r\n12\r\n123\r\n1234\r\n12345\r\n1 2 1000\r\n2 12 2000\r\n2 13 15\r\n3 123 1234\r\n3 124 5\r\n4 1234 3214\r\n4 1235 10\r\n1 2 1 2 2\r\n1 1 2 1 1\r\n2 1 2 2 2\r\n1 1 1 1 1\r\n1 2 2 1 2\r\n0 3 5 1 2\r\n1 4 5 2 4\r\n6 7 3 2 6\r\n1 2 8 9 4\r\n3 1 5 2 6\r\n```\r\n#### 输出样例 1\r\n```plain\r\n1\r\n```\r\n#### 样例解释 1\r\n\r\n首先要让所有读者满意至少需要 $30$ RMB。\r\n\r\n花了 $1$ 金币后，下面是一种可行方案：（虽然不止一种）\r\n\r\nA 机器人： $0-1-1-8-9-4-6$ 得分 $34$\r\n\r\nB 机器人：$0-1-4-2-4-6-4-6$ 得分 $32$\r\n\r\n(第 4 个数 2 在第 3 个数 4 右边第 2 个，不是下面的）\r\n\r\nC 机器人：$0-3-5-2-4-6-4-6$ 得分 $30$\r\n\r\n$S=\\lfloor34 \\cdot 20\\%+32 \\cdot 30\\%+30 \\cdot 50\\%\\rfloor=\\lfloor6.8+9.6+15\\rfloor=\\lfloor31.4\\rfloor=31\\geq 30$ ，所以花 $1$ 金币就够了。\r\n\r\n而不花金币是走不出来的，所以输出 $1$。\r\n\r\n#### 输入样例 2\r\n```plain\r\n5 5 7 5\r\n1\r\n12\r\n123\r\n1234\r\n12345\r\n1 1 1000\r\n2 12 2000\r\n2 13 15\r\n3 123 1234\r\n3 124 5\r\n4 1234 3214\r\n4 1235 10\r\n1 2 1 2 2\r\n1 1 2 1 1\r\n2 1 2 2 2\r\n1 1 1 1 1\r\n1 2 2 1 2\r\n0 -3 5 1 2\r\n1 4 5 2 4\r\n6 -7 3 2 -6\r\n1 2 -8 -9 4\r\n-3 1 -5 2 -6\r\n```\r\n#### 输出样例 2\r\n```plain\r\n-1\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"**不一定要走到右下角再结束！随时可以结束！并且三个机器人的路线可以相同！**\r\n\r\n对于测试点 $1,2,3$，$1\\leq n\\leq 10^1$。\r\n\r\n对于测试点 $4,5,6$，$1\\leq n\\leq 10^2$。\r\n\r\n对于测试点 $7,8,9,10$，$1\\leq n\\leq 10^3$。\r\n\r\n对于测试点 $1,3,9$，保证所有格子同色。\r\n\r\n对于测试点 $1,2,4$，$1\\leq m,q\\leq 10^1$。\r\n\r\n对于测试点 $5,7,8$，$1\\leq m,q\\leq 10^2$。\r\n\r\n对于测试点 $3,6,9,10$，$1\\leq m,q\\leq 10^3$。\r\n\r\n对于所有测试点，$1\\leq c_i,b_i\\leq 10^9-1,1\\leq l_i\\leq 9,1\\leq w_i\\leq 10^9,0\\leq |f_{i,j}|\\leq 10^9,1\\leq x_{i,j}\\leq 2,1\\leq d\\leq n$。"}]}