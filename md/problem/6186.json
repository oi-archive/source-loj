{"title":"Attack","time_limit":1000,"memory_limit":256,"tags":["线段树","笛卡尔树 / Kruskal 重构树","数据结构"],"operation":{"submit":"https://loj.ac/problem/6186#submit_code","submissions":"https://loj.ac/submissions?problem_id=6186","statistics":"https://loj.ac/problem/6186/statistics/fastest","testdata":"https://loj.ac/problem/6186/testdata","discussion":"https://loj.ac/discussion/problem/6186"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"『新的风暴已经出现，怎么能够停滞不前』—— 你决定去攻击小怪兽的巢穴。\r\n\r\n怪兽有一行 $n$ 个巢穴，从 $1$ 到 $n$ 编号，第 $i$ 个巢穴的防御力为 $R_i$。\r\n\r\n一开始你在降生在第 $x$ 个巢穴（此时巢穴 $x$ 已被破坏），攻击力为 $R_x$。\r\n\r\n每次你有三种操作：\r\n\r\n1. 攻击你左边的第一个没有被摧毁的巢穴，要求你的攻击力要大于等于它的防御力。\r\n\r\n2. 攻击你右边的第一个没有被摧毁的巢穴，要求你的攻击力要大于等于它的防御力。\r\n\r\n3. 增加你的攻击力，这会占用你 $k$ 次操作，你的攻击力会变成两边第一个没有被摧毁的巢穴防御力的较小值（不存在算作 $\\infty$）。\r\n\r\n令 $E_x$ 等于你出生在 $x$ 的时候，捣毁所有巢穴需要的最少次数。\r\n\r\n现在有 $q$ 个操作，每次为以下两种之一：\r\n\r\n1. 交换巢穴 $x$ 和 $x + 1$。\r\n\r\n2. 给出两个数字 $x$ 和 $y$，求 $\\sum_{i=x}^y E_i$ 的值。\r\n"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行两个整数 $n$ 和 $k$。\r\n\r\n第二行 $n$ 个整数，表示 $R_i$。\r\n\r\n之后若干行（$q$ 行，直至文件末尾），开始一个数 $\\mathrm{op}$ 表示操作类型。\r\n\r\n* 如果 $\\mathrm{op} = 1$，接下来一个数 $x$。\r\n* 否则 $\\mathrm{op} = 2$，接下来两个数字 $x$ 和 $y$。参数含义均与题目描述中相同。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"对于每个 $\\mathrm{op} = 2$ 的操作输出一行，包含一个整数表示答案。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n```plain\r\n5 3\r\n2 3 1 4 1\r\n2 2 2\r\n2 1 5\r\n1 2\r\n2 2 2\r\n2 1 5\r\n```\r\n\r\n#### 样例输出\r\n```plain\r\n7\r\n38\r\n13\r\n41\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"$20\\%$ 的分数满足 $n \\leq 1000, q \\leq 2000$。\r\n\r\n另外 $20\\%$ 的分数满足没有操作 $1$。\r\n\r\n另外 $30\\%$ 的分数满足 $R_i$ 两两不同。\r\n\r\n$100\\%$ 的分数满足 $n \\leq 10^5, k \\leq 10^6, R_i \\leq 10^9, q \\leq 2 \\times 10^5, x < n$。\r\n"}]}