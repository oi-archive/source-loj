{"title":"LibreOJ","time_limit":1000,"memory_limit":512,"tags":["数位 DP","DP"],"operation":{"submit":"https://loj.ac/problem/6697#submit_code","submissions":"https://loj.ac/submissions?problem_id=6697","statistics":"https://loj.ac/problem/6697/statistics/fastest","testdata":"https://loj.ac/problem/6697/testdata","discussion":"https://loj.ac/discussion/problem/6697"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"**Source: [Codeforces Goodbye 2017 G. New Year and Original Order](https://codeforces.com/problemset/problem/908/G)**\r\n\r\nLibreOJ 又锅了。\r\n\r\n在锅了的 LibreOJ 中，一道题目的总得分通过如下方式计算：\r\n\r\n1. 取出此题的所有提交记录，得到序列 **A**。\r\n\r\n2. 对于 **A** 的每个元素，假设其得分为 $x$，对总得分的贡献为 $xf(x)$。\r\n\r\n其中 $f(x)=\\texttt{atoi(sort(itoa(x, b)), b)}$。\r\n\r\n`itoa(x, b)` 表示将正整数 $x$ 以 $b$ 进制形式转换得到的字符串。\r\n\r\n`sort(s)` 表示将字符串 $s$ 中的字符按照升序排序得到的字符串。\r\n\r\n`atoi(s, b)` 表示将字符串 $s$ 以 $b$ 进制形式转换得到的正整数。\r\n\r\n例如：  \r\n　`itoa(184, 3) = \"20211\"`  \r\n　`sort(\"20211\") = \"01122\"`  \r\n　`atoi(\"01122\", 3) = 44`  \r\n则当 $b=3$ 时 $f(184)=44$。\r\n\r\nLibreOJ 的第 `-1` 题有着 $n$ 个提交记录，第 $i$ 个提交记录的得分为 $i$，请你求出第 `-1` 题的总得分。\r\n\r\n形式化地说，你需要求出 $\\displaystyle\\sum_{i=1}^{n}if(i)$。\r\n\r\n为了方便输出，你只需要求出答案对 $998,244,353$ 取模的结果即可。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"**本题输入文件包含多组数据。**\r\n\r\n第一行一个正整数 $T$，表示数据组数。\r\n\r\n第二行一个正整数 $b$，意义见题目描述。\r\n\r\n接下来每行表示一组数据。\r\n\r\n每组数据一行一个**以 $b$ 进制形式表示**的正整数 $n$，意义见题目描述。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"对于每组数据，输出一行一个整数表示答案。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n\r\n```plain\r\n3\r\n10\r\n5\r\n10\r\n100\r\n```\r\n\r\n#### 样例输出 1\r\n\r\n```plain\r\n55\r\n295\r\n221530\r\n```\r\n\r\n#### 样例解释 1\r\n\r\n对于前两组数据，除了 $f(10)=1$ 之外，其它运算需要的 $f(x)=x$。\r\n\r\n所以 $n=5$ 时答案为 $1^2+2^2+3^2+4^2+5^2=55$。\r\n\r\n而 $n=10$ 时答案为 $1^2+2^2+\\cdots+9^2+10=295$。\r\n\r\n#### 样例输入 2\r\n\r\n```plain\r\n2\r\n2\r\n111\r\n1001010010100101010001100101101111010110001110\r\n```\r\n\r\n#### 样例输出 2\r\n\r\n```plain\r\n98\r\n588970119\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"定义 $\\mathrm{Len}=T+\\sum\\lfloor\\log_b(n)\\rfloor$。\r\n\r\n对于所有测试点：$T\\le 20$，$2\\le b\\le 10$，$n\\le 10^{1000}$，$\\mathrm{Len}\\le 1000$。\r\n\r\n每个测试点的具体限制见下表：\r\n\r\n| 测试点编号 | $n\\le$ | $\\mathrm{Len}\\le$ | $T=$ | $b=2$ |\r\n| :--: | :--: | :--: | :--: | :--: |\r\n| $1\\sim2$ | $10^5$ | $5$ | $1$ | 不保证 |\r\n| $3\\sim4$ | $10^5$ | $340$ | $20$ | 不保证 |\r\n| $5\\sim8$ | $10^{1000}$ | $1000$ | $1$ | 不保证 |\r\n| $9\\sim10$ | $10^{1000}$ | $1000$ | $1$ | 保证 |\r\n| $11\\sim14$ | $10^{1000}$ | $1000$ | $10$ | 保证 |\r\n| $15\\sim20$ | $10^{1000}$ | $1000$ | $10$ | 不保证 |\r\n\r\n\r\n----\r\n\r\n**Author: PinkRabbit**"}]}