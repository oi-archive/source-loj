{"title":"「JOISC 2018 Day 3」比太郎的聚会","time_limit":2000,"memory_limit":512,"tags":["2018","JOISC","图论","DP"],"operation":{"submit":"https://loj.ac/problem/2838#submit_code","submissions":"https://loj.ac/submissions?problem_id=2838","statistics":"https://loj.ac/problem/2838/statistics/fastest","testdata":"https://loj.ac/problem/2838/testdata","discussion":"https://loj.ac/discussion/problem/2838"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"**译自 [JOISC 2018](https://www.ioi-jp.org/camp/2018/2018-sp-tasks/index.html) Day3 T2「[ビ太郎のパーティー](https://www.ioi-jp.org/camp/2018/2018-sp-tasks/day3/bitaro.pdf) / [Bitaro’s Party](https://www.ioi-jp.org/camp/2018/2018-sp-tasks/day3/bitaro-en.pdf)」**\r\n\r\n<img src=\"https://i.loli.net/2018/12/04/5c06741a3ad29.png\" width=\"18%\">\r\n\r\n河狸们有 $N$ 个城镇，这些城镇按照海拔从高到低依次编号为 $1\\ldots N$（保证海拔互不相同）。有 $M$ 条运河，$i$ 号运河从城镇 $S_i$ 流向 $E_i$。河狸们不能沿着运河逆流而上，即：河狸不能从城镇 $E_i$ 通过 $i$ 号运河前往城镇 $S_i$。\r\n\r\n河狸比太郎有在每个城镇各有一位朋友。比太郎打算举办 $Q$ 场聚会。第 $j$ 场聚会在城镇 $T_j$ 进行，已知有 $Y_j$ 名河狸因事无法参加。在剩下的河狸中，除非他无法从他所在的城镇到达 $T_j$，否则他一定会来。\r\n\r\n因为河狸们十分喜欢运河，所以他们会沿经过运河数目最多的一条路径参加聚会，比太郎想知道每次聚会经过运河数目最多的河狸会经过多少条运河。\r\n\r\n#### 任务\r\n给定 $Q$ 场聚会举行的城镇编号和因事无法参加的河狸列表，写一个程序求出参加每次聚会经过运河数目最多的河狸会经过多少条运河。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"从标准输入中读入如下内容：\r\n- 输入的第一行包含三个用空格隔开的整数 $N,M,Q$，表示有 $N$ 个河狸城镇，$M$ 条运河，要举行 $Q$ 场聚会；\r\n- 接下来 $M$ 行，第 $i$ 行有两个用空格隔开的整数 $S_i,E_i$，表示运河单向地从 $S_i$ 流向 $E_i$；\r\n- 接下来 $Q$ 行，第 $j$ 行包含一些整数，前两个用空格分开的整数 $T_j,Y_j$，后面有 $Y_j$ 个用空格隔开的整数 $C_{j,1},C_{j,2},\\cdots ,C_{j,Y_j}$，表示第 $j$ 场聚会在 $T_j$ 镇举行，住在 $C_{j,1},C_{j,2},\\cdots ,C_{j,Y_j}$ 的河狸因事不能来参加聚会。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出 $Q$ 行，第 $j$ 行包含一个整数，表示参加每次聚会经过运河数目最多的河狸会经过多少条运河。如果没有河狸能参加这场聚会，输出 $-1$。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n5 6 3\r\n1 2\r\n2 4\r\n3 4\r\n1 3\r\n3 5\r\n4 5\r\n4 1 1\r\n5 2 2 3\r\n2 3 1 4 5\r\n```\r\n#### 样例输出 1\r\n```plain\r\n1\r\n3\r\n0\r\n```\r\n#### 样例说明 1\r\n在参加第 $1$ 场聚会的朋友中（住在 $2,3,4$ 号城镇的河狸），在 $2$ 或 $3$ 号城镇的河狸会沿运河前往 $4$ 号城镇，他们都将经过 $1$ 条运河，所以输出 $1$。  \r\n在参加第 $2$ 场聚会的朋友中（住在 $1,4,5$ 号城镇的河狸），在 $1$ 号城镇的河狸会沿运河前往 $5$ 号城镇，将经过 $3$ 条运河，所以输出 $3$。  \r\n在参加第 $3$ 场聚会的朋友中（住在 $2$ 号城镇的河狸），他没有经过运河到达 $2$ 号城镇，因此输出 $0$。\r\n\r\n#### 样例输入 2\r\n```plain\r\n12 17 10\r\n1 2\r\n2 3\r\n3 4\r\n1 5\r\n2 6\r\n3 7\r\n4 8\r\n5 6\r\n6 7\r\n7 8\r\n5 9\r\n6 10\r\n7 11\r\n8 12\r\n9 10\r\n10 11\r\n11 12\r\n6 3 1 7 12\r\n3 7 1 2 3 4 5 6 7\r\n11 3 1 3 5\r\n9 2 1 9\r\n8 4 1 2 3 4\r\n1 1 1\r\n12 0\r\n10 3 1 6 10\r\n11 8 2 3 5 6 7 9 10 11\r\n8 7 2 3 4 5 6 7 8\r\n```\r\n#### 样例输出 2\r\n```plain\r\n1\r\n-1\r\n3\r\n1\r\n3\r\n-1\r\n5\r\n2\r\n4\r\n4\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于全部数据，满足以下条件：\r\n- $1\\le N\\le 10^5$\r\n- $0\\le M\\le 2\\times 10^5$\r\n- $1\\le Q\\le 10^5$\r\n- $1\\le S_i\\lt E_i\\le N\\ (1\\le i\\le N)$\r\n- $(S_i,E_i)\\neq (S_j,E_j)\\ (1\\le j\\le M)$\r\n- $1\\le T_j\\le N\\ (1\\le j\\le Q)$\r\n- $0\\le Y_j\\le N\\ (1\\le j\\le Q)$\r\n- $1\\le C_{j,1}\\lt C_{j,2}\\lt \\cdots \\lt C_{j,Y_j}\\le N\\ (1\\le j\\le Q)$\r\n- $Y_1+Y_2+\\cdots Y_Q\\le 10^5$\r\n\r\n本题包含三个子任务，具体子任务限制如下：\r\n\r\n| Subtask |             附加限制              | 分数 |\r\n| :-----: | :-------------------------------: | :--: |\r\n|   $1$   | $N\\le 10^3,M\\le 2\\times 10^3,Q=1$ | $7$  |\r\n|   $2$   |               $Q=1$               | $7$  |\r\n|   $3$   |            无附加限制             | $86$ |\r\n\r\n"}]}