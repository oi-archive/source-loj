{"title":"「ZJOI2016」线段树","time_limit":1000,"memory_limit":256,"tags":["2016","ZJOI","前缀和","DP"],"operation":{"submit":"https://loj.ac/problem/2093#submit_code","submissions":"https://loj.ac/submissions?problem_id=2093","statistics":"https://loj.ac/problem/2093/statistics/fastest","testdata":"https://loj.ac/problem/2093/testdata","discussion":"https://loj.ac/discussion/problem/2093"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"小 Yuuka 遇到了一个题目：有一个序列 $a_1, a_2, \\ldots , a_n$，对其进行$q$次操作，每次把一个区间内的数改成区间内的最大值，问最后每个数是多少。\r\n\r\n小 Yuuka 很快地就使用了线段树解决了这个问题。于是充满智慧的小 Yuuka 想，如果操作是随机的，即在这 $q$ 次操作中每次等概率随机地选择一个区间 $[l,r]$ $(1 \\leq l \\leq r \\leq n)$，然后将这个区间内的数改成区间内最大值（注意这样的区间共有 $\\frac{n(n+1)}{2}$ 个），最后每个数的期望大小是多少呢？小 Yuuka 非常热爱随机，所以她给出的输入序列也是随机的（随机方式见数据规模和约定）。对于每个数，输出它的期望乘 $(\\frac{n(n+1)}{2})^q$ 再对 $10^9+7$ 取模的值。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行包含两个正整数 $n,q$，表示序列里数的个数和操作的个数。\r\n\r\n接下来一行，包含 $n$ 个非负整数 $a_1, a_2, \\ldots, a_n$。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出共一行，包含 $n$ 个整数，表示每个数的答案"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n```plain\r\n5 5\r\n1 5 2 3 4\r\n```\r\n\r\n#### 样例输出\r\n```plain\r\n3152671 3796875 3692207 3623487 3515626\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于所有的测试数据，保证序列中数的大小不超过 $10^9$，即 $a_i≤10^9$，并且每个数是 $0$ 到 $10^9$ 之间的随机整数。$n \\leq 400, \\ q \\leq 400$。"}]}