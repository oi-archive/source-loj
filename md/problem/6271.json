{"title":"「长乐集训 2017 Day10」生成树求和 加强版","time_limit":2000,"memory_limit":512,"tags":["DFT（含 NTT）及FFT","高斯消元","组合计数","矩阵树定理","数学","图论"],"operation":{"submit":"https://loj.ac/problem/6271#submit_code","submissions":"https://loj.ac/submissions?problem_id=6271","statistics":"https://loj.ac/problem/6271/statistics/fastest","testdata":"https://loj.ac/problem/6271/testdata","discussion":"https://loj.ac/discussion/problem/6271"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"给定一张 $ n $ 个点 $ m $ 条边的带权无向图 $ G $，对于 $ G $ 的每一棵生成树，我们定义这棵生成树的权值为：它所包含的所有边的边权按三进制不进位加法相加所得的数。\r\n\r\n现在请你求出图 $ G $ 中所有的生成树的权值和（将生成树的权值由三进制转为十进制，做正常的十进制进位加法）。输出答案对 $ 10 ^ 9 + 7 $ 取模后的值即可。\r\n"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行两个整数 $ n, m $ 表示点数与边数。点从 $ 1 \\sim n $ 编号。\r\n\r\n接下来 $ m $ 行每行三个整数 $ a, b, c $ 表示一条连接 $ (a, b) $ 的边权为 $ c $ 的无向边。\r\n\r\n边权以十进制形式给出。\r\n"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"仅一行一个整数表示答案。\r\n"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n```plain\r\n5 7\r\n3 2 7400\r\n4 1 1618\r\n4 2 9110\r\n4 3 4264\r\n5 1 537\r\n5 2 4240\r\n5 3 655\r\n```\r\n\r\n#### 样例输出\r\n```plain\r\n262221\r\n```\r\n"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"$ 30 \\% $ 的数据（共六个点）：$ n = 5, 6, 7, 8, 9, 10 $  \r\n$ 50 \\% $ 的数据：$ n \\le 30 $  \r\n$ 70 \\% $ 的数据：$ n \\le 40 $  \r\n$ 100 \\% $ 的数据：$ n \\le 100, m \\le \\frac{n(n-1)}{2}, 0 \\leq c \\leq 10 ^ 4 $，保证无重边无自环。\r\n"}]}