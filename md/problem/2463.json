{"title":"「2018 集训队互测 Day 1」完美的旅行","time_limit":3000,"memory_limit":512,"tags":["2018","集训队互测","矩阵","多项式 / 形式幂级数","生成函数","Berlekamp-Massey 算法","数学","图论"],"operation":{"submit":"https://loj.ac/problem/2463#submit_code","submissions":"https://loj.ac/submissions?problem_id=2463","statistics":"https://loj.ac/problem/2463/statistics/fastest","testdata":"https://loj.ac/problem/2463/testdata","discussion":"https://loj.ac/discussion/problem/2463"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"小 A 有一张 $n$ 个点的图，点的标号为 $0$ 到 $n-1$。点 $i$ 到点 $j$ 有 $A_{i,j}$ 条有向边。可能有自环。\r\n\r\n现在小 A 要在图上进行若干次旅行。每次旅行都是选任意一个起点，走至少一步，走到任意一个终点。定义一次旅行的愉悦值为起点与终点编号按位与的值。\r\n\r\n好奇的小 B 想要知道：对于所有 $x \\in [1,m]$ 和 $y \\in [0,n)$，小 A 进行了若干次旅行，总共走了 $x$ 步，且所有旅行的愉悦值的按位与为 $y$ 的方案数。\r\n\r\n两种方案不同当且仅当旅行次数不同或某一次旅行不完全相同。\r\n\r\n为了防止输出过多，你只需要输出这 $n\\times m$ 个数对 $998244353$ 取模后的结果的按位异或值。\r\n\r\n为方便起见，保证 $n$ 是 $2$ 的幂次。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行两个数 $n,m$。\r\n\r\n后面一个 $n\\times n$ 的矩阵，第 $i$ 行第 $j$ 列的数表示点 $i-1$ 到点 $j-1$ 的有向边的数量。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出一个数表示 $n\\times m$ 个答案取模后的异或值。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n\r\n```plain\r\n2 3\r\n1 2\r\n3 4\r\n```\r\n\r\n#### 样例输出\r\n\r\n```plain\r\n1770\r\n```\r\n\r\n#### 样例解释\r\n\r\n走 $1$ 步，愉悦值的按位与 $=0,1$ 的方案数分别为 $6,4$。\r\n\r\n走 $2$ 步的方案数分别为 $116,38$。\r\n\r\n走 $3$ 步的方案数分别为 $2012,358$。\r\n\r\n异或值为 $1770$。"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于所有数据，$2 \\leq n \\leq 64,1 \\leq m \\leq 20000,0 \\leq A_{i,j} < 998244353$，保证 $n$ 是 $2$ 的幂。\r\n\r\n|子任务编号\t|\t分值\t\t|\t$n \\leq$\t|\t$m \\leq$\t|\t\t特殊限制\t\t\t\t\t\t\t\t\t|\r\n|:----------------:|:----------------:|:----------------:|:----------------:|:-------------------------------------------------------------------------:|\r\n|\t$1$\t\t|\t$15$\t|\t$16$\t|\t$2000$\t|\t\t\t\t\t\t\t\t\t\t\t\t|\r\n|\t$2$\t\t|\t$15$\t|\t$32$\t|\t$10000$\t|\t\t\t\t\t\t\t\t\t\t\t\t|\r\n|\t$3$\t\t|\t$35$\t|\t$64$\t|\t$20000$\t|$A_{i,j}=i\\otimes j$，其中 $\\otimes$ 表示按位异或运算\t|\r\n|\t$4$\t\t|\t$35$\t|\t$64$\t|\t$20000$\t|\t\t\t\t\t\t\t\t\t\t\t\t|"}]}