{"title":"「hyOI2019」henry_y 的莫比乌斯函数","time_limit":1500,"memory_limit":512,"tags":["莫比乌斯反演","数论"],"operation":{"submit":"https://loj.ac/problem/6702#submit_code","submissions":"https://loj.ac/submissions?problem_id=6702","statistics":"https://loj.ac/problem/6702/statistics/fastest","testdata":"https://loj.ac/problem/6702/testdata","discussion":"https://loj.ac/discussion/problem/6702"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"Tsukimaru 要给自己的比赛出一道签到题。简单来说，这道题只需要选手使用线性筛筛出 $\\mu(1), \\mu(2), \\ldots, \\mu(m)$，然后暴力求和即可。\r\n\r\n为了防止选手用优于暴力做法的做法碾压正解，导致选手浪费多余的时间，Tsukimaru 给题目增加了一个随机数生成器，以使得除了暴力没有别的做法。\r\n\r\n定义函数 `f(k, seed)`：\r\n\r\n```cpp\r\nunsigned f(unsigned k, unsigned seed) {\r\n    if (k == 0)\r\n        return 1;\r\n\r\n    unsigned t;\r\n    unsigned ans = 0;\r\n\r\n    for (t = 1; t <= n; t++) {\r\n        ans += absmu(seed % m + 1) * ~seed * f(k - 1, (seed >> 16) | (seed << 16));\r\n        seed ^= seed << 16;\r\n        seed ^= seed >> 5;\r\n        seed ^= seed << 1;\r\n    }\r\n\r\n    return ans;\r\n}\r\n```\r\n\r\n其中 $\\text{absmu}(p) = |\\mu(p)|$。该函数满足：\r\n\r\n* 若存在大于 $1$ 的整数 $x$ 使得 $x^2$ 为 $p$ 的因子，则 $\\text{absmu}(p) = 0$；\r\n* 否则 $\\text{absmu}(p) = 1$。\r\n\r\n给出 $n, m, x$，请你求出 `f(6, x)` 的值。\r\n\r\n----\r\nTsukimaru 想出了一个 $O(n^6 \\sqrt m)$ 的优秀解法。Tsukimaru 相信没有更优的做法了，于是，他高兴地、蹦蹦跳跳地去找 @[henry_y](https://loj.ac/user/6189) 验题。\r\n\r\n> Tsukimaru：帮我验一下这道题  \r\n> henry_y：好  \r\n> henry_y：这个可以加强到 $n = 25, m = 10^7$ 吧  \r\n> Tsukimaru：？\r\n\r\nTsukimaru 认为 henry_y 可以直接 A 掉这道题。\r\n\r\nhenry_y 说：「黑的实在逼真 =.=，你起码把时限开到每个测试点 $1500\\ \\text{ms}$ 吧。」\r\n\r\nTsukimaru 觉得 henry_y 说的有道理，于是想让你帮他求 `f(6, x)` 的结果。\r\n"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"只有一行，三个正整数 $n, m, x$。\r\n"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"只有一行，一个非负整数，表示答案。\r\n"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n```plain\r\n4 5 19260817\r\n```\r\n\r\n#### 样例输出\r\n```plain\r\n509600808\r\n```\r\n\r\n#### 样例解释\r\n$\\text{absmu}(1) = 1, \\text{absmu}(2) = 1, \\text{absmu}(3) = 1, \\text{absmu}(4) = 0, \\text{absmu}(5) = 1$。\r\n\r\n根据以上代码模拟即可得出结果。"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于 $30\\%$ 的数据，$1 \\leq n \\leq 15, 1 \\leq m \\leq 1000$。\r\n\r\n另外 $70\\%$ 的数据，$1 \\leq n \\leq 25, 5 \\times 10^6 \\leq m \\leq 10^7$。\r\n\r\n对于 $100\\%$ 的数据，$1 \\leq x \\leq 10^9$。\r\n\r\n欢迎 Hack。如果你发现了可以让标程运行超时的数据，可以在题目讨论提出。\r\n\r\n**提醒：如果你希望提出 Hack 数据，请认真检查输入数据中 $n, m$ 的范围是否合法。如果你输入的 $n > 15$，那么 $m$ 必须不小于 $5 \\times 10^6$。**\r\n\r\n来自 Tsukimaru 的善意提醒：\r\n\r\n* 函数中的所有变量和函数返回值的类型都是 `unsigned`；这意味着函数中的所有计算都会自动对 $2^{32}$ 取模。\r\n* 请注意常数因子给程序运行时间带来的影响。\r\n\r\n#### 题目信息\r\n* Idea / Std / Data: @[cutekibry](https://loj.ac/user/1408)\r\n* Solution: @[djq_cpp](https://loj.ac/user/3560)\r\n* Testing: @[moonoshawott](https://loj.ac/user/10399)"}]}