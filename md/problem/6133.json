{"title":"「2017 山东三轮集训 Day2」Eclipse","time_limit":1000,"memory_limit":233,"tags":[],"operation":{"submit":"https://loj.ac/problem/6133#submit_code","submissions":"https://loj.ac/submissions?problem_id=6133","statistics":"https://loj.ac/problem/6133/statistics/fastest","testdata":"https://loj.ac/problem/6133/testdata","discussion":"https://loj.ac/discussion/problem/6133"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"作为滋滋国最具智慧的人，Lyra 寻找出了日食的规律，世界诞生之日起，第 $ i $ 天有一个特征值 $ S_i $，满足如下方程：\r\n\r\n$$\r\n\\begin{aligned}\r\nS_1 &= A \\\\\r\nS_2 &= B \\\\\r\nS_i &= (XS_{i - 1} + YS_{i - 2} + Z) \\bmod P & i > 3\r\n\\end{aligned}\r\n$$\r\n\r\nLyra 发现，如果有一天满足 $ S_i = C $，则那一天就会发生日食，现在 Lyra 想知道，第 $ L $ 天到第 $ R $ 天中有多少天会发生日食。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行输入一个整数 $ T $ 表示数据组数。  \r\n对于每组数据输入一行八个整数 $ A,B,X,Y, Z,P,C,Q $，$ A,B,X,Y,Z,P,C $ 意义如题意所述，$ Q $ 表示 $ L,R $ 询问的组数。  \r\n接下来 $ Q $ 行，每行两个正整数 $ L,R $，表示一组询问。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"对于每组询问输出一行一个一个整数表示 $ [L, R] $ 区间中有多少i满足 $ S_i = c  $。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n2\r\n1 1 1 1 1 3 1 6\r\n1 2\r\n2 3\r\n3 4\r\n4 5\r\n5 6\r\n6 7\r\n1 2 3 4 5 19 2 4\r\n2 6\r\n23 66\r\n233 666\r\n2333 6666\r\n```\r\n\r\n#### 样例输出 1\r\n```plain\r\n2\r\n1\r\n0\r\n0\r\n0\r\n1\r\n1\r\n4\r\n48\r\n482\r\n```\r\n\r\n#### 样例输入 2\r\n见「附加文件」中的 `ex_eclipse2.in`。\r\n\r\n#### 样例输出 2\r\n见「附加文件」中的 `ex_eclipse2.out`。"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于所有数据，$ T \\leq 2; 1 \\leq Q \\leq 2 \\times 10 ^ 4; 1 \\leq L \\leq R \\leq 10 ^ {18}; 0 \\leq A, B, X, Y, Z, C < P \\leq10, 007 $ 且 $ P $ 是质数。\r\n\r\n**子任务 1**（15 分）$ R \\leq 10 ^ 7 $；  \r\n**子任务 2**（15 分）$ P \\leq 10 ^ 3 $；  \r\n**子任务 3**（25 分）$ Q = 1 $；    \r\n**子任务 4**（45 分）无特殊限制。"}]}