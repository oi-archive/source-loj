{"title":"「POI2012」极简主义的安保 Minimalist Security","time_limit":1000,"memory_limit":256,"tags":["POI","2012"],"operation":{"submit":"https://loj.ac/problem/2702#submit_code","submissions":"https://loj.ac/submissions?problem_id=2702","statistics":"https://loj.ac/problem/2702/statistics/fastest","testdata":"https://loj.ac/problem/2702/testdata","discussion":"https://loj.ac/discussion/problem/2702"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"**译自 POI 2012 Stage 3. Day 2「[Bezpieczeństwo minimalistyczne](https://szkopul.edu.pl/problemset/problem/aSbIC_LB4H-CGMYPEVue5jFw/site/?key=statement)」**\r\n\r\n给定一张无向图，点有点权 $p(v)$，边有边权 $b(u,v)$，初始时保证对每条边有 $p(u) + p(v) \\ge b(u,v)$。\r\n\r\n现在需要减少一部分点的点权，使得对每条边都恰有 $p(u) + p(v) = b(u,v)$.\r\n\r\n求整张图减少的点权和的最小值和最大值。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行两个整数 $n$ 和 $m$（$1 \\le n \\le 500\\ 000,0 \\le m \\le 3\\ 000\\ 000$），表示图的点数和边数。\r\n\r\n接下来一行 $n$ 个非负整数 $p(1),p(2),\\ldots,p(n) (0 \\le p(i) \\le 10^6)$，表示点权。\r\n\r\n接下来 $m$ 行每行三个整数 $u_i, v_i, b(u_i, v_i)$（$1 \\le u_i,v_i \\le n,u_i \\neq v_i,0 \\le b(u_i,v_i) \\le 10^6$），表示边和边权。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"如果存在符合条件的方案，输出一行两个整数，表示整张图减少的点权和的最小值和最大值。\r\n\r\n如果不存在，输出 `NIE`."},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n3 2\r\n5 10 5\r\n1 2 5\r\n2 3 3\r\n```\r\n\r\n#### 样例输出 1\r\n```plain\r\n12 15\r\n```\r\n\r\n#### 样例输入 2\r\n```plain\r\n3 3\r\n1 1 1\r\n1 2 1\r\n1 3 1\r\n3 2 1\r\n```\r\n\r\n#### 样例输出 2\r\n```plain\r\nNIE\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于 $56\\%$ 的数据有 $n \\le 2000,m \\le 8000$.\r\n\r\n对于所有数据有 $1 \\le n \\le 500\\ 000,0 \\le m \\le 3\\ 000\\ 000$."}]}