{"title":"「JOISC 2015 Day2」Building 3","time_limit":1000,"memory_limit":256,"tags":["2015","JOISC","枚举"],"operation":{"submit":"https://loj.ac/problem/2998#submit_code","submissions":"https://loj.ac/submissions?problem_id=2998","statistics":"https://loj.ac/problem/2998/statistics/fastest","testdata":"https://loj.ac/problem/2998/testdata","discussion":"https://loj.ac/discussion/problem/2998"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"**译自 [JOISC 2015](https://www.ioi-jp.org/camp/2015/2015-sp-tasks/index.html) Day2 T1「[Building 3](https://www.ioi-jp.org/camp/2015/2015-sp-tasks/2015-sp-d2.pdf)」。**\r\n\r\n给出一个长度为 $ N - 1 $ 的序列 $ B_1, B_2, \\dots, B_{N-1} $，求出有多少长度为 $ N $ 序列 $ A_1, A_2, \\dots, A_N $ 满足：\r\n\r\n+ $ A_1, A_2, \\dots, A_N $ 删掉其中一个数后和 $ B_1, B_2, \\dots, B_{N-1} $ 一样；\r\n+ 存在一个长度为 $ N $ 的排列 $H_1, H_2, \\dots, H_N $，使得 $ A_i $ 是以 $ H_i $ 为结尾的最长递增子序列的长度。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行包含一个整数 $ N $，表示序列的长度。\r\n\r\n接下来 $ N - 1 $ 行，第 $ j $ ($ 1 \\le j \\le N - 1$) 行包含一个整数 $ B_j $，含义如题所述。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出一个整数，表示满足条件的 $ A_1, A_2, \\dots, A_N $ 的个数。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n4\r\n1\r\n1\r\n2\r\n```\r\n\r\n#### 样例输出 1\r\n```plain\r\n5\r\n```\r\n\r\n#### 样例解释 1\r\n\r\n总共有 $ 5 $ 个满足条件的序列：\r\n\r\n+ $1, 2, 1, 2$：$ H_2 > H_4 > H_1 > H_3 $ 或者 $ H_2 > H_1 > H_4 > H_3 $。\r\n+ $1, 1, 2, 3$：$ H_4 > H_3 > H_1 > H_2 $。\r\n+ $1, 1, 2, 1$：$ H_3 > H_1 > H_2 > H_4 $。\r\n+ $1, 1, 2, 2$：$ H_3 > H_4 > H_1 > H_2 $。\r\n+ $1, 1, 1, 2$：$ H_4 > H_1 > H_2 > H_3 $。\r\n\r\n\r\n#### 样例输入 2\r\n```plain\r\n8\r\n1\r\n1\r\n2\r\n1\r\n2\r\n3\r\n1\r\n```\r\n\r\n#### 样例输出 2\r\n```plain\r\n15\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于全部数据，满足 $ 2 \\le N \\le 10^6, 1 \\le B_j \\le N$。\r\n\r\n本题共有 $ 3 $ 个子任务。每个子任务的分数和附加限制如下：\r\n\r\n| Subtask | 附加限制 | 分数 |\r\n|:-------:|:-------:|:---:|\r\n| 1 | $ N \\le 8 $ | 10 |\r\n| 2 | $ N \\le 300 $ | 30 |\r\n| 3 | 无附加限制 | 60 |\r\n"}]}