{"title":"「2018 集训队互测 Day 2」最小方差生成树","time_limit":5000,"memory_limit":512,"tags":["2018","集训队互测","Link-Cut Tree","最小生成树","数据结构","数学","图论"],"operation":{"submit":"https://loj.ac/problem/2469#submit_code","submissions":"https://loj.ac/submissions?problem_id=2469","statistics":"https://loj.ac/problem/2469/statistics/fastest","testdata":"https://loj.ac/problem/2469/testdata","discussion":"https://loj.ac/discussion/problem/2469"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"给定一个 $n$ 个点 $m$ 条边的带权图，每条边的边权为 $w_i$ ，有两种询问。\r\n\r\n1.求其最小方差生成树。\r\n\r\n2.对于每条边，问如果删除它，残余图（包含 $n$ 个点 $m-1$ 条边）的最小方差生成树。\r\n\r\n你只需要求出最小的方差值。如果图不连通，输出 $-1$。\r\n\r\n一个生成树的方差定义为它的所有边的权值的方差。\r\n\r\n对于 $N$ 个变量 $x_1,x_2...x_N$，其方差计算方式为 $\\sigma^2 = \\frac{\\sum_{1\\leq i\\leq N}(x_i-\\mu)^2}{N}$\r\n\r\n其中 $\\sigma^2$ 为方差，$\\mu$ 为平均值，由于是生成树，所以 $N=n-1$。\r\n\r\n你需要将方差乘 $N^2$ 后输出，可以证明这是一个整数。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第 $1$ 行包含 $3$ 个整数 $n,m,T$，表示点数，边数和询问类型。\r\n\r\n接下来 $m$ 行，每行包含 $3$ 个正整数 $u_i,v_i,w_i$ ，表示第 $i$ 条边连接 $u_i$ 和 $v_i$ ，权值为 $w_i$ ，保证无自环，但可能有重边。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"当 $T=1$，输出一个数表示答案。\r\n\r\n当 $T=2$，输出 $m$ 行，每行一个数表示删除第 $i$ 条边的答案。\r\n\r\n如果图不连通，输出-1。\r\n"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n\r\n```plain\r\n4 4 2\r\n1 2 1\r\n2 3 3\r\n1 3 2\r\n3 4 5\r\n```\r\n\r\n#### 样例输出\r\n\r\n```plain\r\n14\r\n26\r\n24\r\n-1\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"<!-- BEGIN: Migrated markdown table -->\r\n\r\n| 子任务 | 分值 | $T$ | $n \\le$ | $m \\le$ | $C \\le$ |\r\n|:-:|:-:|:-:|:-:|:-:|:-:|\r\n| $1$ | $5$ | $1$ | $m$ | $20$ | $10^6$ |\r\n| $2$ | $10$ | $1$ | $m$ | $200$ | $10^6$ |\r\n| $3$ | $10$ | $1$ | $m$ | $1000$ | $10^4$ |\r\n| $4$ | $10$ | $1$ | $m$ | $1000$ | $10^6$ |\r\n| $5$ | $10$ | $1$ | $m$ | $10^5$ | $10^9$，且满足特性 1 |\r\n| $6$ | $15$ | $1$ | $m$ | $10^5$ | $10^9$ |\r\n| $7$ | $20$ | $2$ | $300$ | $10^5$ | $10^6$ |\r\n| $8$ | $20$ | $2$ | $300$ | $10^5$ | $10^{18}$ |\r\n\r\n<!-- Migrated from original HTML table:\r\n<table class='ui celled table'>\r\n    <thead>\r\n        <tr>\r\n            <th style='text-align: center'> 子任务 </th>\r\n            <th style='text-align: center'> 分值 </th>\r\n            <th style='text-align: center'> $T$ </th>\r\n            <th style='text-align: center'> $n \\le$ </th>\r\n            <th style='text-align: center'> $m \\le$ </th>\r\n            <th style='text-align: center'> $C \\le$ </th>\r\n        </tr>\r\n    </thead>\r\n    <tbody>\r\n        <tr>\r\n            <td style='text-align: center'> $1$ </td>\r\n            <td style='text-align: center'> $5$ </td>\r\n            <td style='text-align: center' rowspan='6'> $1$ </td>\r\n            <td style='text-align: center' rowspan='6'> $m$ </td>\r\n            <td style='text-align: center'> $20$ </td>\r\n            <td style='text-align: center' rowspan='2'> $10^6$ </td>\r\n        </tr>\r\n        <tr>\r\n            <td style='text-align: center'> $2$ </td>\r\n            <td style='text-align: center'> $10$ </td>\r\n            <td style='text-align: center'> $200$ </td>\r\n        </tr>\r\n        <tr>\r\n            <td style='text-align: center'> $3$ </td>\r\n            <td style='text-align: center'> $10$ </td>\r\n            <td style='text-align: center' rowspan='2'> $1000$ </td>\r\n            <td style='text-align: center'> $10^4$ </td>\r\n        </tr>\r\n        <tr>\r\n            <td style='text-align: center'> $4$ </td>\r\n            <td style='text-align: center'> $10$ </td>\r\n            <td style='text-align: center'> $10^6$ </td>\r\n        </tr>\r\n        <tr>\r\n            <td style='text-align: center'> $5$ </td>\r\n            <td style='text-align: center'> $10$ </td>\r\n            <td style='text-align: center' rowspan='2'> $10^5$ </td>\r\n            <td style='text-align: center'> $10^9$，且满足特性 1 </td>\r\n        </tr>\r\n        <tr>\r\n            <td style='text-align: center'> $6$ </td>\r\n            <td style='text-align: center'> $15$ </td>\r\n            <td style='text-align: center'> $10^9$ </td>\r\n        </tr>\r\n        <tr>\r\n            <td style='text-align: center'> $7$ </td>\r\n            <td style='text-align: center'> $20$ </td>\r\n            <td style='text-align: center' rowspan='2'> $2$ </td>\r\n            <td style='text-align: center' rowspan='2'> $300$ </td>\r\n            <td style='text-align: center' rowspan='2'> $10^5$ </td>\r\n            <td style='text-align: center'> $10^6$ </td>\r\n        </tr>\r\n        <tr>\r\n            <td style='text-align: center'> $8$ </td>\r\n            <td style='text-align: center'> $20$ </td>\r\n            <td style='text-align: center'> $10^{18}$ </td>\r\n        </tr>\r\n    </tbody>\r\n</table>\r\n-->\r\n\r\n<!-- END: Migrated markdown table -->\r\n\r\n特性1：第 $i$ 条边连接点 $(i\\bmod n)+1$ 和点 $((i+1)\\bmod n)+1$，且 $w_i\\le w_{i+1}$。"}]}