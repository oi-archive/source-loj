{"title":"「ROI 2019 Day1」运输 20/19","time_limit":1500,"memory_limit":1024,"tags":["ROI","2019"],"operation":{"submit":"https://loj.ac/problem/3189#submit_code","submissions":"https://loj.ac/submissions?problem_id=3189","statistics":"https://loj.ac/problem/3189/statistics/fastest","testdata":"https://loj.ac/problem/3189/testdata","discussion":"https://loj.ac/discussion/problem/3189"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"**译自 [ROI 2019](http://neerc.ifmo.ru/school/archive/2018-2019.html) Day1 T3.** ***[Экспресс 20/19](http://neerc.ifmo.ru/school/archive/2018-2019/ru-olymp-roi-2019-day1.pdf)***\r\n\r\n给一个有 $n$ 个结点 $m$ 条边的 DAG。所有边均从编号小的结点指向编号大的结点。给出每条边的长度。\r\n\r\n给一个常数 $p$。我们估计某条路径的总长度（这条路径上每条边的长度之和）为 $r$，而它的总长度实际上为 $x$，如果 $r⩽x⩽\\frac{p}{p-1}\\cdot r$，则称「估计这条（实长为 $x$ 的）路线的长度为 $r$ 是合理的」。\r\n\r\n有 $q$ 组查询。第 $i$ 组查询包含两个数 $f_i,$ $r_i$。对于每组查询，试求是否存在一条以 $1$ 号结点为起点，以 $f_i$ 为终点的路径，满足：估计这条路线的长度为 $r_i$ 是合理的。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"每个输入文件包含多组数据。  \r\n文件的第一行：数据组数 $t$。  \r\n\r\n每组数据的第一行：$n$, $m$, $q$, $p$。  \r\n接下来 $m$ 行：$v_i$, $w_i$, $d_i$，表示一条边。  \r\n接下来 $q$ 行：$f_i$, $r_i$，表示一个查询。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"对于每组数据输出一行，每行一个长度为 $q$ 的 01 字符串 $s$。若 $s_i=1$，则在本组数据中第 $i$ 个查询是有解的；若 $s_i=0$，则在本组数据中第 $i$ 个查询是无解的。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n2\r\n3 3 5 20\r\n1 2 20\r\n2 3 1\r\n1 3 10\r\n2 19\r\n2 20\r\n3 20\r\n3 21\r\n3 9\r\n7 10 5 5\r\n1 2 15\r\n1 3 10\r\n2 4 21\r\n3 4 30\r\n2 5 14\r\n3 5 31\r\n4 6 3\r\n5 6 14\r\n1 7 39\r\n5 7 13\r\n7 42\r\n7 43\r\n7 44\r\n5 39\r\n6 44\r\n```\r\n\r\n#### 样例输出 1\r\n```plain\r\n11110\r\n10111\r\n```\r\n\r\n#### 样例说明 1\r\n<center><img src=\"https://loj-img.upyun.menci.memset0.cn/2019/09/17/5d80d4ab59e22.png\" width=\"40%\"></center>\r\n\r\n#### 样例输入 2\r\n```plain\r\n1\r\n4 6 5 2\r\n1 2 1\r\n2 3 1\r\n3 4 1\r\n1 2 70\r\n2 3 120\r\n3 4 4\r\n4 90\r\n4 2\r\n4 10\r\n4 37\r\n2 34\r\n```\r\n\r\n#### 样例输出 2\r\n```plain\r\n11010\r\n```\r\n\r\n#### 样例说明 2\r\n<center><img src=\"https://loj-img.upyun.menci.memset0.cn/2019/09/17/5d80da6a1132e.png\" width=\"40%\"></center>\r\n"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"$1 ⩽ t ⩽ 1000,$ $2 ⩽ n ⩽ 500 000,$ $1 ⩽ m ⩽ 500 000,$ $1 ⩽ q ⩽ 500 000,$ $2 ⩽ p ⩽ 20,$ $, 1 ⩽ d_i ⩽ 10^{11},$ $1 ⩽ r_i ⩽ 10^{17}$. 保证 $\\sum n,m,q⩽500000$.\r\n\r\n|子任务 #|分值|$n,m,q$|额外条件|\r\n|:-:|:-:|:-:|:-:|\r\n|1|15|$n,m,q⩽10$||\r\n|2|24|$\\sum n,\\sum m,\\sum q⩽5000$|$r_i⩽5000$|\r\n|3|17|$m=2n-2,q⩽10$|$p=2$，DAG 是一条链|\r\n|4|11|$m=2n-2$|DAG 是一条链|\r\n|5|11$$|$\\sum n⩽1000,\\sum m⩽2000$|所有 $r_i$ 相等|\r\n|6|11||所有 $r_i$ 相等|\r\n|7|11$$|||\r\n"}]}