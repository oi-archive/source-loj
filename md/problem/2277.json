{"title":"「HAOI2017」方案数","time_limit":1000,"memory_limit":256,"tags":["2017","HAOI","容斥原理","组合计数","DP"],"operation":{"submit":"https://loj.ac/problem/2277#submit_code","submissions":"https://loj.ac/submissions?problem_id=2277","statistics":"https://loj.ac/problem/2277/statistics/fastest","testdata":"https://loj.ac/problem/2277/testdata","discussion":"https://loj.ac/discussion/problem/2277"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"考虑定义非负整数间的“$ \\subseteq $”，如果 $ a \\subseteq b $，那么 $ a \\land b = a $，其中 $ \\land $ 表示二进制下的“与”操作。\r\n\r\n考虑现在有一个无限大的空间，现在你在 $ (0, 0, 0) $，有三种位移操作。\r\n\r\n1. $ (x, y, z) \\to (x', y, z) $ 当且仅当 $ x \\subseteq x' $；\r\n2. $ (x, y, z) \\to (x, y', z) $ 当且仅当 $ y \\subseteq y' $；\r\n3. $ (x, y, z) \\to (x, y, z') $ 当且仅当 $ z \\subseteq z' $。\r\n\r\n由于来自东方的神秘力量，有些点被屏蔽了，也就是不能经过了。现在问你到某个点 $ (n, m, r) $ 的方案数，答案对 $ 998244353 $ 取模。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行三个整数 $ n, m, r $。\r\n\r\n接下来一行一个整数 $ o $，表示障碍物的数量。\r\n\r\n接下来 $ o $ 行，每行三个整数 $ x, y, z $ 表示障碍物的坐标，$ 0 \\le x \\le n, 0 \\le y \\le m, 0 \\le z \\le r $，且障碍物不在 $ (0, 0, 0) $ 和 $ (n, m, r) $ 上，障碍物不会重复。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"一行一个整数，代表要求的答案"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n```plain\r\n1 1 1\r\n0\r\n```\r\n#### 样例输出\r\n```plain\r\n6\r\n```\r\n#### 样例解释\r\n有 $ 8 $ 种状态 $ (0, 0, 0), (0, 0, 1), (0, 1, 0), (0, 1, 1), (1, 0, 0), (1, 0, 1), (1, 1, 0), (1, 1, 1) $，分别方案数为 $ 1, 1, 1, 2, 1, 2, 2, 6 $。"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于 $ 20\\% $ 的数据，$ n, m, r \\le 100 $；  \r\n对于 $ 50\\% $ 的数据，$ n, m, r \\le 10^6 $；  \r\n对于另外 $ 20\\% $ 的数据，$ o \\le 10 $；  \r\n对于 $ 100\\% $ 的数据，$ n, m, r \\le 10^{18}, o \\le 10^4 $。"}]}