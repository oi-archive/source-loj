{"title":"「NOI2014」购票","time_limit":3000,"memory_limit":256,"tags":["NOI","2014","标签待整理","数据待检查"],"operation":{"submit":"https://loj.ac/problem/2249#submit_code","submissions":"https://loj.ac/submissions?problem_id=2249","statistics":"https://loj.ac/problem/2249/statistics/fastest","testdata":"https://loj.ac/problem/2249/testdata","discussion":"https://loj.ac/discussion/problem/2249"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"今年夏天，NOI 在 SZ 市迎来了她 30 周岁的生日。来自全国 $n$ 个城市的 OIer 们都会从各地出发，到 SZ 市参加这次盛会。\r\n\r\n全国的城市构成了一棵以 SZ 市为根的有根树，每个城市与它的父亲用道路连接。为了方便起见，我们将全国的 $n$ 个城市用 $1$ 到 $n$ 的整数编号。其中 SZ 市的编号为 $1$。对于除 SZ 市之外的任意一个城市 $v$，我们给出了它在这棵树上的父亲城市 $f_v$ 以及到父亲城市道路的长度 $s_v$。\r\n\r\n从城市 $v$ 前往 SZ 市的方法为：选择城市 $v$ 的一个祖先 $a$，支付购票的费用，乘坐交通工具到达 $a$。再选择城市 $a$ 的一个祖先 $b$，支付费用并到达 $b$。以此类推，直至到达 SZ 市。\r\n\r\n对于任意一个城市 $v$，我们会给出一个交通工具的距离限制 $l_v$。对于城市 $v$ 的祖先 $a$，只有当它们之间所有道路的总长度不超过 $l_v$  时，从城市 $v$ 才可以通过一次购票到达城市 $a$，否则不能通过一次购票到达。对于每个城市 $v$，我们还会给出两个非负整数 $p_v,q_v$  作为票价参数。若城市 $v$ 到城市 $a$ 所有道路的总长度为 $d$，那么从城市 $v$ 到城市 $a$ 购买的票价为 $dp_v+q_v$。\r\n\r\n每个城市的 OIer 都希望自己到达 SZ 市时，用于购票的总资金最少。你的任务就是，告诉每个城市的 OIer 他们所花的最少资金是多少。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行包含两个非负整数 $n,t$，分别表示城市的个数和数据类型（其意义将在后面提到）。  \r\n输入文件的第二到 $n$ 行，每行描述一个除 SZ 之外的城市。其中第 $v$ 行包含五个非负整数 $f_v,s_v,p_v,q_v,l_v$，分别表示城市 $v$ 的父亲城市，它到父亲城市道路的长度，票价的两个参数和距离限制。\r\n\r\n**请注意**：输入不包含编号为 $1$ 的 SZ 市，第二行到第 $n$ 行分别描述的是城市 $2$ 到城市 $n$。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出包含 $n-1$ 行，每行包含一个整数。其中第 $v$ 行表示从城市 $v+1$ 出发，到达 SZ 市最少的购票费用。\r\n\r\n同样**请注意**：输出不包含编号为 $1$ 的 SZ 市。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n```plain\r\n7 3\r\n1 2 20 0 3\r\n1 5 10 100 5\r\n2 4 10 10 10\r\n2 9 1 100 10\r\n3 5 20 100 10\r\n4 4 20 0 10\r\n```\r\n\r\n#### 样例输出\r\n```plain\r\n40\r\n150\r\n70\r\n149\r\n300\r\n150\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于所有数据，$n\\leq 2 \\times 10^5, 0 \\leq p_v \\leq 10^6,\\ 0 \\leq q_v \\leq 10^{12},\\ 1\\leq f_v<v,\\ 0<s_v\\leq lv \\leq 2 \\times 10^{11}$，且任意城市到 SZ 市的总路程长度不超过 $2 \\times 10^{11}$。  \r\n输入的 $t$ 表示数据类型，$0\\leq t<4$，其中：  \r\n当 $t=0$ 或 $2$ 时，对输入的所有城市 $v$，都有 $f_v=v-1$，即所有城市构成一个以 SZ 市为终点的链；  \r\n当 $t=0$ 或 $1$ 时，对输入的所有城市 $v$，都有 $l_v=2 \\times 10^{11}$，即没有移动的距离限制，每个城市都能到达它的所有祖先；  \r\n当 $t=3$ 时，数据没有特殊性质。"}]}