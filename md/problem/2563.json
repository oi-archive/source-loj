{"title":"「SDOI2018」反回文串","time_limit":2000,"memory_limit":512,"tags":["SDOI","2018"],"operation":{"submit":"https://loj.ac/problem/2563#submit_code","submissions":"https://loj.ac/submissions?problem_id=2563","statistics":"https://loj.ac/problem/2563/statistics/fastest","testdata":"https://loj.ac/problem/2563/testdata","discussion":"https://loj.ac/discussion/problem/2563"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"「回文串什么的最讨厌了……」\r\n\r\n小 Q 讨厌任何形式的回文串：\r\n\r\n 1. 如果一个字符串从左往右读和从右往左读是一样的，那么小 Q 讨厌它；例如 ```aa``` 和 ```aba``` 。\r\n\r\n 2. 对于一个字符串来说，若将某个前缀子串移除并拼接到字符串的尾部，能得到一个小 Q 讨厌的字符串，那么小 Q 也会讨厌原来的这个字符串；例如 ```aab``` 和 ```baa``` 。\r\n\r\n现在问题来了，如果任意字符串只可以由 $k$ 种已知的字符组成（也就是说字符集的大小为 $k$），那么长度为 $n$ 的所有字符串里，有多少字符串是小 Q 讨厌的？\r\n\r\n答案可能很大，你只需要给出答案对 $p$ 取模后的值。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行包含一个正整数 $T$，表示有 $T$ 组测试数据。\r\n\r\n接下来 $T$ 行，每行描述一组测试数据，包含三个正整数 $n$, $k$ 和 $p$。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"对于每组测试数据，输出一行，包含一个整数，表示答案对 $p$ 取模的值。\r\n"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n10\r\n1 1 1000000001\r\n2 2 1000000003\r\n3 2 1000000005\r\n3 3 1000000007\r\n4 2 1000000009\r\n4 3 1000000011\r\n4 4 1000000013\r\n5 5 1000000015\r\n7 7 1000000017\r\n9 9 1000000019\r\n```\r\n\r\n#### 样例输出 1\r\n```plain\r\n1\r\n2\r\n8\r\n21\r\n6\r\n15\r\n28\r\n605\r\n16765\r\n530937\r\n```\r\n\r\n#### 样例输入 2\r\n```plain\r\n10\r\n8821612800 758922381 1073365919\r\n8380532160 166822173 1001828119\r\n9311702400 7367823578 1015387267\r\n6983776800 1646145481 1030885259\r\n6692786100 1953515781 1073365919\r\n7138971840 2649942813 1001828119\r\n6469693230 2585876408 1015387267\r\n8031343320 1646145481 1030885259\r\n9995200351 645412247 1030328983\r\n9302162851 1649517328 1053299347\r\n```\r\n\r\n#### 样例输出 2\r\n```plain\r\n896784901\r\n911577797\r\n674524325\r\n392648220\r\n646549222\r\n879297585\r\n384496639\r\n889650008\r\n957785169\r\n413147483\r\n```\r\n"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于 $30\\%$ 的数据，有 $1 \\leq n \\leq 10^{10}$。   \r\n对于 $60\\%$ 的数据，有 $1 \\leq n \\leq 10^{14}$。   \r\n对于 $100\\%$ 的数据，有 $1 \\leq T \\leq 10, 1 \\leq n \\leq 10^{18}, 1 \\leq k \\leq n, 10^9 \\leq p \\leq 2^{30}$。"}]}