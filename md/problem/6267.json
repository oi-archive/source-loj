{"title":"生成随机数","time_limit":2000,"memory_limit":512,"tags":["原创","数学","数论"],"operation":{"submit":"https://loj.ac/problem/6267#submit_code","submissions":"https://loj.ac/submissions?problem_id=6267","statistics":"https://loj.ac/problem/6267/statistics/fastest","testdata":"https://loj.ac/problem/6267/testdata","discussion":"https://loj.ac/discussion/problem/6267"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"「诶，我想生成一个随机数，等概率是 $1$ 或 $2$。」\r\n\r\n「呐，我给你一枚均匀的硬币，你扔一次就好啦。」\r\n\r\n「那如果我想让它等概率是 $1$ 或 $2$ 或 $3$ 呢？」\r\n\r\n「嗯，我想想。这样吧，你先扔两次，如果依次是反反就生成 $1$，反正就生成 $2$，正反就生成 $3$，正正就重新来吧。」\r\n\r\n「诶，这个方案是不是有可能永远不能结束啊？」\r\n\r\n「是的呢，但是期望 $\\frac{8}{3}$ 次就可以结束了，而且这是期望次数最小的方案。」\r\n\r\n「好厉害呀。那如果我还是想让它是 $1$ 或 $2$，但是概率比是 $1$ 比 $2$ 呢？」\r\n\r\n「还是可以用刚才的方案，如果生成了 $3$ 就当成 $2$ 好了。」\r\n\r\n「啊，那在这里还是期望次数最小的方案吗？」\r\n\r\n「应该不是了吧，毕竟浪费了一些信息。」\r\n\r\n「那么应该是什么方案呢？」\r\n\r\n「似乎有点复杂了呢，让我想一想。」\r\n\r\n\r\n\r\n从前有一个随机数生成器，能够生成一个 $[1,n]$ 内的整数，且生成 $i$ 的权重是 $a_i$（即生成 $1\\ldots n$ 的概率比是 $a_1:a_2:\\ldots :a_n$）。现在它已经找不到了，而你想模拟这个生成的过程，但是你手里只有一枚均匀的硬币。你想了很久，设计了一个方案并开始扔硬币。可是你扔了很多很多次硬币，却发现你还是没有模拟成功——或许这个方案实在太慢了，甚至有可能永远不会结束。于是你希望找到一个期望扔硬币次数最少的模拟方案，但是这个方案讲起来可能比较复杂，你想先知道这个最少的期望扔硬币次数。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行，一个正整数 $n$。\r\n\r\n第二行，$n$ 个空格隔开的正整数，其中第 $i$ 个数是 $a_i$。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"我们保证这个答案是一个正有理数，设其等于 $\\frac{P}{Q}$，且 $P$ 和 $Q$ 是互质的正整数。\r\n\r\n我们保证存在非负整数 $R$，使得 $P$ 和 $R\\times Q$ 对 $998244353$ 取余的结果相等，设 $S$ 是最小的 $R$。\r\n\r\n仅一行，一个非负整数 $S$。\r\n"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n2\r\n1 1\r\n```\r\n#### 样例输出 1\r\n```plain\r\n1\r\n```\r\n#### 样例说明 1\r\n$P=1,Q=1$，方案见题目背景。\r\n\r\n#### 样例输入 2\r\n```plain\r\n3\r\n1 1 1\r\n```\r\n#### 样例输出 2\r\n```plain\r\n665496238\r\n```\r\n#### 样例说明 2\r\n$P=8,Q=3$，方案见题目背景。\r\n\r\n#### 样例输入 3\r\n```plain\r\n2\r\n1 3\r\n```\r\n#### 样例输出 3\r\n```plain\r\n499122178\r\n```\r\n#### 样例说明 3\r\n$P=3,Q=2$，方案是如果第一次正面则直接生成 $2$，否则根据第二次来生成 $1$ 或 $2$。\r\n\r\n#### 样例输入 4\r\n```plain\r\n7\r\n1 1 1 1 1 1 1\r\n```\r\n#### 样例输出 4\r\n```plain\r\n570425348\r\n```\r\n#### 样例说明 4\r\n$P=24,Q=7$，方案略。\r\n\r\n#### 样例输入 5\r\n```plain\r\n3\r\n2 3 3\r\n```\r\n#### 样例输出 5\r\n```plain\r\n748683267\r\n```\r\n#### 样例说明 5\r\n$P=9,Q=4$，方案略。\r\n\r\n#### 样例输入 6\r\n```plain\r\n3\r\n1 3 5\r\n```\r\n#### 样例输出 6\r\n```plain\r\n887328316\r\n```\r\n#### 样例说明 6\r\n$P=20,Q=9$，方案略。\r\n\r\n#### 样例输入 7\r\n```plain\r\n3\r\n3 3 4\r\n```\r\n#### 样例输出 7\r\n```plain\r\n798595485\r\n```\r\n#### 样例说明 7\r\n$P=13,Q=5$，方案略。"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"| 测试点编号 |  规模限制   | 特殊限制 |\r\n| :--------: | :---------: | :------: |\r\n|    $1$     |    $n=2$    |    A     |\r\n|   $2,3$    |    $n=2$    |    B     |\r\n|    $4$     |    $n=2$    |    无    |\r\n|    $5$     |    $n=m$    |    A     |\r\n|   $6,7$    |    $n=m$    |    B     |\r\n|    $8$     |    $n=m$    |    无    |\r\n|    $9$     | $m\\le 10^3$ |    A     |\r\n|  $10,11$   | $m\\le 10^3$ |    B     |\r\n|    $12$    | $m\\le 10^3$ |    无    |\r\n|    $13$    | $m\\le 10^5$ |    A     |\r\n|  $14,15$   | $m\\le 10^5$ |    B     |\r\n|    $16$    | $m\\le 10^5$ |    无    |\r\n|    $17$    |     无      |    A     |\r\n|  $18,19$   |     无      |    B     |\r\n|    $20$    |     无      |    无    |\r\n\r\n对于所有数据，$n\\leq 10^6$，$m\\leq 10^7$。其中 $m$ 表示所有 $a_i$ 的和，A 表示 $m$ 是 $2$ 的幂次，B 表示 $m$ 是奇数。\r\n\r\n"}]}