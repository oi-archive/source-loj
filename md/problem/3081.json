{"title":"「2019 集训队互测 Day 5」简单计数","time_limit":7000,"memory_limit":512,"tags":["集训队互测","2019","DFT（含 NTT）及FFT","分块及按大小分类","数学"],"operation":{"submit":"https://loj.ac/problem/3081#submit_code","submissions":"https://loj.ac/submissions?problem_id=3081","statistics":"https://loj.ac/problem/3081/statistics/fastest","testdata":"https://loj.ac/problem/3081/testdata","discussion":"https://loj.ac/discussion/problem/3081"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"<b>C<font color=red>auchySheep</font></b> 近期优化了他的 快速数论变换(NTT) 模板的常数，现在他能在 $\\text{0.1s}$ 内轻松跑过 $n=10^9$ 了，所以他准备用下面的这个简单计数题也考验一下你的常数优化水平。\r\n\r\n传说，在很久很久以前，有一张 $n​$ 个点的带标号<b>有向无环</b>图。每条边有一个颜色，为 $k$ 种不同颜色中的一种。这张图满足如下性质：\r\n\r\n- 每个点有不超过 $1$ 条出边\r\n\r\n- 每个点的入边条数在集合 $S$ 中\r\n\r\n由于某种原因，你想知道这样的图的个数。由于这样的图可能很多，你只要输出答案对 $998244353​$ 取模的值。\r\n\r\n两个图不同当且仅当存在一条从某个点 $a$ 到某个点 $b$ 的有向边，它只在恰好一个图中出现，或在两个图中都出现但颜色不同。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行依次输入三个用空格分隔的正整数，$n$、$k$、$|S|$。\r\n\r\n接下来第二行从小到大输入 $|S|$ 个空格分隔的不同非负整数，表示 $S$ 集合中的元素。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出一行一个 $[0,998244352]$ 的整数，表示符合题意的图的个数对 $998244353​$ 取模的值。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入1\r\n\r\n```\r\n3 1 2\r\n0 1\r\n```\r\n\r\n#### 样例输出1\r\n\r\n```\r\n13\r\n```\r\n\r\n#### 样例解释1\r\n\r\n有如下13个符合题意的图，其中 $a \\rightarrow b$ 表示一条从 $a$ 连向 $b$ 的有向边：\r\n\r\n1. 没有边\r\n2. $1 \\rightarrow 2$\r\n3. $2 \\rightarrow 1$\r\n4. $1 \\rightarrow 3$\r\n5. $3 \\rightarrow 1$\r\n6. $2 \\rightarrow 3$\r\n7. $3 \\rightarrow 2$\r\n8. $1 \\rightarrow 2 \\rightarrow 3$\r\n9. $1 \\rightarrow 3 \\rightarrow 2$\r\n10. $2 \\rightarrow 1 \\rightarrow 3$\r\n11. $2 \\rightarrow 3 \\rightarrow 1$\r\n12. $3 \\rightarrow 1 \\rightarrow 2$\r\n13. $3 \\rightarrow 2 \\rightarrow 1$\r\n\r\n\r\n#### 样例输入2\r\n\r\n```\r\n8 2 3\r\n0 2 3\r\n```\r\n\r\n#### 样例输出2\r\n\r\n```\r\n7497953\r\n```\r\n\r\n#### 样例输入3\r\n\r\n```\r\n3000 2 3\r\n0 1 3\r\n```\r\n\r\n#### 样例输出3\r\n\r\n```\r\n500207304\r\n```\r\n\r\n\r\n#### 样例输入4\r\n\r\n```\r\n876543210 233 4\r\n0 1 2 3\r\n```\r\n\r\n#### 样例输出4\r\n\r\n```\r\n467638557\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于所有数据，$1 \\leq n \\leq 9 \\times 10^8​$，$1 \\leq k \\leq 10^7$，$S$ 集合非空，$S$ 集合中所有元素为 $[0,3]$ 的非负整数。\r\n\r\n数据共分为 $7$ 个子任务。\r\n\r\n* 子任务 $1$（$5$ 分）：$n \\leq 8$。\r\n* 子任务 $2$（$10$ 分）：$n \\leq 5000$。\r\n* 子任务 $3$（$30$ 分）：$n \\leq 10^5$。\r\n* 子任务 $4$（$20$ 分）：$n \\leq 10^7$。\r\n* 子任务 $5$（$15$ 分）：$n \\leq 10^8$。\r\n* 子任务 $6$（$10$ 分）：$S=\\{0,1\\}$。\r\n* 子任务 $7$（$10$ 分）：无特殊限制。"}]}