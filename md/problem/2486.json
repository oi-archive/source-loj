{"title":"「CEOI2011」Treasure Hunt","time_limit":4000,"memory_limit":256,"tags":["2011","CEOI"],"operation":{"submit":"https://loj.ac/problem/2486#submit_code","submissions":"https://loj.ac/submissions?problem_id=2486","statistics":"https://loj.ac/problem/2486/statistics/fastest","testdata":"https://loj.ac/problem/2486/testdata","discussion":"https://loj.ac/discussion/problem/2486"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"现在有一棵树，初始时只有一个根节点 $1$，你需要完成下列两种操作：\r\n\r\n* `path u s` 表示在 $u$ 下面依次加入了 $s$ 个节点：其中的第 $i$ 个节点作为第 $i-1$ 个节点的孩子（$2\\le i\\le s$），特别地，第 $1$ 个节点会作为 $u$ 的孩子。设加入前时，树中节点的最大编号为 $n$，则新加入的 $s$ 个点会被依次编号为 $n+1,n+2,\\cdots,n+s$；\r\n* `dig u v` 表示询问 $u,v$ 的中点。形式化地，设 $u,v$ 间的距离为 $d$，则你需要求出 $u,v$的路径上，距离 $u$ 为 $\\lfloor \\frac d2\\rfloor$ 的节点编号。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"本题是一道交互题，首先你需要从标准输入读入操作次数 $n$。  \r\n接下来 $n$ 次，你会得到以下两种格式的指令之一：\r\n\r\n* `P u s` 表示一次 `path u s` 的操作；\r\n* `D u v` 表示一次 `dig u v` 的操作。\r\n\r\n对于第一种操作，你不需要输出任何东西。对于第二种操作，你必须给出答案并清空缓冲区后（`C/C++`中的`fflush(stdout)`），才可以读取后续操作。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"对于每一次 `D u v` 的操作，输出一行表示答案，保证至少有一次这样的操作。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n```plain\r\n12\r\nP 1 2\r\nD 1 3\r\nP 2 5\r\nD 7 3\r\nD 3 7\r\nP 1 2\r\nP 3 3\r\nD 10 11\r\nP 5 1\r\nD 14 8\r\nD 2 4\r\n```\r\n\r\n#### 样例输出\r\n```plain\r\n2\r\n5\r\n4\r\n1\r\n6\r\n2\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于 $20\\%$ 的数据，保证最终点的编号最大不超过 $5000$，且 $n\\le 5000$；  \r\n对于 $50\\%$ 的数据，保证最终点的编号最大不超过 $400\\ 000$；  \r\n对于 $100\\%$ 的数据，保证最终点的编号最大不超过 $10^9$，且 $n\\le 400\\ 000$。"}]}