{"title":"「HNOI2015」接水果","time_limit":1000,"memory_limit":256,"tags":["2015","HNOI","整体二分","扫描线"],"operation":{"submit":"https://loj.ac/problem/2113#submit_code","submissions":"https://loj.ac/submissions?problem_id=2113","statistics":"https://loj.ac/problem/2113/statistics/fastest","testdata":"https://loj.ac/problem/2113/testdata","discussion":"https://loj.ac/discussion/problem/2113"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"风见幽香非常喜欢玩一个叫做 osu! 的游戏，其中她最喜欢玩的模式就是接水果。由于她已经 DT FC 了 The big black,  她觉得这个游戏太简单了，于是发明了一个更加难的版本。\r\n\r\n首先有一个地图，是一棵由 $n$ 个顶点、$n-1$ 条边组成的树（例如图 $1$ 给出的树包含 $8$ 个顶点、$7$ 条边）。这颗树上有 P 个盘子，每个盘子实际上是一条路径（例如图 $1$ 中顶点 $6$ 到顶点 $8$ 的路径），并且每个盘子还有一个权值。第 $i$ 个盘子就是顶点 $a_i$ 到顶点 $b_i$ 的路径(由于是树，所以从 $a_i$ 到\r\n $b_i$ 的路径是唯一的)，权值为 $c_i$。接下来依次会有 $Q$ 个水果掉下来，每个水果本质上也是一条路径，第 $i$ 个水果是从顶点 $u_i$ 到顶点 $v_i$ 的路径。\r\n\r\n幽香每次需要选择一个盘子去接当前的水果：一个盘子能接住一个水果，当且仅当盘子的路径是水果的路径的子路径（例如图 $1$ 中从 $3$ 到 $7$ 的路径是从 $1$ 到\r\n $8$ 的路径的子路径）。这里规定：从 $a$ 到 $b$ 的路径与从 $b$ 到 $a$ 的路径是同一条路径。当然为了提高难度，对于第 $i$ 个水果，你需要选择能接住它的所有盘子中，权值第 $k_i$ 小的那个盘子，每个盘子可重复使用（没有使用次数的上限：一个盘子接完一个水果后，后面还可继续接其他水果，只要它是水果路径的子路径）。幽香认为这个游戏很难，你能轻松解决给她看吗？\r\n\r\n<img src=\"https://ooo.0o0.ooo/2017/04/29/59041aa077bc4.png\">"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行三个数 $n$ 和 $P$ 和 $Q$，表示树的大小和盘子的个数和水果的个数。 \r\n\r\n接下来 $n-1$ 行，每行两个数 $a$、$b$，表示树上的 $a$ 和 $b$ 之间有一条边。树中顶点按 $1$ 到 $n$ 标号。 接下来 $P$ 行，每行三个数 $a$、$b$、$c$，表示路径为 $a$ 到 $b$、权值为 $c$ 的盘子，其中 $0 \\leq c \\leq 10^9, \\ a \\neq b$。\r\n \r\n接下来 $Q$ 行，每行三个数 $u$、$v$、$k$，表示路径为 $u$ 到 $v$ 的水果，其中 $u$ 不等于 $v$，你需要选择第 $k$ 小的盘子，第 $k$ 小一定存在。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"对于每个果子，输出一行表示选择的盘子的权值。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n```plain\r\n10 10 10 \r\n1 2 \r\n2 3 \r\n3 4 \r\n4 5 \r\n5 6 \r\n6 7 \r\n7 8 \r\n8 9 \r\n9 10 \r\n3 2 217394434 \r\n10 7 13022269 \r\n6 7 283254485 \r\n6 8 333042360 \r\n4 6 442139372 \r\n8 3 225045590 \r\n10 4 922205209 \r\n10 8 808296330 \r\n9 2 486331361 \r\n4 9 551176338 \r\n1 8 5 \r\n3 8 3 \r\n3 8 4 \r\n1 8 3 \r\n4 8 1 \r\n2 3 1 \r\n2 3 1 \r\n2 3 1 \r\n2 4 1 \r\n1 4 1\r\n```\r\n\r\n#### 样例输出\r\n```plain\r\n442139372 \r\n333042360 \r\n442139372 \r\n283254485 \r\n283254485 \r\n217394434 \r\n217394434 \r\n217394434 \r\n217394434 \r\n217394434\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于所有数据，$N,P,Q \\leq 40000$。"}]}