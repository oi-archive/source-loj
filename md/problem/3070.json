{"title":"「2019 集训队互测 Day 1」最短路径","time_limit":2500,"memory_limit":512,"tags":["集训队互测","2019","DFT（含 NTT）及FFT","概率与期望","点分治","分治","复杂度分析"],"operation":{"submit":"https://loj.ac/problem/3070#submit_code","submissions":"https://loj.ac/submissions?problem_id=3070","statistics":"https://loj.ac/problem/3070/statistics/fastest","testdata":"https://loj.ac/problem/3070/testdata","discussion":"https://loj.ac/discussion/problem/3070"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"小 E 和小 F 在做游戏。他们找来了一个**无向连通图** $G=(V,E)$ 。图 $G$ 满足 $V=\\{1,2,\\dots,n\\}$，$|E|=n$ 。\r\n\r\n定义 $d(u,v)=G$ 中 $u$ 和 $v$ 之间的最短距离，这里 $G$ 中的每条边权值均为 $1$。小 E 会在所有满足 $u,v\\in V$，且$u< v$ 的点对 $(u,v)$ 中随机选择一个，然后让小 F 求出 $d(u,v)^k$，作为这次游戏的快乐程度。\r\n\r\n在游戏之前，小 F 想知道游戏的快乐程度的期望，于是让小 O 去算。小 O 不会算，找到了你。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行包含两个整数 $n,k$ 。\r\n\r\n接下来 $n$ 行每行两个整数 $u,v$ 表示 $(u,v)\\in E$。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"设答案为 $p\\over q$，且 $\\gcd(p,q)=1$，则应该输出一个整数 $r$ 满足 $q\\cdot r\\equiv p \\bmod 998244353,0\\le r<998244353 $，可以证明在本题中 $r$ 是唯一的。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n```plain\r\n4 3\r\n1 2\r\n2 3\r\n3 4\r\n2 4\r\n```\r\n\r\n#### 样例输出\r\n```plain\r\n332748121\r\n```\r\n\r\n#### 样例说明\r\n\r\n$d(1,2)=d(2,3)=d(3,4)=d(2,4)=1$，$d(1,3)=d(1,4)=2$。\r\n"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"本题采用子任务制。对于所有数据满足 $1\\le n\\le 10^5,1\\le k\\le 10^9$，保证给定的图 $G$ 满足题中要求，且不存在重边。\r\n\r\n$\\texttt{subtask 1:}~ 5\\%$，满足 $n\\le 1000$ 。\r\n\r\n$\\texttt{subtask 2:}~10\\%$，满足 $k=1$ 。\r\n\r\n$\\texttt{subtask 3:}~15\\%$，满足 $k=2$ 。\r\n\r\n$\\texttt{subtask 4:}~30\\%$，满足 $G$ 中存在一条边 $(u,u)$ 。\r\n\r\n$\\texttt{subtask 5:}~40\\%$，无额外限制。"}]}