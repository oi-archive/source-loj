{"title":"「JOISC 2014 Day2」水壶","time_limit":5000,"memory_limit":512,"tags":["2014","JOISC","最小生成树","笛卡尔树 / Kruskal 重构树","搜索"],"operation":{"submit":"https://loj.ac/problem/2876#submit_code","submissions":"https://loj.ac/submissions?problem_id=2876","statistics":"https://loj.ac/problem/2876/statistics/fastest","testdata":"https://loj.ac/problem/2876/testdata","discussion":"https://loj.ac/discussion/problem/2876"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"**题目译自 JOISC 2014 Day2 T1「[水筒](https://www.ioi-jp.org/camp/2014/2014-sp-tasks/2014-sp-d2.pdf)」**\r\n\r\nJOI 君所居住的 IOI 市以一年四季都十分炎热著称。\r\n\r\nIOI 市被分成 $H$ 行，每行包含 $W$ 块区域。每个区域都是建筑物、原野、墙壁之一。  \r\nIOI 市有 $P$ 个区域是建筑物，坐标分别为 $(A_1, B_1),$ $(A_2, B_2),$ $\\ldots,$ $(A_P, B_P)$。    \r\nJOI 君只能进入建筑物与原野，而且每次只能走到相邻的区域中，且不能移动到市外。\r\n\r\nJOI 君因为各种各样的事情，必须在各个建筑物之间往返。虽然建筑物中的冷气设备非常好，但原野上太阳非常毒辣，因此在原野上每走过一个区域都需要 1 升水。此外，原野上没有诸如自动售货机、饮水处之类的东西，因此 IOI 市的市民一般都携带水壶出行。大小为 $x$ 的水壶最多可以装 $x$ 升水，建筑物里有自来水可以将水壶装满。  \r\n由于携带大水壶是一件很困难的事情，因此 JOI 君决定携带尽量小的水壶移动。因此，为了随时能在建筑物之间移动，请你帮他写一个程序来计算最少需要多大的水壶。\r\n\r\n现在给出 IOI 市的地图和 $Q$ 个询问，第 $i$ 个询问包含两个整数 $S_i,$ $T_i$，对于每个询问，请输出：要从建筑物 $S_i$ 移动到 $T_i$，至少需要多大的水壶？"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行四个空格分隔的整数 $H,W,P,Q$。  \r\n接下来 $H$ 行，第 $i$ 行有一个长度为 $W$ 的字符串，每个字符都是 `.` 或 `#` 之一，`.` 表示这个位置是建筑物或原野，`#` 表示这个位置是墙壁。  \r\n接下来 $P$ 行描述 IOI 市每个建筑物的位置，第 $i$ 行有两个空格分隔的整数 $A_i$ 和 $B_i$，表示第 $i$ 个建筑物的位置在第 $A_i$ 行第 $B_i$ 列。保证这个位置在地图中是 `.`。  \r\n接下来 $Q$ 行，第 $i$ 行有两个空格分隔的整数 $S_i,$ $T_i$。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出 $Q$ 行，第 $i$ 行一个整数，表示要从建筑物 $S_i$ 移动到 $T_i$，至少需要多大的水壶。  \r\n如果无法到达，输出 `-1`。如果不需要经过原野就能到达，输出 `0`。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n5 5 4 4\r\n.....\r\n..##.\r\n.#...\r\n..#..\r\n.....\r\n1 1\r\n4 2\r\n3 3\r\n2 5\r\n1 2\r\n2 4\r\n1 3\r\n3 4\r\n```\r\n\r\n#### 样例输出 1\r\n```plain\r\n3\r\n4\r\n4\r\n2\r\n```\r\n\r\n#### 样例说明 1\r\n初始状态如下：\r\n\r\n<img src=\"https://i.loli.net/2018/10/14/5bc304c3a3557.png\" width=\"30.5%\" />\r\n\r\n其中■表示墙，含有数字的区域表示建筑，其他区域为原野。\r\n\r\n<img src=\"https://i.loli.net/2018/10/14/5bc304c3a9910.png\" width=\"70%\" />\r\n\r\n如果只不经过建筑物（左图），则需要容量为 6 升的水壶；但如果经过建筑物 1（右图），从建筑物 2 到 1 需要 3 升水，而从建筑物 1 到 4 需要 4 升水，因此只需要容量为 4 升的水壶。\r\n\r\n#### 样例输入 2\r\n```plain\r\n5 5 3 2\r\n...#.\r\n..#..\r\n#....\r\n.##..\r\n...#.\r\n1 3\r\n5 2\r\n1 5\r\n1 2\r\n1 3\r\n```\r\n\r\n#### 样例输出 2\r\n```plain\r\n-1\r\n7\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于所有数据，$1\\le H, W\\le 2000,$ $2\\le P\\le 2\\times 10^5,$ $1\\le Q\\le 2\\times 10^5,$ $1\\le A_i\\le H,$ $1\\le B_i\\le W$, $(A_i,B_i)≠(A_j,B_j)$ $(1\\le i<j\\le P),$ $1\\le S_i<T_i\\le P(1\\le i\\le Q)$。\r\n\r\n|子任务编号|分值|附加条件|\r\n|-|-|-|\r\n|1|10|$H, W, P\\le 200$|\r\n|2|30|$P\\le 5000, Q = 1$|\r\n|3|30|$P\\le 5000, Q \\le 10^4$|\r\n|4|30||"}]}