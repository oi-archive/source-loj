{"title":"「POI2012」约会 Rendezvous","time_limit":1000,"memory_limit":128,"tags":["POI","2012"],"operation":{"submit":"https://loj.ac/problem/2691#submit_code","submissions":"https://loj.ac/submissions?problem_id=2691","statistics":"https://loj.ac/problem/2691/statistics/fastest","testdata":"https://loj.ac/problem/2691/testdata","discussion":"https://loj.ac/discussion/problem/2691"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"**译自 POI 2012 Stage 1. 「[Rendezvous](https://szkopul.edu.pl/problemset/problem/MZTXfOVnJmac175TTH5Lr9Q3/site/?key=statement)」**\r\n\r\n给定一个有 $n$ 个顶点的有向图，每个顶点有且仅有一条出边。每次询问给出两个顶点 $a_i$ 和 $b_i$，求满足以下条件的 $x_i$ 和 $y_i$：\r\n* 从顶点 $a_i$ 沿出边走 $x_i$ 步与从顶点 $b_i$ 沿出边走 $y_i$ 步到达的顶点相同。\r\n* $\\max(x_i, y_i)$ 最小。\r\n* 满足以上条件的情况下 $\\min(x_i, y_i)$ 最小。\r\n* 如果以上条件没有给出一个唯一的解，则还需要满足 $x_i \\ge y_i$.\r\n\r\n如果不存在这样的 $x_i$ 和 $y_i$，则 $x_i = y_i = -1$."},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行两个正整数 $n$ 和 $k$（$1 \\le n \\le 500\\ 000,1 \\le k \\le 500\\ 000$），表示顶点数和询问个数。\r\n\r\n接下来一行 $n$ 个正整数，第 $i$ 个数表示 $i$ 号顶点出边指向的顶点。\r\n\r\n接下来 $k$ 行表示询问，每行两个整数 $a_i$ 和 $b_i$."},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"对每组询问输出两个整数 $x_i$ 和 $y_i$."},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n```plain\r\n12 5\r\n4 3 5 5 1 1 12 12 9 9 7 1\r\n7 2\r\n8 11\r\n1 2\r\n9 10\r\n10 5\r\n```\r\n![ran1.gif](https://ooo.0o0.ooo/2017/05/11/59145372073a0.gif)\r\n\r\n#### 样例输出\r\n```plain\r\n2 3\r\n1 2\r\n2 2\r\n0 1\r\n-1 -1\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于 $40\\%$ 的数据，$n \\le 2000,k \\le 2000$.\r\n\r\n对于 $100\\%$ 的数据，$1 \\le n \\le 500\\ 000,1 \\le k \\le 500\\ 000$."}]}