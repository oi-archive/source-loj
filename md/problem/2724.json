{"title":"「JOI 2015 Final」铁路旅行","time_limit":1000,"memory_limit":256,"tags":["2015","JOI","线段树","分块及按大小分类","前缀和","树状数组","差分"],"operation":{"submit":"https://loj.ac/problem/2724#submit_code","submissions":"https://loj.ac/submissions?problem_id=2724","statistics":"https://loj.ac/problem/2724/statistics/fastest","testdata":"https://loj.ac/problem/2724/testdata","discussion":"https://loj.ac/discussion/problem/2724"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"**译自 [JOI 2015 Final](https://www.ioi-jp.org/joi/2014/2015-ho/index.html) T1「[鉄道旅行](https://www.ioi-jp.org/joi/2014/2015-ho/2015-ho.pdf)」**\r\n\r\nJOI 国有 $N$ 座城市，依次编号为 $1,2,\\cdots ,N$ ；还有 $N-1$ 条可双向通行的铁路，依次编号为 $1,2,\\cdots ,N-1$ 。第 $i(1\\le i\\le N-1)$ 条铁路连接着城市 $i$ 和 $i+1$ 。\r\n\r\n在 JOI 国有两种乘坐列车的方法：一种是使用纸质车票，另一种是使用 IC 卡。\r\n\r\n- 对于铁路 $i$ ，用纸质车票乘车一次的价格是 $A_{i}$ 元。\r\n- 对于铁路 $i$ ，用 IC 卡乘车一次的价格是 $B_{i}$ 元。但是，如果要用 IC 卡在第 $i$ 条铁路乘车的话，必须事先购买在第 $i$ 条铁路使用的 IC 卡。购买在第 $i$ 条铁路使用的 IC 卡需要花费 $C_{i}$ 元。只要买过一次这条铁路的 IC 卡，无论在这条铁路使用 IC 卡乘车多少次都可以。\r\n\r\n由于用 IC 卡更容易结算费用，用 IC 卡乘车总是比用纸质车票乘车便宜。也就是说，对于 $i=1,2,\\cdots ,N-1$ ，总有 $A_{i} > B_{i}$ 成立。由于各条铁路的 IC 卡规格各不相同，对于任意的 $i$ ，能在铁路 $i$ 使用的 IC 卡并不能在其他铁路上使用。\r\n\r\n你准备在 JOI 国旅行，从城市 $P_{1}$ 出发，按照 $P_{2},P_{3},\\cdots ,P_{M}$ 的顺序进行参观。行程由 $M-1$ 天组成。第 $j(1\\le j\\le M-1)$ 天的计划是从城市 $P_{j}$ 坐火车移动到 $P_{j+1}$ 。可能会通过一些铁路中转。而且，你有可能多次参观同一座城市。因为 JOI 国的铁路速度很快，所以无论从哪座城市到哪座城市都能在 $1$ 天之内到达。\r\n\r\n现在你并没有任何一条铁路的 IC 卡。你想要买其中一些铁路的 IC 卡，从而使这次旅行所需的金额，也就是说，买 IC 卡和乘坐列车的费用总和最小。\r\n\r\n#### 任务\r\n\r\n编写程序以输入 JOI 国的城市数、旅行的行程以及 JOI 国中每一条铁路的票价和 IC 卡价格，求出旅行所需费用的最小值。\r\n"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"从标准输入输入数据，格式见下：\r\n\r\n- 第一行是两个由空格隔开的整数 $N$ 和 $M$ ，含义如题面所述;\r\n- 第二行是由空格隔开的 $M$ 个整数 $P_{1},P_{2},\\cdots ,P_{M}$ ，表示第 $j(1\\le j\\le M-1)$ 天从城市 $P_{j}$ 坐火车到城市 $P_{j+1}$ ;\r\n- 接下来 $N-1$ 行，其中第 $i(1\\le i\\le N-1)$ 行有三个由空格隔开的整数 $A_{i},B_{i},C_{i}$ ，分别表示对于铁路 $i$ ，用纸质车票乘车的价格为 $A_{i}$ 元，用 IC 卡乘车的价格为 $B_{i}$ 元，购买 IC 卡的价格为 $C_{i}$ 元。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出到标准输出，仅一行一个整数，即以元为单位的总花费最小值。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 输入样例 1\r\n```plain\r\n4 4\r\n1 3 2 4\r\n120 90 100\r\n110 50 80\r\n250 70 130\r\n```\r\n\r\n#### 输出样例 1\r\n```plain\r\n550\r\n```\r\n\r\n#### 样例说明 1\r\n\r\n在这种情况下，旅行总花费最小的方案如下：\r\n\r\n- 购买铁路 $2$ 和 $3$ 的 IC 卡。花去 $80+130=210$ 元。\r\n- 第一天，使用纸质车票从城市 $1$ 到城市 $2$ ，然后使用 IC 卡从城市 $2$ 到 $3$ 。花去 $120+50=170$ 元。\r\n- 第二天，使用 IC 卡从城市 $3$ 到城市 $2$ 。花去 $50$ 元。\r\n- 第三天，使用 IC 卡从城市 $2$ 到城市 $3$ ，然后使用 IC 卡从城市 $3$ 到城市 $4$ 。花去 $50+70=120$ 元。\r\n\r\n如果像这样乘车的话，旅行的总花费为 $210+170+50+120=550$ 元，是能够达到的最小值，因此输出 $550$。\r\n\r\n#### 输入样例 2\r\n```plain\r\n8 5\r\n7 5 3 5 4\r\n12 5 8\r\n16 2 1\r\n3 1 5\r\n17 12 17\r\n19 7 5\r\n12 2 19\r\n4 1 3\r\n```\r\n\r\n#### 输出样例 2\r\n```plain\r\n81\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"全部的输入数据满足：\r\n\r\n-  $2\\le N\\le 10^5$ \r\n-  $2\\le M\\le 10^5$ \r\n-  $1\\le B_{i} < A_{i}\\le 10^5(1\\le i \\le N-1)$ \r\n-  $1\\le C_{i}\\le 10^5(1\\le i \\le N-1)$ \r\n-  $1\\le P_{j}\\le N(1\\le j \\le M)$ \r\n-  $P_{j}\\ne P_{j+1}(1\\le j\\le M-1)$ \r\n\r\n#### 子任务 1 [$20$ 分]\r\n\r\n满足以下条件：\r\n\r\n-  $2\\le N \\le 1000$ \r\n-  $M=2$ \r\n-  $1\\le B_{i} < A_{i}\\le 1000(1\\le i \\le N-1)$ \r\n-  $1\\le C_{i}\\le 1000(1\\le i \\le N-1)$ \r\n\r\n#### 子任务 2 [$30$ 分]\r\n\r\n满足以下条件：\r\n\r\n-  $2\\le N \\le 1000$ \r\n-  $2\\le M \\le 1000$ \r\n-  $1\\le B_{i} < A_{i}\\le 1000(1\\le i \\le N-1)$ \r\n-  $1\\le C_{i}\\le 1000(1\\le i \\le N-1)$ \r\n\r\n#### 子任务 3 [$50$ 分]\r\n\r\n没有额外限制。"}]}