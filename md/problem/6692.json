{"title":"「MtOI2019」幻想乡数学竞赛","time_limit":1000,"memory_limit":128,"tags":["生成函数","数学","递推"],"operation":{"submit":"https://loj.ac/problem/6692#submit_code","submissions":"https://loj.ac/submissions?problem_id=6692","statistics":"https://loj.ac/problem/6692/statistics/fastest","testdata":"https://loj.ac/problem/6692/testdata","discussion":"https://loj.ac/discussion/problem/6692"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"一年一度的幻想乡数学竞赛 (thMO) 又要开始了。  \r\n\r\n幻想乡中学习数学的少 (lao) 女 (tai) 们 (po) 和冰之妖精 baka 一起准备着 thMO。  \r\n\r\n但是在那一刻，幻想乡日复一日的宁静被打破了。  \r\n\r\n广播里，播放起了死亡的歌曲！\r\n\r\n在那一刻，人们又回想起了被算数支配的恐惧。  \r\n\r\n就剩下 baka，baka，baka，baka 的声音在幻想乡里回荡。  \r\n \r\n---  \r\n\r\n河城 荷取 (Kawashiro Nitori) 正坐在 thMO2019 的考场上！  \r\n\r\n因为荷取有着她的[超级计算机](https://www.luogu.org/problemnew/show/P4911)，在成功地用光学迷彩覆盖了计算机之后，荷取在 thMO2019 的考场上所向披靡。  \r\n\r\n* 荷取用她的超级计算机 $0 \\,\\mathrm{ms}$ 跑出了这么一道题：  \r\n\r\n  * $\\exists \\{ a_n\\} (n=0,1,\\cdots ,10^{18})$，已知 $a_0=2,a_1=5,a_{n+2}=3a_{n+1}-2a_n$，求 $a_n\\bmod 10^{9}+7$\r\n\r\n* 荷取：显然，这个题可以用矩阵乘法 + 快速幂，可以 $O(\\log n)$ 水过去，差不多就这样：\r\n\r\n$$\r\n\\begin{bmatrix} a_n & a_{n+1} \\end{bmatrix}=\\begin{bmatrix} a_1 & a_2 \\end{bmatrix} \\times \\begin{bmatrix} 3 & 1 \\\\ -2 & 0 \\end{bmatrix}^n\r\n$$      \r\n  \r\n但是荷取遇到了一道她不会的题，她正在寻求你的帮助呢！ \r\n\r\n___\r\n\r\n存在一个数列 $\\{ a_n\\} (n\\in \\{ 0,1,2,\\cdots ,2^{64}-1\\} )$。  \r\n\r\n已知 $a_0=-3,a_1=-6,a_2=-12,a_n=3a_{n-1}+a_{n-2}-3a_{n-3}+3^n$。  \r\n\r\n* 现在给你一个非负整数 $n$ ，令 $p=10^{9}+7$，请你求出 $a_n \\bmod p$。 \r\n\r\n* **注：若 $a_n<0$ ，请输出 $(a_n \\bmod p+p)\\bmod p$。**    \r\n  \r\n  \r\n为了更充分地考验你的水平，荷取设置了 $T$ 组询问。\r\n\r\n* 为了在某种程度上减少你的输入和输出量，我们采用以下的代码来生成询问：  \r\n  \r\n```cpp\r\nnamespace Mker\r\n{\r\n//  Powered By Kawashiro_Nitori\r\n//  Made In Gensokyo, Nihon\r\n\t#include<climits>\r\n\t#define ull unsigned long long\r\n\t#define uint unsigned int\r\n\tull sd;int op;\r\n\tinline void init() {scanf(\"%llu %d\", &sd, &op);}\r\n\tinline ull ull_rand()\r\n\t{\r\n\t\tsd ^= sd << 43;\r\n\t\tsd ^= sd >> 29;\r\n\t\tsd ^= sd << 34;\r\n\t\treturn sd;\r\n\t}\r\n\tinline ull rand()\r\n\t{\r\n\t\tif (op == 0) return ull_rand() % USHRT_MAX + 1;\r\n\t\tif (op == 1) return ull_rand() % UINT_MAX + 1; \r\n\t\tif (op == 2) return ull_rand();\r\n\t}\r\n}\r\n```  \r\n\r\n在调用 `Mker::init()` 函数之后，你第 $i$ 次调用 `Mker::rand()` 函数时返回的便是第 $i$ 次询问的 $n_i$。\r\n\r\n在这里给出 $op$ 的限制：\r\n\r\n* 如果 $op=0$，满足 $n_i \\leq 2^{16}$。\r\n\r\n* 如果 $op=1$，满足 $n_i \\leq 2^{32}$。\r\n\r\n* 如果 $op=2$，满足 $n_i \\leq 2^{64}-1$。\r\n\r\n为了减少你的输出量，你只需要输出所有询问答案的**异或和**。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行三个整数，输入 $T$，$seed$ 和 $op$。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"第一行一个整数，输出 $T$ 组询问的答案的**异或和**。  "},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"##### 样例输入 1\r\n\r\n```plain\r\n142857 1145141919 0\r\n```\r\n\r\n#### 样例输出 1\r\n\r\n```plain\r\n562611141\r\n```\r\n\r\n#### 样例输入 2\r\n\r\n```plain\r\n142857 1145141919 1\r\n```\r\n\r\n#### 样例输出 2\r\n\r\n```plain\r\n894946216\r\n```\r\n\r\n#### 样例输入 3\r\n\r\n```plain\r\n142857 1145141919 2\r\n```\r\n\r\n#### 样例输出 3\r\n\r\n```plain\r\n771134436\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"#### 子任务  \r\n\r\n| 测试点编号 | $T$ | $seed$ | $op$ |\r\n| :-: | :-: | :-: | :-: |\r\n| $1$ | $\\leq 10^7$ | $=0$ | $2$ |\r\n| $2-3$ | $\\leq 5\\times 10^6$ | $=5201314$ | $0$ |\r\n| $4-5$ | $\\leq 10^6$ | $\\leq 2^{32}-1$ | $1$ |\r\n| $6$ | $\\leq 5\\times 10^6$ | $\\leq 2^{32}-1$ | $2$ |\r\n| $7$ | $\\leq 8\\times 10^6$ | $\\leq 2^{32}-1$ | $2$ |\r\n| $8-10$ | $\\leq 10^7$ | $\\leq 2^{32}-1$ | $2$ |\r\n| $11$ | $\\leq 2\\times 10^7$ | $\\leq 2^{32}-1$ | $0$ |\r\n| $12$ | $\\leq 2\\times 10^7$ | $=1145141919$ | $1$ |\r\n| $13-20$ | $\\leq 5\\times 10^7$ | $\\leq 2^{32}-1$ | $2$ |\r\n\r\n\r\n### 题目来源\r\n\r\n[迷途之家 2019 联赛](https://www.luogu.org/contest/20135) (MtOI2019) T4\r\n\r\n出题人：disangan233\r\n\r\n验题人：suwakow\r\n"}]}