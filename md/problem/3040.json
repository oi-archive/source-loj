{"title":"「JOISC 2019 Day4」合并","time_limit":3000,"memory_limit":256,"tags":["JOISC","2019","并查集"],"operation":{"submit":"https://loj.ac/problem/3040#submit_code","submissions":"https://loj.ac/submissions?problem_id=3040","statistics":"https://loj.ac/problem/3040/statistics/fastest","testdata":"https://loj.ac/problem/3040/testdata","discussion":"https://loj.ac/discussion/problem/3040"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"**题目译自 [JOISC 2019](https://www.ioi-jp.org/camp/2019/2019-sp-tasks/index.html) Day4 T2「[合併](https://www.ioi-jp.org/camp/2019/2019-sp-tasks/day4/mergers.pdf) / [Mergers](https://www.ioi-jp.org/camp/2019/2019-sp-tasks/day4/mergers-en.pdf)」**\r\n\r\nJOI 合众国有 $N$ 个城市，编号为 $1\\ldots N$，并且有 $N-1$ 条高速公路，编号为 $1\\ldots N-1$。第 $i\\ (1\\le i\\le N-1)$ 条高速公路双向连接城市 $A_i$ 与 $B_i$。一个人可以利用高速公路从任意一个城市到达另一个城市。\r\n\r\n目前，JOI 合众国有 $K$ 个州，编号为 $1\\ldots K$，城市 $j\\ (1\\le j\\le N)$ 属于州 $S_j$。任意一个州内至少有一个城市。\r\n\r\nJOI 合众国总统 K 先生害怕国家会分裂。JOI 合众国被称作**可分裂的**当且仅当所有城市可以被划分为 X 组和 Y 组，并且满足以下条件：\r\n- 所有城市属于 X 组或 Y 组之一；\r\n- X 组中至少有一个城市；\r\n- Y 组中至少有一个城市；\r\n- 对于任意一个州，所有所属州相同的城市都在同一组；\r\n- 一个人可以从 X 组的任意一个城市出发，通过高速公路并只经过属于 X 组的城市到达 X 组的任意一个城市；\r\n- 一个人可以从 Y 组的任意一个城市出发，通过高速公路并只经过属于 Y 组的城市到达 Y 组的任意一个城市。\r\n\r\nK 先生将要合并一些州，使得 JOI 合众国是不可分裂的。当他合并州的时候，他会选择两个州，然后把这两个州合并成一个新州。新州下辖的城市为原来两个州所有下辖的城市。K 先生想要在合并次数最少的情况下完成合并任务，使得 JOI 合众国是不可分裂的。\r\n\r\n注意，如果 JOI 合众国只有一个州，那么它是不可分裂的。\r\n\r\n写一个程序，在给定所有城市，州和高速公路的信息的情况下，计算使得 JOI 合众国不可分裂的最小合并次数。\r\n"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"从标准输入读入以下数据：\r\n\r\n第一行两个正整数 $N,K$，表示 JOI 合众国有 $N$ 个城市 $K$ 个州；\r\n\r\n接下来 $N-1$ 行，每行两个整数 $A_i,B_i$，描述 JOI 合众国内部高速公路的情况。\r\n\r\n接下来 $N$ 行，每行一个正整数 $S_j$，表示 $j$ 号城市属于 $S_j$ 州。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出一个整数到标准输出，表示使得 JOI 合众国不可分裂的最小合并次数。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n5 4\r\n1 2\r\n2 3\r\n3 4\r\n3 5\r\n1\r\n2\r\n1\r\n3\r\n4\r\n```\r\n#### 样例输出 1\r\n```plain\r\n1\r\n```\r\n#### 样例说明 1\r\n在这组样例中，初始情况的 JOI 合众国是可分裂的，例如，如果将 $1,2,3,4$ 号城市分到 X 组，$5$ 号城市分到 Y 组，这样是满足可分裂的条件的。\r\n\r\n如果 K 先生将 $3, 4$ 号州合并为一个州，JOI 合众国就不可分裂了，因此答案为 $1$。\r\n\r\n#### 样例输入 2\r\n```plain\r\n5 4\r\n1 2\r\n2 3\r\n3 4\r\n4 5\r\n1\r\n2\r\n3\r\n4\r\n1\r\n```\r\n#### 样例输出 2\r\n```plain\r\n0\r\n```\r\n#### 样例说明 2\r\n在这组样例中，初始情况 JOI 合众国就不可分裂，因此答案是 $0$。\r\n\r\n#### 样例输入 3\r\n```plain\r\n2 2\r\n1 2\r\n1\r\n2\r\n```\r\n#### 样例输出 3\r\n```plain\r\n1\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于全部数据，$1\\le N\\le 5\\times 10^5,1\\le K\\le N,1\\le A_i,B_i\\le N,1\\le S_j\\le K$，保证利用高速公路可以从任意一个城市到达另一个城市，对于任意 $k\\ (1\\le k\\le K)$，都存在 $j\\ (1\\le j\\le N)$ 使得 $S_j=k$。\r\n\r\n详细子任务及附加条件如下表：\r\n\r\n| 子任务 |                           附加条件                           | 分值 |\r\n| :----: | :----------------------------------------------------------: | :--: |\r\n|  $1$   |                      $N\\le 100,K\\le 7$                       | $10$ |\r\n|  $2$   |                     $N\\le 3\\times 10^3$                      | $24$ |\r\n|  $3$   |                     $N\\le 10^5,K\\le 50$                      | $14$ |\r\n|  $4$   | $N\\le 10^5$，在初始情况，同一个州下辖的城市之间最多只需要经过 $100$ 条高速公路就可以互相到达。 | $22$ |\r\n|  $5$   |                          无附加条件                          | $30$ |\r\n\r\n"}]}