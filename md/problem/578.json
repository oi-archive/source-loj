{"title":"「LibreOJ NOI Round #2」小球进洞","time_limit":4000,"memory_limit":512,"tags":["LibreOJ NOI Round","平衡树","Link-Cut Tree","线段树","数据结构"],"operation":{"submit":"https://loj.ac/problem/578#submit_code","submissions":"https://loj.ac/submissions?problem_id=578","statistics":"https://loj.ac/problem/578/statistics/fastest","testdata":"https://loj.ac/problem/578/testdata","discussion":"https://loj.ac/discussion/problem/578"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"有若干个小球放在数轴上，第 $i$ 号小球的坐标参数为 $a_i$。\r\n\r\n有两种操作：\r\n\r\n1. 输入 $i,v$，修改第 $i$ 号小球的坐标参数为 $a_i\\gets v$；\r\n\r\n2. 输入 $l,r$，询问下述内容：\r\n\r\n\t按照 $a_i$ 从小到大的顺序（$a_i$ 相等时按 $i$ 从小到大的顺序）依次将小球放在数轴上。第 $i$ 号小球放在 $\\le a_i$ 的没有被之前放置的小球占据的最大的整点处，设第 $i$ 号小球放置的位置为 $b_i$。\r\n\r\n\t请你输出 $\\sum_{i=1,2,\\dots , n,[l,r]\\subseteq [b_i,a_i]} (a_i+b_i)$ 的值。也即，所有满足 $b_i\\le l,a_i\\ge r$ 的小球的 $a_i+b_i$ 之和。\r\n"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"从标准输入读入数据。\r\n\r\n第一行两个正整数 $n,q$，分别表示小球个数和操作次数。\r\n\r\n第二行 $n$ 个整数 $a_1, a_2, \\dots , a_n$，用空格分隔，表示初始的坐标参数。\r\n\r\n接下来 $q$ 行每行是下列两种之一：\r\n\r\n1. $\\mathtt{1\\ i\\ v}$ 表示修改第 $i$ 个小球的坐标参数为 $a_i\\gets v$；\r\n\r\n2. $\\mathtt{2\\ l\\ r}$ 表示询问 $\\sum_{i=1,2,\\dots , n,[l,r]\\subseteq [b_i,a_i]} (a_i+b_i)$。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出到标准输出。\r\n\r\n对于每种操作 $\\mathtt{2}$，输出一行一个整数表示答案。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n3 5\r\n5 5 5\r\n2 4 5\r\n2 3 4\r\n1 2 4\r\n2 5 5\r\n2 1 3\r\n```\r\n\r\n#### 样例输出 1\r\n```plain\r\n17\r\n8\r\n18\r\n0\r\n```\r\n\r\n#### 样例解释 1\r\n\r\n最开始，三个小球的位置依次为：\r\n\r\n1. $b_1=5, a_1=5$；\r\n2. $b_2=4, a_2=5$；\r\n3. $b_3=3, a_3=5$。\r\n\r\n修改之后，三个小球的位置依次为：\r\n\r\n1. $b_2=4, a_2=4$；\r\n2. $b_1=5, a_1=5$；\r\n3. $b_3=3, a_3=5$。\r\n\r\n#### 样例输入 2\r\n```plain\r\n4 10\r\n5 6 7 6\r\n2 5 5\r\n2 4 6\r\n2 5 7\r\n2 5 8\r\n1 1 5\r\n2 5 5\r\n1 2 5\r\n2 6 6\r\n2 4 4\r\n1 3 6\r\n```\r\n\r\n#### 样例输出 2\r\n```plain\r\n20\r\n10\r\n0\r\n0\r\n20\r\n12\r\n9\r\n```\r\n\r\n#### 样例 3\r\n\r\n见附加文件（点击页面上方「附加文件」按钮下载）。"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于所有数据，$1\\le n \\le 10^5 ,1\\le q\\le 2\\times 10^5 , n< a_i,v \\le 2n , 1\\le l \\le r \\le 2n$。\r\n\r\n详细的数据限制及约定如下（留空表示和上述所有数据的约定相同）：\r\n\r\n|子任务编号|分值|$n,q$|特殊性质|\r\n|:-:|:-:|:-:|:-:|\r\n|1|$10$|$n,q\\leq 1000$||\r\n|2|$10$||$a_i,v \\le n+50$|\r\n|3|$20$||没有操作 $\\texttt{1}$|\r\n|4|$30$||每次修改的 $\\lvert v - a_i\\rvert \\le 1$，即每次修改最多只会让 $a_i$ 改变 $1$。|\r\n|5|$30$|||\r\n"}]}