{"title":"月考","time_limit":1000,"memory_limit":256,"tags":[],"operation":{"submit":"https://loj.ac/problem/6292#submit_code","submissions":"https://loj.ac/submissions?problem_id=6292","statistics":"https://loj.ac/problem/6292/statistics/fastest","testdata":"https://loj.ac/problem/6292/testdata","discussion":"https://loj.ac/discussion/problem/6292"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"十一黄金周去 qbxt 浪了一个礼拜之后，dkw 终于要月考了！\r\n\r\ndkw 的文综太差了，全校排名 1100+（全校就 1100 多人），他分析了好久，发现他如果把所有时间放在选择题上，得分会比较好一点。\r\n\r\n文综题目共有 $n$ 个，编号从 $1$ 到 $n$。\r\n\r\ndkw 给每个题目算出来了一个预估值 $A_i$。\r\n\r\n具体来说，有四种操作：\r\n\r\n- `L x y p`：表示 dkw 询问 $[x,y]$ 的 $\\text{lcm}$ 对 $p$ 取模之后的值；\r\n- `G x y p`：表示 dkw 询问 $[x,y]$ 的 $\\gcd$ 对 $p$ 取模之后的值；\r\n- `C x y c`：表示 dkw 改变了 $[x,y]$ 的预估值，统一为 $c$；\r\n- `S x y p`：表示 dkw 询问 $[x,y]$ 的公因数个数对 $p$ 取模之后的值。\r\n\r\ndkw 月考不能挂科，不然他就不能学习 OI 了（假的），所以请你帮帮他吧！\r\n"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行，两个正整数 $n$ 和 $q$，$q$ 表示操作次数；\r\n\r\n第二行，$n$ 个正整数，表示 dkw 对题目的预估值；\r\n\r\n接下来 $q$ 行，每行输入一个操作，格式详见题目描述。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"对于每个询问，输出它的答案。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n```plain\r\n10 10\r\n42 68 35 1 70 25 79 59 63 65 \r\nL 2 6 28\r\nL 2 6 43\r\nG 2 7 5\r\nG 3 4 83\r\nL 7 9 96\r\nG 2 7 39\r\nS 3 8 100\r\nL 4 5 12\r\nG 4 4 65\r\nL 2 4 69\r\n```\r\n\r\n#### 样例输出\r\n```plain\r\n0\r\n32\r\n1\r\n1\r\n75\r\n1\r\n1\r\n10\r\n1\r\n34\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于 $30\\%$ 的数据，$1\\le n,q\\le 1000$；  \r\n对于另外 $20\\%$ 的数据，$1\\le n\\le 1000,1\\le q\\le 10^5$；  \r\n对于另外 $20\\%$ 的数据，$1\\le n,q\\le 10^5$，保证没有修改操作；  \r\n对于 $100\\%$ 的数据，$1\\le n,q\\le 3\\times 10^5$；  \r\n保证任何时刻每个题目的预估值都在 $[1,100]$ 之间，答案取模之后不超过 `int`。\r\n"}]}