{"title":"看无可看","time_limit":1000,"memory_limit":512,"tags":["矩阵","DFT（含 NTT）及FFT","数学"],"operation":{"submit":"https://loj.ac/problem/6183#submit_code","submissions":"https://loj.ac/submissions?problem_id=6183","statistics":"https://loj.ac/problem/6183/statistics/fastest","testdata":"https://loj.ac/problem/6183/testdata","discussion":"https://loj.ac/discussion/problem/6183"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"最后的一刻我看到了......  \r\n一片昏暗?  \r\n我记起来了，  \r\n我看到，那里有一个集合 $S$，集合 $S$ 中有 $n$ 个正整数 $a[i] \\ (1 \\leq i \\leq n)$。  \r\n我看到，打破昏暗的密码：  \r\n$$\\sum_{S' \\subseteq S \\wedge |S'|=k}f\\left(\\sum_{x \\in S'}x\\right)$$  \r\n记忆中的 $f$ 是一个数列，对于 $i \\gt 1$ 它满足 $f(i) = 2 \\times f(i-1) + 3 \\times f(i-2)$。  \r\n给出 $n,k,f(0),f(1)$ 和 $a[i]$，求上述式子的值，由于答案很大，输出答案对 $99991$ 取模的结果即可。\r\n"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行两个正整数 $n$ 和 $k$。  \r\n第二行 $n$ 个正整数 $a[i]$，$1 \\leq a[i] \\leq10^9$。  \r\n第三行两个正整数 $f(0)$ 和 $f(1)$，$1 \\leq f(0),f(1) \\lt 99991$。\r\n"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"一行一个数表示式子的值对 $99991$ 取模的结果，详情见题目描述。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n4 2\r\n1 2 1 3\r\n1 1\r\n```\r\n\r\n#### 样例输出 1\r\n```plain\r\n234\r\n```\r\n\r\n#### 样例解释 1\r\n$f=\\{1,1,5,13,41,121,365,1093,3281,9841...\\}$  \r\n选 $a[1]$ 和 $a[2]$，则 $f(a[1]+a[2])=13$。  \r\n选 $a[1]$ 和 $a[3]$，则 $f(a[1]+a[3])=5$。  \r\n选 $a[1]$ 和 $a[4]$，则 $f(a[1]+a[4])=41$。  \r\n选 $a[2]$ 和 $a[3]$，则 $f(a[2]+a[3])=13$。  \r\n选 $a[2]$ 和 $a[4]$，则 $f(a[2]+a[4])=121$。  \r\n选 $a[3]$ 和 $a[4]$，则 $f(a[3]+a[4])=41$。  \r\n则 $\\mathrm{ans}=13+5+41+13+121+41=234$。\r\n\r\n\r\n\r\n#### 样例输入 2\r\n```plain\r\n20 10\r\n125 3162 3261 152 376 238 462 4382 376 4972 16 1872 463 9878 688 308 125 236 3526 543\r\n1223 3412\r\n```\r\n\r\n#### 样例输出 2\r\n```plain\r\n32071\r\n```\r\n\r\n#### 样例输入 3, 4\r\n见附加文件\r\n\r\n#### 样例输出 3, 4\r\n见附加文件"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于 $20\\%$ 的数据,$1 \\leq n \\leq 20$。  \r\n对于另外 $10\\%$ 的数据，满足 $f(0)=f(1)=1$。  \r\n对于另外 $20\\%$ 的数据，满足 $1 \\leq n \\leq 5000$。  \r\n对于另外 $20\\%$ 的数据，满足所有 $a[i]$ 的和 $\\leq 10000$，$1 \\leq n \\leq 100$。  \r\n对于 $100\\%$ 的数据，$1 \\leq n \\leq 100000,1 \\leq a[i] \\leq 10^9,1 \\leq f(0), f(1) \\lt 99991$。\r\n\r\n**鸣谢纪中红太阳 Samjia2000 授权本 OJ 独家拥有在线测评使用权。**"}]}