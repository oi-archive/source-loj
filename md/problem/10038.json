{"title":"「一本通 2.1 练习 4」A Horrible Poem","time_limit":1200,"memory_limit":512,"tags":["POI","2012","hash","数论"],"operation":{"submit":"https://loj.ac/problem/10038#submit_code","submissions":"https://loj.ac/submissions?problem_id=10038","statistics":"https://loj.ac/problem/10038/statistics/fastest","testdata":"https://loj.ac/problem/10038/testdata","discussion":"https://loj.ac/discussion/problem/10038"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"**原题来自：POI 2012**\r\n\r\n给出一个由小写英文字母组成的字符串 $ S $，再给出 $ q $ 个询问，要求回答 $ S $ 某个子串的最短循环节。\r\n\r\n如果字符串 $ B $ 是字符串 $ A $ 的循环节，那么 $ A $ 可以由 $ B $ 重复若干次得到。\r\n"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行一个正整数 $ n $，表示 $ S $ 的长度。  \r\n第二行 $ n $ 个小写英文字母，表示字符串 $ S $ 。  \r\n第三行一个正整数 $ q $ ，表示询问个数。  \r\n下面 $ q $ 行每行两个正整数 $ a,b $  ，表示询问字符串 $ S[a..b] $ 的最短循环节长度。\r\n"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"依次输出 $ q $ 行正整数，第 $ i $ 行的正整数对应第 $ i $ 个询问的答案。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n```plain\r\n8\r\naaabcabc\r\n3\r\n1 3\r\n3 8\r\n4 8\r\n```\r\n#### 样例输出\r\n```plain\r\n1\r\n3\r\n5\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"$ 1 \\le a \\le b \\le n \\le {5\\times 10^5} ,$ $ q \\le {2\\times 10 ^ 6} $。"}]}