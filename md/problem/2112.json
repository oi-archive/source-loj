{"title":"「HNOI2015」亚瑟王","time_limit":1000,"memory_limit":256,"tags":["2015","HNOI","概率与期望","DP"],"operation":{"submit":"https://loj.ac/problem/2112#submit_code","submissions":"https://loj.ac/submissions?problem_id=2112","statistics":"https://loj.ac/problem/2112/statistics/fastest","testdata":"https://loj.ac/problem/2112/testdata","discussion":"https://loj.ac/discussion/problem/2112"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"小 K 不慎被 LL 邪教洗脑了，洗脑程度深到他甚至想要从亚瑟王邪教中脱坑。\r\n\r\n他决定，在脱坑之前，最后再来打一盘亚瑟王。既然是最后一战，就一定要打得漂亮。众所周知，亚瑟王是一个看脸的游戏，技能的发动都是看概率的。作为一个非洲人，同时作为一个前 OIer，小 K 自然是希望最大化造成伤害的期望值。但他已经多年没写过代码，连 Spaly 都敲不对了，因此，希望你能帮帮小 K，让他感受一下当欧洲人是怎样的体验。 \r\n\r\n本题中我们将考虑游戏的一个简化版模型。 \r\n\r\n玩家有一套卡牌，共 $n$ 张。游戏时，玩家将 $n$ 张卡牌排列成某种顺序，排列后将卡牌按从前往后依次编号为 $1 \\sim  n$。本题中，顺序已经确定，即为输入的顺序。\r\n\r\n每张卡牌都有一个技能。第 $i$ 张卡牌的技能发动概率为 $p_i$，如果成功发动，则会对敌方造成 $d_i$ 点伤害。也只有通过发动技能，卡牌才能对敌方造成伤害。基于现实因素以及小 K 非洲血统的考虑，$p_i$ 不会为 0，也不会为 1，即 $0 < p_i < 1$。\r\n \r\n一局游戏一共有 $r$ 轮。在每一轮中，系统将从第一张卡牌开始，按照顺序依次考虑每张卡牌。在一轮中，对于依次考虑的每一张卡牌：\r\n\r\n1. 如果这张卡牌在这一局游戏中已经发动过技能，则   \r\n    1.1 如果这张卡牌不是最后一张，则跳过之（考虑下一张卡牌）； 否则（是最后一张），结束这一轮游戏。  \r\n2. 否则（这张卡牌在这一局游戏中没有发动过技能），设这张卡牌为第 $i$ 张。  \r\n    2.1 将其以 $p_i$ 的概率发动技能。  \r\n    2.2 如果技能发动，则对敌方造成 $d_i$点伤害，并结束这一轮。  \r\n    2.3 如果这张卡牌已经是最后一张（即 $i$ 等于 $n$），则结束这一轮；否则，考虑下一张卡牌。 \r\n\r\n请帮助小 K 求出这一套卡牌在一局游戏中能造成的伤害的期望值。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"输入文件的第一行包含一个整数 $T$，代表测试数据组数。   \r\n接下来一共 $T$ 组数据。   \r\n每组数据的第一行包含两个用空格分开的整数 $n$ 和 $r$，分别代表卡牌的张数和游戏的轮数。  \r\n接下来 $n$ 行，每行包含一个实数和一个整数，由空格隔开，描述一张卡牌。第 $i$ 行的两个数为 $p_i$ 和 $d_i$，分别代表第 $i$ 张卡牌技能发动的概率（实数）和技能发动造成的伤害（整数）。保证 $p_i$ 最多包含四位小数，且为一个合法的概率。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"对于每组数据，输出一行，包含一个实数，为这套卡牌在这一局游戏中造成的伤害的期望值。\r\n\r\n对于每一行输出，只有当你的输出和标准答案的相对误差不超过 $10^{-8}$ 时——即 $\\frac{|a-o|}{a} \\leq 10^{-8}$ 时 (其中 $a$ 是标准答案，$o$ 是输出)，你的输出才会被判为正确。建议输出十位小数。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n```plain\r\n1 \r\n3 2 \r\n0.5000 2 \r\n0.3000 3 \r\n0.9000 1\r\n```\r\n\r\n#### 样例输出\r\n```plain\r\n3.2660250000\r\n```\r\n\r\n#### 样例解释\r\n一共有 $13$ 种可能的情况： \r\n\r\n1.  第一轮中，第 $1$ 张卡牌发动技能；第二轮中，第 $2$ 张卡牌发动技能；概率为 $0.15$，伤害为 $5$。 \r\n2.  第一轮中，第 $1$ 张卡牌发动技能；第二轮中，第 $3$ 张卡牌发动技能；概率为 $0.315$，伤害为 $3$。 \r\n3.  第一轮中，第 $1$ 张卡牌发动技能；第二轮不发动技能；概率为 $0.035$，伤害为 $2$。 \r\n4.  第一轮中，第 $2$ 张卡牌发动技能；第二轮中，第 $1$ 张卡牌发动技能；概率为 $0.075$，伤害为 $5$。 \r\n5.  第一轮中，第 $2$ 张卡牌发动技能；第二轮中，第 $3$ 张卡牌发动技能；概率为 $0.0675$，伤害为 $4$。 \r\n6.  第一轮中，第 $2$ 张卡牌发动技能；第二轮不发动技能； 概率为 $0.0075$，伤害为 $3$。 \r\n7.  第一轮中，第 $3$ 张卡牌发动技能；第二轮中，第 $1$ 张卡牌发动技能；概率为 $0.1575$，伤害为 $3$。 \r\n8.  第一轮中，第 $3$ 张卡牌发动技能；第二轮中，第 $2$ 张卡牌发动技能；概率为 $0.04725$，伤害为 $4$。 \r\n9.  第一轮中，第 $3$ 张卡牌发动技能；第二轮不发动技能； 概率为 $0.11025$，伤害为 $1$。 \r\n10.  第一轮不发动技能；第二轮中，第 $1$ 张卡牌发动技能； 概率为 $0.0175$，伤害为 $2$。 \r\n11.  第一轮不发动技能；第二轮中，第 $2$ 张卡牌发动技能； 概率为 $0.00525$，伤害为 $3$。 \r\n12.  第一轮不发动技能；第二轮中，第 $3$ 张卡牌发动技能； 概率为 $0.011025$，伤害为 $1$。\r\n13.  第一轮不发动技能；第二轮亦不发动技能； 概率为 $0.001225$，伤害为 $0$。\r\n \r\n造成伤害的期望值为概率与对应伤害乘积之和，为 $3.266025$。 \r\n"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于所有测试数据， $1 \\leq T \\leq 444, \\ 1 \\leq n \\leq 220, \\ 0 \\leq r \\leq 132, \\ 0 < p_i < 1, \\ 0 \\leq d_i \\leq 1000$。  \r\n\r\n除非备注中有特殊说明，数据中 $p_i$ 与 $d_i$ 均为随机生成。 \r\n\r\n请注意可能存在的实数精度问题，并采取适当措施。"}]}