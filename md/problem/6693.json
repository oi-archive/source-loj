{"title":"「MtOI2019」幽灵乐团","time_limit":2000,"memory_limit":256,"tags":["莫比乌斯反演","杜教筛","数论","Special Judge"],"operation":{"submit":"https://loj.ac/problem/6693#submit_code","submissions":"https://loj.ac/submissions?problem_id=6693","statistics":"https://loj.ac/problem/6693/statistics/fastest","testdata":"https://loj.ac/problem/6693/testdata","discussion":"https://loj.ac/discussion/problem/6693"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"白玉楼中，冥界的音乐会开始了。\r\n\r\nLusana ，Lyrica 和 Merlin 正在演奏。\r\n\r\n---\r\n\r\n东风谷 早苗 (Kochiya Sanae) 非常喜欢幽灵乐团的演奏，她想对她们的演奏评分。\r\n\r\n因为幽灵乐团有 $3$ 个人，所以我们可以用 $3$ 个正整数 $A,B,C$ 来表示出乐团演奏的分数，她们的演奏分数可以表示为\r\n\r\n$$\r\n\\prod_{i=1}^{A}\\prod_{j=1}^{B}\\prod_{k=1}^{C}\\left(\\frac{\\mathrm{lcm}(i,j)}{\\gcd(i,k)}\\right)^{f(\\text{type})}\r\n$$\r\n\r\n因为音乐在不同的部分会有不同的听觉感受，所以 $\\text{type}$ 会在 $\\{0,1,2\\}$ 中发生变化，其中：\r\n\r\n$$\r\n\\begin{split}\r\n&f(0)=1 \\\\\r\n&f(1)=i \\times j \\times k \\\\\r\n&f(2)=\\gcd (i,j,k)\r\n\\end{split}\r\n$$\r\n\r\n因为乐团的歌实在太好听了，导致分数特别高，所以她们的分数要对给定的正整数 $p$ 取模。\r\n\r\n因为有很多歌曲要演奏，所以早苗给出了 $T$ 组询问。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行两个正整数 $T$，$p$，含义详见题目描述。\r\n\r\n接下来 $T$ 行，每行三个正整数 $A,B,C$ 表示每组询问。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"$T$ 行，每行三个正整数分别表示 $\\text{type}= \\{0,1,2\\}$ 的时候给定式子的值"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n\r\n```plain\r\n3 998244853\r\n1 1 1\r\n2 2 2\r\n3 3 3\r\n```\r\n#### 样例输出\r\n\r\n```plain\r\n1 1 1\r\n16 4096 16\r\n180292630 873575259 180292630\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"#### 子任务\r\n\r\n对于 $10\\%$ 的数据：$1\\leq A,B,C\\leq 50$；\r\n\r\n对于 $20\\%$ 的数据：$1\\leq A,B,C\\leq 100 $；\r\n\r\n另有 $10\\%$ 的数据：$1\\leq A,B,C\\leq 100,A=B=C$；\r\n\r\n对于 $60\\%$ 的数据：$1\\leq A,B,C\\leq 10^3$；\r\n\r\n对于 $100\\%$ 的数据：$1\\leq A,B,C\\leq 10^5,10^7 \\leq p \\leq 1.05\\times 10^9,T =70$，保证 $p$ 是一个质数。\r\n\r\n\r\n---\r\n\r\n早苗非常善良，就算你不知道所有的正确答案，她也会给你一些分数。 \r\n\r\n* 如果你的第一列是正确的，她将会给你这个测试点 $20\\%$ 的分数。\r\n\r\n* 如果你的第二列是正确的，她将会给你这个测试点 $40\\%$ 的分数。\r\n\r\n* 如果你的第三列是正确的，她将会给你这个测试点 $40\\%$ 的分数。  \r\n\r\n所以就算你不知道答案是什么，也请你在你不知道的那些地方输出 $[0,2^{31})$ 内的整数，否则可能会造成不可预估的错误。\r\n\r\n#### 题目来源\r\n\r\n[迷途之家 2019 联赛](https://www.luogu.org/contest/20135) (MtOI2019) T5\r\n\r\n出题人： CYJian"}]}