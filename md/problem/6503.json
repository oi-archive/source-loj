{"title":"「雅礼集训 2018 Day4」Magic","time_limit":1000,"memory_limit":128,"tags":["雅礼集训","2018","DFT（含 NTT）及FFT","容斥原理","组合计数","数学"],"operation":{"submit":"https://loj.ac/problem/6503#submit_code","submissions":"https://loj.ac/submissions?problem_id=6503","statistics":"https://loj.ac/problem/6503/statistics/fastest","testdata":"https://loj.ac/problem/6503/testdata","discussion":"https://loj.ac/discussion/problem/6503"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"> 前进！前进！不择手段地前进！——托马斯 · 维德\r\n\r\n魔法纪元元年。\r\n\r\n1453 年 5 月 3 日 16 时，高维碎片接触地球。\r\n\r\n1453 年 5 月 28 日 21 时，碎片完全离开地球。\r\n\r\n1453 年，君士坦丁堡被围城，迪奥娜拉接触到四维泡沫空间，成为魔法师，最终因高维碎片消失失去魔力而身死。\r\n\r\n为了改写这段历史，你不惜耗费你珍藏已久的魔术卡来回到魔法纪元元年。\r\n\r\n在使用这些魔术卡之前，你却对它们的排列起了兴趣...\r\n\r\n桌面上摆放着 $m$ 种魔术卡，共 $n$ 张，第 $i$ 种魔术卡数量为 $a_i$，魔术卡顺次摆放，形成一个长度为 $n$ 的魔术序列，在魔术序列中，若两张相邻魔术卡的种类相同，则它们被称为一个魔术对。\r\n\r\n两个魔术序列本质不同，当且仅当存在至少一个位置，使得两个魔术序列这个位置上的魔术卡的种类不同，求本质不同的恰好包含 $k$ 个魔术对的魔术序列的数量，答案对 $998244353$ 取模。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行三个整数 $m, n, k$。\r\n\r\n第二行 $m$ 个正整数，第 $i$ 个正整数表示 $a_i$。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"一行一个整数表示答案。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n3 5 1\r\n2 2 1\r\n```\r\n\r\n#### 样例输出 1\r\n```plain\r\n12\r\n```\r\n\r\n#### 样例解释 1\r\n\r\n设三种颜色分别为 $\\rm A, B, C$，则合法的 $12$ 种方案分别为：$\\rm (AABCB)$，$\\rm (ABBAC)$，$\\rm (ABBCA)$，$\\rm (ACABB)$，$\\rm (ACBBA)$，$\\rm (BAABC)$，$\\rm (BAACB)$，$\\rm (BBACA)$，$\\rm (BCAAB)$，$\\rm (BCBAA)$，$\\rm (CABBA)$，$\\rm (CBAAB)$\r\n\r\n\r\n#### 样例输入 2\r\n```plain\r\n3 6 0\r\n1 2 3\r\n```\r\n\r\n#### 样例输出 2\r\n```plain\r\n10\r\n```\r\n\r\n#### 样例输入 3\r\n```plain\r\n2 100 20\r\n50 50\r\n```\r\n\r\n#### 样例输出 3\r\n```plain\r\n164333748\r\n```\r\n\r\n#### 样例输入 4\r\n```plain\r\n5 2333 666\r\n300 1000 233 200 600\r\n```\r\n\r\n#### 样例输出 4\r\n```plain\r\n119409616\r\n```\r\n\r\n#### 样例输入 5\r\n```plain\r\n5 30000 0\r\n4000 5000 6000 7000 8000\r\n```\r\n\r\n#### 样例输出 5\r\n```plain\r\n522962185\r\n```\r\n\r\n#### 样例输入 6\r\n```plain\r\n6 50000 12345\r\n9896 104 15000 13000 8000 4000\r\n```\r\n\r\n#### 样例输出 6\r\n```plain\r\n940147981\r\n```\r\n"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"| 测试点编号 | $m$ | $n$ | $k$ | 特殊性质 |\r\n| :-: | :-: | :-: | :-: | :-: |\r\n| 1 | $=2$ | $\\leq 300$ | $ = 1$ | |\r\n| 2 | $=2$ | $\\leq 300$ | $ = 2$ | |\r\n| 3 | $=2$ | $\\leq 300$ | | |\r\n| 4 | $=2$ | $\\leq 300$ | | |\r\n| 5 | $=3$ | $\\leq 16$ | | |\r\n| 6 | $=3$ | $\\leq 16$ | | |\r\n| 7 | $=3$ | $\\leq 80$ | | |\r\n| 8 | $=3$ | $\\leq 80$ | | |\r\n| 9 | $=3$ | $\\leq 80$ | | |\r\n| 10 | $ \\leq 100$ | $\\leq 100$ | $= 0$ | $m = n$ |\r\n| 11 | $ \\leq 2000$ | $\\leq 5000$ | $= 0$ | |\r\n| 12 | $ \\leq 2000$ | $\\leq 5000$ | $= 0$ | |\r\n| 13 | $ \\leq 2000$ | $\\leq 5000$ | $= 0$ | |\r\n| 14 | $ \\leq 2000$ | $\\leq 5000$ | | |\r\n| 15 | $ \\leq 2000$ | $\\leq 5000$ | | |\r\n| 16 | $ \\leq 2000$ | $\\leq 5000$ | | |\r\n| 17 | $ \\leq 20000$ | $\\leq 100000$ | $= 0$|$a_i$均相等且 $\\leq 20$ |\r\n| 18 | $ \\leq 20000$ | $\\leq 100000$ | $= 0$|$a_i$均相等且 $\\leq 20$ |\r\n| 19 | $ \\leq 20000$ | $\\leq 100000$ | $= 0$|$a_i$均相等且 $\\leq 20$ |\r\n| 20 | $ \\leq 20000$ | $\\leq 100000$ | $= 0$| |\r\n| 21 | $ \\leq 20000$ | $\\leq 100000$ | $= 0$| |\r\n| 22 | $ \\leq 20000$ | $\\leq 100000$ | | |\r\n| 23 | $ \\leq 20000$ | $\\leq 100000$ | | |\r\n| 24 | $ \\leq 20000$ | $\\leq 100000$ |   |   |\r\n| 25 | $ \\leq 20000$ | $\\leq 100000$ |   |   | |\r\n\r\n对于 $100 \\%$ 的数据满足 $1 \\leq m \\leq 20000, 0 \\leq k \\leq n \\leq 100000, \\sum_{i = 1}^{m} a_i = n$。"}]}