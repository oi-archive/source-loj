{"title":"「SHOI2017」相逢是问候","time_limit":2000,"memory_limit":512,"tags":["2017","SHOI","线段树","欧拉定理","数据结构","数学","数论"],"operation":{"submit":"https://loj.ac/problem/2142#submit_code","submissions":"https://loj.ac/submissions?problem_id=2142","statistics":"https://loj.ac/problem/2142/statistics/fastest","testdata":"https://loj.ac/problem/2142/testdata","discussion":"https://loj.ac/discussion/problem/2142"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"> Informatik verbindet dich und mich.  \r\n> 信息将你我连结。\r\n\r\nB 君希望以维护一个长度为 $n$ 的数组，这个数组的下标为从 $1$ 到 $n$ 的正整数。\r\n\r\n一共有 $m$ 个操作，可以分为两种：\r\n* $0 \\ l \\ r$：表示将第 $l$ 个到第 $r$ 个数 $(a_l, a_{l+1}, \\dots, a_r)$ 中的每一个数 $a_i$ 替换为 $c^{a_i}$，即 $c$ 的 $a_i$ 次方，其中 $c$ 是输入的一个常数，也就是执行赋值\r\n    $$a_i \\leftarrow c^{a_i}$$\r\n* $1 \\ l \\ r$：求第 $l$ 个到第 $r$ 个数的和，也就是输出：\r\n    $$\\sum_{i = l}^r a_i$$\r\n\r\n因为这个结果可能会很大，所以你只需要输出结果 $\\mathrel{\\mathrm{mod}} p$ 的值即可。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行有四个整数 $n, m, p, c$，所有整数含义见问题描述。  \r\n接下来一行 $n$ 个整数，表示 $a$ 数组的初始值。  \r\n接下来 $m$ 行，每行三个整数，其中第一个整数表示了操作的类型。  \r\n* 如果是 $0$ 的话，表示这是一个修改操作，操作的参数为 $l, r$。\r\n* 如果是 $1$ 的话，表示这是一个询问操作，操作的参数为 $l, r$。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"对于每个询问操作，输出一行，包括一个整数表示答案 $\\mathrel{\\mathrm{mod}} p$ 的值。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n4 4 7 2\r\n1 2 3 4\r\n0 1 4\r\n1 2 4\r\n0 1 4\r\n1 1 3\r\n```\r\n\r\n#### 样例输出 1\r\n```plain\r\n0\r\n3\r\n```\r\n\r\n#### 样例输入 2\r\n```plain\r\n1 40 19910626 2\r\n0\r\n0 1 1\r\n1 1 1\r\n0 1 1\r\n1 1 1\r\n0 1 1\r\n1 1 1\r\n0 1 1\r\n1 1 1\r\n0 1 1\r\n1 1 1\r\n0 1 1\r\n1 1 1\r\n0 1 1\r\n1 1 1\r\n0 1 1\r\n1 1 1\r\n0 1 1\r\n1 1 1\r\n0 1 1\r\n1 1 1\r\n0 1 1\r\n1 1 1\r\n0 1 1\r\n1 1 1\r\n0 1 1\r\n1 1 1\r\n0 1 1\r\n1 1 1\r\n0 1 1\r\n1 1 1\r\n0 1 1\r\n1 1 1\r\n0 1 1\r\n1 1 1\r\n0 1 1\r\n1 1 1\r\n0 1 1\r\n1 1 1\r\n0 1 1\r\n1 1 1\r\n```\r\n\r\n#### 样例输出 2\r\n```plain\r\n1\r\n2\r\n4\r\n16\r\n65536\r\n11418102\r\n18325590\r\n13700558\r\n13700558\r\n13700558\r\n13700558\r\n13700558\r\n13700558\r\n13700558\r\n13700558\r\n13700558\r\n13700558\r\n13700558\r\n13700558\r\n13700558\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于 $0\\%$ 的测试点，和样例一模一样；  \r\n对于另外 $10\\%$ 的测试点，没有修改；  \r\n对于另外 $20\\%$ 的测试点，每次修改操作只会修改一个位置（也就是 $l = r$），并且每个位置至多被修改一次；  \r\n对于另外 $10\\%$ 的测试点，$p = 2$；  \r\n对于另外 $10\\%$ 的测试点，$p = 3$；  \r\n对于另外 $10\\%$ 的测试点，$p = 4$；  \r\n对于另外 $20\\%$ 的测试点，$n \\leq 100, m \\leq 100$；  \r\n对于 $100\\%$ 的测试点，$1 \\leq n \\leq 50000, 1 \\leq m \\leq 50000, 1 \\leq p \\leq 100000000, 0 < c < p, 0 \\leq a_i < p$。\r\n\r\n**<del>数据貌似出锅了呢 (#9, #11)…… 有了重制数据之后会第一时间传上来的ﾍ(´ー｀ﾍ)</del>**  \r\n**<del>2017.6.27 更新数据至清华算协 Git 中的版本</del>**  \r\n**2017.7.14 修复数据，若仍有疑问请联系管理员 QuQ**  \r\n**2017.10 受 LOJ 删站事件影响，数据回复至错误版本**  \r\n**2017.11.29 再次修复数据并重测所有提交，若仍有疑问请联系管理员 QaQ**"}]}