{"title":"「CEOI2020」花式围栏","time_limit":1000,"memory_limit":256,"tags":["CEOI","2020","笛卡尔树 / Kruskal 重构树"],"operation":{"submit":"https://loj.ac/problem/3348#submit_code","submissions":"https://loj.ac/submissions?problem_id=3348","statistics":"https://loj.ac/problem/3348/statistics/fastest","testdata":"https://loj.ac/problem/3348/testdata","discussion":"https://loj.ac/discussion/problem/3348"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"**题目译自 [CEOI 2020](http://ceoi2020.inf.elte.hu/contest/tasks/) Day1 T1「[Fancy Fence](http://ceoi2020.inf.elte.hu/wp-content/uploads/2020/09/fancyfence_eng.pdf)」**\r\n\r\n众所周知，Balázs 拥有整个城镇中最漂亮的围栏。围栏由 $N$ 个部分组成，每个部分均为矩形，且相邻的两个部分间均紧密相连。第 $i$ 部分矩形的高度为 $h_i$，宽度为 $w_i$，我们需要找到满足如下条件的花式矩形：\r\n\r\n- 矩形的每条边均是水平的或竖直的，且每条边的长度为整数。\r\n- 矩形与地面的距离为整数。\r\n- 矩形与围栏第一部分的左侧边的距离为整数。\r\n- 矩形完整包含在围栏中。\r\n\r\n现在你需要求出花式矩形的总数。因为这个数字可能很大，请输出其对 $10^9+7$ 取模后的结果。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"输入第一行包含一个整数 $N$，代表围栏由 $N$ 部分组成。\r\n\r\n第二行 $N$ 个整数，第 $i$ 个整数为第 $i$ 个矩形的高度 $h_i$。\r\n\r\n第三行 $N$ 个整数，第 $i$ 个整数为第 $i$ 个矩形的宽度 $w_i$。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出花式矩形数对 $10^9+7$ 取模后的结果。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n2\r\n1 2\r\n1 2\r\n```\r\n\r\n#### 样例输出 1\r\n```plain\r\n12\r\n```\r\n\r\n#### 样例解释 1\r\n\r\n围栏形状如下所示：\r\n\r\n![fence1.png](https://loj-img.upyun.menci.memset0.cn/2020/08/26/5f4654c731249.png)\r\n\r\n形状如下的矩形有 $5$ 个：\r\n\r\n![fence2.png](https://loj-img.upyun.menci.memset0.cn/2020/08/26/5f4654c707382.png)\r\n\r\n形状如下的矩形有 $3$ 个：\r\n\r\n![fence3.png](https://loj-img.upyun.menci.memset0.cn/2020/08/26/5f4654c5dce4a.png)\r\n\r\n形状如下的矩形有 $1$ 个：\r\n\r\n![fence4.png](https://loj-img.upyun.menci.memset0.cn/2020/08/26/5f4654c620fd2.png)\r\n\r\n形状如下的矩形有 $2$ 个：\r\n\r\n![fence5.png](https://loj-img.upyun.menci.memset0.cn/2020/08/26/5f4654c67aa7d.png)\r\n\r\n形状如下的矩形有 $1$ 个：\r\n\r\n![fence6.png](https://loj-img.upyun.menci.memset0.cn/2020/08/26/5f4654c6bdac1.png)\r\n\r\n#### 样例 2\r\n\r\n见附加文件。"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"所有测试点均满足：$1 \\leq N \\leq 10^5$，$1 \\leq h_i,w_i \\leq 10^9$。\r\n\r\n各子任务的约束条件如下：\r\n\r\n| 子任务编号 | 分值 | 约束                                                         |\r\n| :----------: | :----: | :------------------------------------------------------------: |\r\n| $1$        | $0$  | 样例                                                         |\r\n| $2$        | $12$ | $N \\leq 50$，且 $\\forall i \\in [1,N]$，$h_i \\leq 50$ 且 $w_i=1$ |\r\n| $3$        | $13$ | $\\forall i \\in [1,N]$，$h_i=1$ 或 $h_i=2$                    |\r\n| $4$        | $15$ | 所有的 $h_i$ 均相等                                          |\r\n| $5$        | $15 $ | $\\forall i \\in [1,N-1]$，$h_i \\leq h_{i+1}$                  |\r\n| $6$        | $18$ | $N \\leq 1000$                                                |\r\n| $7$        | $27$ | 无特殊约束                                                   |\r\n\r\n"}]}