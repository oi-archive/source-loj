{"title":"「WC2020」选课","time_limit":1000,"memory_limit":512,"tags":["WC","2020","状态压缩","背包 DP","决策单调性","DP"],"operation":{"submit":"https://loj.ac/problem/3331#submit_code","submissions":"https://loj.ac/submissions?problem_id=3331","statistics":"https://loj.ac/problem/3331/statistics/fastest","testdata":"https://loj.ac/problem/3331/testdata","discussion":"https://loj.ac/discussion/problem/3331"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"随着期末考试的结束，一年一度的选课环节又拉开了帷幕。\r\n\r\n小 C 是一个热爱学习的好学生，他给自己定了一个小目标：在新的学期至少修够 $T$ 学分。从教务处给出的公告上看，本次可供选择的课程一共有 $m$ 种分类，第 $i$ 种分类中有 $n_i$ 门课程。小 C 根据公告的内容，提高了自己的学习目标：在所有课程至少修满 $T$ 学分的基础上，第 $i$ 种分类（$i=1,2,\\cdots,m$）至少修够 $s_i$ 的学分。同时，聪明的小 C 凭借自己的经验，计算出了学习每门课程所能得到的学分和所需要消耗的脑力值。不仅如此，他还发现，有些课程之间存在特殊的关系：同时学习某两门内容相似的课程，可能会减少脑力值的消耗；同时学习某两门十分硬核的课，可能会增加脑力值的消耗；某两门课程时间冲突，则无法同时学习。\r\n\r\n小 C 希望能够花费最少的脑力值来达到他的目标。你能帮小 C 计算出达到目标所需要的最小脑力值吗？\r\n"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行两个正整数 $m,T$，表示分类种数和总共需要修够的学分数。\r\n\r\n接下来 $m$ 段输入，对于第 $i$ 段输入：\r\n\r\n第 $1$ 行有两个非负整数 $n_i,s_i$，表示第 $i$ 种分类的所有课程数和需要修够的学分。\r\n\r\n第 $j+1(1\\le j\\le n_i)$ 行有两个正整数 $w_{i,j},c_{i,j}$，表示选修第 $i$ 种分类中的第 $j$ 门课能获得的学分和需要消耗的脑力。\r\n\r\n$m$ 段输入之后，有一个非负整数 $p$，表示关系的条数。\r\n\r\n接下来 $p$ 行每行一条关系，每一条关系可表示为以下 $3$ 种形式之一（以下所有输入数据均为正整数）：\r\n\r\n- $1\\ x_1\\ y_1\\ x_2\\ y_2\\ c$，表示同时修第 $x_1$ 种分类中的第 $y_1$ 门课和第 $x_2$ 种分类中的第 $y_2$ 门课，可以减少 $c$ 的消耗。\r\n\r\n- $2\\ x_1\\ y_1\\ x_2\\ y_2\\ c$，表示同时修第 $x_1$ 种分类中的第 $y_1$ 门课和第 $x_2$ 种分类中的第 $y_2$ 门课，需要增加 $c$ 的消耗。\r\n\r\n- $3\\ x_1\\ y_1\\ x_2\\ y_2$，表示第 $x_1$ 种分类中的第 $y_1$ 门课和第 $x_2$ 种分类中的第 $y_2$ 门课不能同时修。\r\n\r\n"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出文件只有一行，包含一个整数，表示达到目标所需要的最小脑力值。如果无法达到小 C 的目标，请输出 $-1$。\r\n\r\n"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n\r\n```plain\r\n1 10\r\n1 1\r\n1 1\r\n0\r\n```\r\n\r\n#### 样例输出 1\r\n\r\n```plain\r\n-1\r\n```\r\n\r\n#### 样例解释 1\r\n\r\n即使学习所有课程，总学分仍无法达到小 C 的要求，故输出 $-1$。\r\n\r\n#### 样例输入 2\r\n\r\n```plain\r\n3 10\r\n5 4\r\n1 30\r\n1 30\r\n2 3\r\n2 3\r\n3 30\r\n6 6\r\n1 1\r\n1 30\r\n2 1\r\n2 30\r\n3 9\r\n3 10\r\n1 0\r\n1 10\r\n1\r\n1 1 5 2 6 35\r\n```\r\n\r\n#### 样例输出 2\r\n\r\n```plain\r\n10\r\n```\r\n\r\n#### 样例解释 2\r\n\r\n一种可能的选法为：第一种分类中选择第 $4$、$5$ 门课，第二种分类选择第 $1$、$3$、$6$ 门课，第三种分类不选课程（选法不唯一）。\r\n\r\n#### 样例 3\r\n\r\n见附加文件中的 `courses3.in` 与 `courses3.ans`。"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"设 $N=\\sum_{i=1}^{m} n_i$，$M$ 为消耗脑力值的最大值（包括有关系的课程中增加或减少的消耗）。\r\n\r\n对于 $5\\%$ 的数据：$N\\le 5$。\r\n\r\n对于 $10\\%$ 的数据：$N\\le 15$。\r\n\r\n有另外 $10\\%$ 的数据：$N\\le 1000$，$p=0$。\r\n\r\n有另外 $10\\%$ 的数据：$w_i=1$，$p=0$。\r\n\r\n有另外 $10\\%$ 的数据：$T=\\sum_{i=1}^{m} s_i$，$p=0$。\r\n\r\n有另外 $10\\%$ 的数据：$N\\le 10^4$，$M\\le 50$，且有关系的课程在同一分类中。\r\n\r\n有另外 $10\\%$ 的数据：$N\\le 5\\times 10^4$，$M\\le 50$。\r\n\r\n对于 $100\\%$ 的数据：$N\\le 5\\times 10^5$，$M\\le 200$，$\\color{red}{0\\le} T-\\sum_{i=1}^{m} s_i\\le 40$，$m\\le 5\\times 10^4$，$\\color{red} {p \\le 12}$，$w_{i,j}\\in\\{1,2,3\\}$。\r\n\r\n> 修正：官方数据有一个测试点**并没有满足 $0\\le T-\\sum_{i=1}^{m} s_i$ 这一条件**。  \r\n> 记 $P$ 为至少涉及一个限制的课程，那么保证 $P\\le 12, p\\le \\frac{P(P-1)}{2}$。\r\n\r\n数据保证任意两种课程至多只有一种关系。\r\n\r\n"}]}