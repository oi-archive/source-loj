{"title":"「NOI2015」荷马史诗","time_limit":1000,"memory_limit":256,"tags":["2015","NOI","堆","哈夫曼编码","贪心"],"operation":{"submit":"https://loj.ac/problem/2132#submit_code","submissions":"https://loj.ac/submissions?problem_id=2132","statistics":"https://loj.ac/problem/2132/statistics/fastest","testdata":"https://loj.ac/problem/2132/testdata","discussion":"https://loj.ac/discussion/problem/2132"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"> 追逐影子的人，自己就是影子。 ——荷马\r\n\r\nAllison 最近迷上了文学。她喜欢在一个慵懒的午后，细细地品上一杯卡布奇诺，静静地阅读她爱不释手的《荷马史诗》。但是由《奥德赛》和《伊利亚特》组成的鸿篇巨制《荷马史诗》实在是太长了，Allison 想通过一种编码方式使得它变得短一些。\r\n\r\n一部《荷马史诗》中有 $n$ 种不同的单词，从 $1$ 到 $n$ 进行编号。其中第 $i$ 种单词出现的总次数为 $w_i$。Allison 想要用 $k$ 进制串 $s_i$ 来替换第 $i$ 种单词，使得其满足如下要求：\r\n对于任意的 $1 \\leq i,j \\leq n, \\ i \\neq j$，都有：$s_i$ 不是 $s_j$ 的前缀。\r\n\r\n现在 Allison 想要知道，如何选择 $s_i$，才能使替换以后得到的新的《荷马史诗》长度最小。在确保总长度最小的情况下，Allison 还想知道最长的 $s_i$ 的最短长度是多少？\r\n\r\n一些定义：\r\n\r\n一个字符串被称为 $k$ 进制字符串，当且仅当它的每个字符是 $0$ 到 $k−1$ 之间（包括 $0$ 和 $k−1$）的整数。\r\n\r\n字符串 $\\text{Str}_1$ 被称为字符串 $\\text{Str}_2$ 的前缀，当且仅当：存在 $1 \\leq t \\leq m$，使得 $\\text{Str}_1=\\text{Str}_2[1 \\ldots t]$。其中，$m$ 是字符串 $\\text{Str}_2$ 的长度，$\\text{Str}_2[1 \\ldots t]$ 表示 $\\text{Str}_2$ 的前 $t$ 个字符组成的字符串。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"输入文件的第一行包含两个正整数 $n,k$，中间用单个空格隔开，表示共有 $n$ 种单词，需要使用 $k$ 进制字符串进行替换。\r\n\r\n接下来 $n$ 行，第 $i+1$ 行包含 $1$ 个非负整数 $w_i$，表示第 $i$ 种单词的出现次数。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出文件包括两行。\r\n\r\n第一行输出一个整数，为《荷马史诗》经过重新编码以后的最短长度。\r\n\r\n第二行输出一个整数，为保证最短总长度的情况下，最长字符串 $s_i$ 的最短长度。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n4 2\r\n1\r\n1\r\n2\r\n2\r\n```\r\n\r\n#### 样例输出 1\r\n```plain\r\n12\r\n2\r\n```\r\n\r\n#### 样例解释 1\r\n用 $X_{(k)}$ 表示 $X$ 是以 $k$ 进制表示的字符串。\r\n\r\n一种最优方案：令 $00_{(2)}$ 替换第一种单词，$01_{(2)}$ 替换第二种单词，$10_{(2)}$ 替换第三种单词，$11_{(2)}$ 替换第四种单词。在这种方案下，编码以后的最短长度为：$1 \\times 2+1 \\times 2+2 \\times 2+2 \\times 2=12$，最长字符串 $s_i$ 的长度为 $2$。\r\n\r\n一种非最优方案：令 $000_{(2)}$ 替换第一种单词，$001_{(2)}$ 替换第二种单词，$01_{(2)}$ 替换第三种单词，$1_{(2)}$ 替换第四种单词。在这种方案下，编码以后的最短长度为：$1 \\times 3+1 \\times 3+2 \\times 2+2 \\times 1=12$，最长字符串 $s_i$ 的长度为 $3$。与最优方案相比，文章的长度相同，但是最长字符串的长度更长一些。\r\n\r\n#### 样例输入 2\r\n```plain\r\n6 3\r\n1\r\n1\r\n3\r\n3\r\n9\r\n9\r\n```\r\n\r\n#### 样例输出 2\r\n```plain\r\n36\r\n3\r\n```\r\n\r\n#### 样例解释 2\r\n一种最优方案：令 $000_{(3)}$ 替换第 $1$ 种单词，$001_{(3)}$ 替换第 $2$ 种单词，$01_{(3)}$ 替换第 $3$ 种单词，$02_{(3)}$ 替换第 $4$ 种单词，$1_{(3)}$ 替换第 $5$ 种单词，$2_{(3)}$ 替换第 $6$ 种单词。"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"<!-- BEGIN: Migrated markdown table -->\r\n#### 限制与约定\r\n\r\n| Case # | $n$ 的规模 | $k$ 的规模 | 附加限制 |\r\n|:-:|:-:|:-:|:-:|\r\n| 1 | $n = 3$ | $k = 2$ | - |\r\n| 2 | $n = 5$ | $k = 2$ | - |\r\n| 3 | $n = 16$ | $k = 2$ | 所有 $w_i$ 均相等 |\r\n| 4 | $n = 1000$ | $k = 2$ | $w_i$ 在取值范围内均匀随机 |\r\n| 5 | $n = 1000$ | $k = 2$ | - |\r\n| 6 | $n = 100000$ | $k = 2$ | - |\r\n| 7 | $n = 100000$ | $k = 2$ | 所有 $w_i$ 均相等 |\r\n| 8 | $n = 100000$ | $k = 2$ | - |\r\n| 9 | $n = 7$ | $k = 3$ | - |\r\n| 10 | $n = 16$ | $k = 3$ | 所有 $w_i$ 均相等 |\r\n| 11 | $n = 1001$ | $k = 3$ | 所有 $w_i$ 均相等 |\r\n| 12 | $n = 99999$ | $k = 4$ | 所有 $w_i$ 均相等 |\r\n| 13 | $n = 100000$ | $k = 4$ | - |\r\n| 14 | $n = 100000$ | $k = 4$ | - |\r\n| 15 | $n = 1000$ | $k = 5$ | - |\r\n| 16 | $n = 100000$ | $k = 7$ | $w_i$ 在取值范围内均匀随机 |\r\n| 17 | $n = 100000$ | $k = 7$ | - |\r\n| 18 | $n = 100000$ | $k = 8$ | $w_i$ 在取值范围内均匀随机 |\r\n| 19 | $n = 100000$ | $k = 9$ | - |\r\n| 20 | $n = 100000$ | $k = 9$ | - |\r\n\r\n<!-- Migrated from original HTML table:\r\n<table class=\"ui table\">\r\n    <thead>\r\n        <tr>\r\n            <th style='text-align: center'>Case #</th>\r\n            <th style='text-align: center'> $n$ 的规模</th>\r\n            <th style='text-align: center'> $k$ 的规模</th>\r\n            <th style='text-align: center'>附加限制</th>\r\n        </tr>\r\n    </thead>\r\n    <tbody>\r\n        <tr>\r\n            <td style='text-align: center'>1</td>\r\n            <td style='text-align: center'> $n = 3$ </td>\r\n            <td style='text-align: center'> $k = 2$ </td>\r\n            <td style='text-align: center'> - </td>\r\n        </tr>\r\n        <tr>\r\n            <td style='text-align: center'>2</td>\r\n            <td style='text-align: center'> $n = 5$ </td>\r\n            <td style='text-align: center'> $k = 2$ </td>\r\n            <td style='text-align: center'> - </td>\r\n        </tr>\r\n        <tr>\r\n            <td style='text-align: center'>3</td>\r\n            <td style='text-align: center'> $n = 16$ </td>\r\n            <td style='text-align: center'> $k = 2$ </td>\r\n            <td style='text-align: center'>所有 $w_i$ 均相等</td>\r\n        </tr>\r\n        <tr>\r\n            <td style='text-align: center'>4</td>\r\n            <td style='text-align: center'> $n = 1000$ </td>\r\n            <td style='text-align: center'> $k = 2$ </td>\r\n            <td style='text-align: center'> $w_i$ 在取值范围内均匀随机</td>\r\n        </tr>\r\n        <tr>\r\n            <td style='text-align: center'>5</td>\r\n            <td style='text-align: center'> $n = 1000$ </td>\r\n            <td style='text-align: center'> $k = 2$ </td>\r\n            <td style='text-align: center'> - </td>\r\n        </tr>\r\n        <tr>\r\n            <td style='text-align: center'>6</td>\r\n            <td style='text-align: center'> $n = 100000$ </td>\r\n            <td style='text-align: center'> $k = 2$ </td>\r\n            <td style='text-align: center'> - </td>\r\n        </tr>\r\n        <tr>\r\n            <td style='text-align: center'>7</td>\r\n            <td style='text-align: center'> $n = 100000$ </td>\r\n            <td style='text-align: center'> $k = 2$ </td>\r\n            <td style='text-align: center'>所有 $w_i$ 均相等</td>\r\n        </tr>\r\n        <tr>\r\n            <td style='text-align: center'>8</td>\r\n            <td style='text-align: center'> $n = 100000$ </td>\r\n            <td style='text-align: center'> $k = 2$ </td>\r\n            <td style='text-align: center'> - </td>\r\n        </tr>\r\n        <tr>\r\n            <td style='text-align: center'>9</td>\r\n            <td style='text-align: center'> $n = 7$ </td>\r\n            <td style='text-align: center'> $k = 3$ </td>\r\n            <td style='text-align: center'> - </td>\r\n        </tr>\r\n        <tr>\r\n            <td style='text-align: center'>10</td>\r\n            <td style='text-align: center'> $n = 16$ </td>\r\n            <td style='text-align: center'> $k = 3$ </td>\r\n            <td style='text-align: center'>所有 $w_i$ 均相等</td>\r\n        </tr>\r\n        <tr>\r\n            <td style='text-align: center'>11</td>\r\n            <td style='text-align: center'> $n = 1001$ </td>\r\n            <td style='text-align: center'> $k = 3$ </td>\r\n            <td style='text-align: center'>所有 $w_i$ 均相等</td>\r\n        </tr>\r\n        <tr>\r\n            <td style='text-align: center'>12</td>\r\n            <td style='text-align: center'> $n = 99999$ </td>\r\n            <td style='text-align: center'> $k = 4$ </td>\r\n            <td style='text-align: center'>所有 $w_i$ 均相等</td>\r\n        </tr>\r\n        <tr>\r\n            <td style='text-align: center'>13</td>\r\n            <td style='text-align: center'> $n = 100000$ </td>\r\n            <td style='text-align: center'> $k = 4$ </td>\r\n            <td style='text-align: center'> - </td>\r\n        </tr>\r\n        <tr>\r\n            <td style='text-align: center'>14</td>\r\n            <td style='text-align: center'> $n = 100000$ </td>\r\n            <td style='text-align: center'> $k = 4$ </td>\r\n            <td style='text-align: center'> - </td>\r\n        </tr>\r\n        <tr>\r\n            <td style='text-align: center'>15</td>\r\n            <td style='text-align: center'> $n = 1000$ </td>\r\n            <td style='text-align: center'> $k = 5$ </td>\r\n            <td style='text-align: center'> - </td>\r\n        </tr>\r\n        <tr>\r\n            <td style='text-align: center'>16</td>\r\n            <td style='text-align: center'> $n = 100000$ </td>\r\n            <td style='text-align: center'> $k = 7$ </td>\r\n            <td style='text-align: center'> $w_i$ 在取值范围内均匀随机</td>\r\n        </tr>\r\n        <tr>\r\n            <td style='text-align: center'>17</td>\r\n            <td style='text-align: center'> $n = 100000$ </td>\r\n            <td style='text-align: center'> $k = 7$ </td>\r\n            <td style='text-align: center'> - </td>\r\n        </tr>\r\n        <tr>\r\n            <td style='text-align: center'>18</td>\r\n            <td style='text-align: center'> $n = 100000$ </td>\r\n            <td style='text-align: center'> $k = 8$ </td>\r\n            <td style='text-align: center'> $w_i$ 在取值范围内均匀随机</td>\r\n        </tr>\r\n        <tr>\r\n            <td style='text-align: center'>19</td>\r\n            <td style='text-align: center'> $n = 100000$ </td>\r\n            <td style='text-align: center'> $k = 9$ </td>\r\n            <td style='text-align: center'> - </td>\r\n        </tr>\r\n        <tr>\r\n            <td style='text-align: center'>20</td>\r\n            <td style='text-align: center'> $n = 100000$ </td>\r\n            <td style='text-align: center'> $k = 9$ </td>\r\n            <td style='text-align: center'> - </td>\r\n        </tr>\r\n    </tbody>\r\n</table>\r\n-->\r\n\r\n<!-- END: Migrated markdown table -->\r\n\r\n对于所有数据，保证 $2 \\leq n \\leq 100000, \\ 2 \\leq k \\leq 9, \\ 0 \\lt w_i \\leq 10^{11}$。选手请注意使用 $64$ 位整数进行输入输出、存储和计算。\r\n\r\n#### 评分方式\r\n对于每个测试点：  \r\n若输出文件的第 $1$ 行正确，得到该测试点 $40\\%$ 的分数；  \r\n若输出文件完全正确，得到该测试点 $100\\%$ 的分数。"}]}