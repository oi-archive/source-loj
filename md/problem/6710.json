{"title":"「RCOI2019」维护","time_limit":1000,"memory_limit":256,"tags":["Link-Cut Tree"],"operation":{"submit":"https://loj.ac/problem/6710#submit_code","submissions":"https://loj.ac/submissions?problem_id=6710","statistics":"https://loj.ac/problem/6710/statistics/fastest","testdata":"https://loj.ac/problem/6710/testdata","discussion":"https://loj.ac/discussion/problem/6710"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"**题目来源：[「RCOI2019」Rochine Round 1](https://www.luogu.com.cn/contest/20511)**\r\n\r\n维护一颗以 $1$ 为根的树的形态，要求支持插入叶子节点、删除任意结点以及查询 $k$ 代祖先。为了尽量简单，删除时，直接让这个点的儿子替代它就好（即，全部接到父节点上）。初始时，树仅有根节点 $1$。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行两个整数 $q$ 和 $\\text{online}$。$q$ 表示操作数，$\\text{online}=1$ 说明本测试点强制在线。\r\n\r\n**请认真阅读下面的输入格式，稍有不慎即会 WA**。\r\n\r\n**对于三种操作， 若询问的 $x$ 已经被删除或 $x$ 大于节点总数或 $x=0$，则 $\\text{lastans}$ 也不要更新。**\r\n\r\n接下来 $q$ 行，分为三种情况（$\\text{lastans}$ 初值为 $0$）：\r\n\r\n- 插入操作，格式为 `1 x`：\r\n   - 首先，执行 $x\\leftarrow x\\ \\mathrm{xor}\\ \\text{lastans}$；  \r\n   - 然后，增加一个编号为已经加入过的结点总数 $+1$ 的节点作为 $x$ 的儿子。  \r\n   - 若 $\\text{online}=1$，则 $\\text{lastans}$ 更新为 $x$，若 $x$ 已经被删除则不应新增任何节点。  \r\n\r\n\r\n- 删除操作，格式为 `2 x`：\r\n   - 首先，执行 $x\\leftarrow x\\ \\mathrm{xor}\\ \\text{lastans}$；  \r\n   - 然后删除 $x$，若不存在请忽略。  \r\n   - 若 $\\text{online}=1$，则 $\\text{lastans}$ 更新为 $x$ 的父亲，保证 $x\\ne 1$。  \r\n\r\n\r\n- 查询操作，格式为 `3 x y`：\r\n   - 首先，执行 $x\\leftarrow x\\ \\mathrm{xor}\\ \\text{lastans}$，$y\\leftarrow y\\ \\mathrm{xor}\\ \\text{lastans}$；  \r\n   - 然后输出 $x$ 的 $y$ 代祖先。  \r\n   - 若 $\\text{online}=1$，则 $\\text{lastans}$ 更新为答案，若 $x$ 被删除了则什么都不要输出，若不存在则答案为 $0$。\r\n\r\n"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出一些行，每行一个整数，表示询问的答案。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n\r\n```plain\r\n8 0\r\n1 1\r\n1 2\r\n1 3\r\n3 4 2\r\n2 3\r\n3 4 2\r\n2 2\r\n3 4 2\r\n```\r\n\r\n#### 样例输出 1\r\n\r\n```plain\r\n2\r\n1\r\n0\r\n```\r\n\r\n#### 样例输入 2\r\n\r\n```plain\r\n4 0\r\n1 1\r\n2 2\r\n3 2 0\r\n3 1 0\r\n```\r\n\r\n#### 样例输出 2\r\n\r\n```plain\r\n1\r\n```\r\n\r\n#### 样例输入 3\r\n\r\n```plain\r\n20 1\r\n1 1\r\n1 3\r\n1 1\r\n3 7 1\r\n3 6 1\r\n3 5 3\r\n1 6\r\n1 1\r\n1 1\r\n1 3\r\n3 15 1\r\n3 8 3\r\n3 11 2\r\n1 1\r\n1 14\r\n1 0\r\n1 3\r\n3 7 10\r\n3 7 8\r\n3 11 5\r\n```\r\n\r\n#### 样例输出 3\r\n\r\n```plain\r\n2\r\n1\r\n2\r\n0\r\n3\r\n7\r\n11\r\n7\r\n8\r\n```\r\n"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于所有数据，$1\\le q\\le 2\\times 10^5,\\text{online}\\in\\{0,1\\}$。详细数据范围如下。\r\n\r\n| 测试点编号  |      $q$       | $\\text{online}$ |   特殊性质   | 每测试点分数 |\r\n| :---------: | :------------: | :-------------: | :----------: | :----------: |\r\n|  $1\\sim 3$  |      $20$      |       $1$       | 数据随机生成 |     $3$      |\r\n|    $4,5$    |      $20$      |       $0$       | 数据随机生成 |     $3$      |\r\n|  $6\\sim 8$  |     $200$      |       $1$       | 数据随机生成 |     $3$      |\r\n|   $9,10$    |     $200$      |       $0$       | 数据随机生成 |     $3$      |\r\n|   $11,12$   | $2\\times 10^4$ |       $1$       | 数据随机生成 |     $3$      |\r\n| $13\\sim 15$ | $2\\times 10^4$ |       $0$       | 数据随机生成 |     $3$      |\r\n| $16\\sim 19$ | $2\\times 10^5$ |       $0$       |      无      |     $4$      |\r\n|    $20$     | $2\\times 10^5$ |       $1$       |  无删除操作  |     $9$      |\r\n| $21\\sim 25$ | $2\\times 10^5$ |       $1$       |      无      |     $6$      |\r\n\r\n对于 $q\\le 2\\times 10^4$ 的测试点，按点计分；其他测试点，按特殊性质对应 Subtask **捆绑计分**。"}]}