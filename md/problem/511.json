{"title":"「LibreOJ NOI Round #1」验题","time_limit":10000,"memory_limit":1024,"tags":["原创","LibreOJ NOI Round","线段树","树链剖分","树形 DP","数据结构","DP"],"operation":{"submit":"https://loj.ac/problem/511#submit_code","submissions":"https://loj.ac/submissions?problem_id=511","statistics":"https://loj.ac/problem/511/statistics/fastest","testdata":"https://loj.ac/problem/511/testdata","discussion":"https://loj.ac/discussion/problem/511"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"可爱的 WrongAnswer 非常喜欢独立集问题。在 CTSC2017 的论文答辩中，他就准备了一篇关于独立集的论文。\r\n\r\n一天，他打算用这篇论文来出题。于是他想出了这样一道题：\r\n\r\n> 给出一棵 $n$ 个点的树 $T=(V,E)$ 和一个独立集 $I$，求出字典序比 $I$ 恰好大 $k$ 的那个独立集。\r\n\r\n请参加 NOI 的您帮他验题。以下是一些可能会用到的定义：\r\n\r\n> 一个独立集 $I$ 是点集 $V$ 的一个子集，满足 $I$ 中任意两个点在 $T$ 中不相邻，即不存在 $x,y\\in I$ 使得 $(x, y)\\in E$ 或 $(y, x)\\in E$。\r\n\r\n> 定义两个点集 $A$、$B$ 的字典序比较关系：设 $A$ 中的点按编号从小到大排序后是 $a_1,a_2,...,a_{|A|}$，$B$ 中的点按编号从小到大排序后是 $b_1,b_2,...,b_{|B|}$，那么定义 $A$ 和 $B$ 的字典序比较结果等于 $\\{a_i\\}$ 和 $\\{b_i\\}$ 的字典序比较结果。\r\n\r\n将 $T$ 的所有独立集按上述定义的字典序排序，如果 $I$ 是其中排名第 $x$ 的独立集，那么你需要求出的是排名第 $x+k$ 的独立集。如果不存在这个独立集，则输出空集。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行一个整数 $n$；\r\n\r\n第二行一个整数 $k$；\r\n\r\n第三行 $n-1$ 个整数 $x_1,x_2,...,x_{n-1}$，表示树上每条边的第一个端点（从 $0$ 开始编号，下同）；\r\n\r\n第四行 $n-1$ 个整数 $y_1,y_2,...,y_{n-1}$，表示树上每条边的第二个端点；\r\n\r\n第五行一个整数 $|I|$；\r\n\r\n第六行 $|I|$ 个整数 $I_1,I_2,...,I_{|I|}$，表示 $I$ 中的每一个节点，保证 $I$ 是一个合法的独立集。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"设你求出的独立集为 $S$（如果不存在满足要求的集合 $S$，则令 $S=\\varnothing$），则你需要输出一行 $|S|$ 个数，按照从小到大的顺序输出 $S$ 中的每一个节点（从 $0$ 开始编号）。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n```plain\r\n10\r\n4\r\n0 1 1 1 1 4 0 7 0\r\n1 2 3 4 5 6 7 8 9\r\n3\r\n5 8 9\r\n```\r\n\r\n#### 样例输出\r\n```plain\r\n6 7 9\r\n```\r\n\r\n#### 更多样例\r\n见附加文件或[备用网盘链接](https://pan.baidu.com/s/1bo2ydeJ)（提取码：`q5bs`）"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"由于众所周知的原因，本题采用子任务制。每个子任务的情况如下表：\r\n\r\n| Subtask #    | 分值   | $n$        | $k$           | 特殊限制 |\r\n| :----: | :----: | :----------: | :-------------: | :--------: |\r\n| 1    | $6$  | $\\le 20$   | $\\le 10^{18}$ | 无特殊限制    |\r\n| 2    | $17$ | $\\le 2000$ | $\\le 10000$   | 无特殊限制    |\r\n| 3    | $21$ | $\\le 2000$ | $\\le 10^{18}$ | 无特殊限制    |\r\n| 4    | $27$ | $\\le 10^6$ | $\\le 10^{18}$ | 树是一条链    |\r\n| 5    | $29$ | $\\le 10^6$ | $\\le 10^{18}$ | 无特殊限制    |"}]}