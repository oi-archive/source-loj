{"title":"「JOISC 2017 Day 3」长途巴士","time_limit":2000,"memory_limit":256,"tags":["2017","JOISC","子任务"],"operation":{"submit":"https://loj.ac/problem/2396#submit_code","submissions":"https://loj.ac/submissions?problem_id=2396","statistics":"https://loj.ac/problem/2396/statistics/fastest","testdata":"https://loj.ac/problem/2396/testdata","discussion":"https://loj.ac/discussion/problem/2396"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"**题目译自 [JOISC 2017](https://www.ioi-jp.org/camp/2017/2017-sp-tasks/index.html) Day3 T1「[長距離バス](https://www.ioi-jp.org/camp/2017/2017-sp-tasks/2017-sp-d3.pdf) / [Long Distance Coach](https://www.ioi-jp.org/camp/2017/2017-sp-tasks/2017-sp-d3-en.pdf)」**\r\n\r\n某长途巴士发车时刻为 $0$，到达终点的时刻为 $X$。车上装有饮水机，乘客和司机可以在车上装水喝。  \r\n途中有 $N$ 个服务站，依次编号为 $1\\ldots N$。巴士到达服务站 $i(1\\le i\\le N)$ 的时间是 $S_i$。  \r\n发车前，水箱是空的。在发车前你可以给饮水机加水，在服务站时也可以给饮水机加水，但是都要钱，水价为每升 $W$ 円。假设水箱容量无限。  \r\n\r\n本次巴士有 $M$ 名乘客（不含司机），乘客均在起点上车，不会中途下车。乘客 $j(1\\le j\\le M)$ 在时刻 $kT+D_j(k=0,1,2,\\ldots)$ 需要装 $1$ 升水，在其他时刻不装水。保证 $1≤ D_j < T$。  \r\n司机在时刻 $kT(k=0,1,2,\\ldots)$ 需要装 $1$ 升水，在其他时刻不装水。如果到终点之前，某一名乘客想装水时饮水机没水了，这名乘客会怒而下车，此时需要向这名乘客退 $C_j$ 円。如果到终点之前，司机想装水时没水了，司机会怒而下车，这车就不开了。  \r\n**保证不会出现两人在同一时刻需要装水的情况。保证在服务站或是到达终点时，不存在司机或乘客需要喝水。**\r\n\r\n我们希望花销（买水的总费用与退的所有车费之和）尽可能小，并且把车开到终点。试求至少需要花销多少円。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行有五个整数 $X, N, M, W, T$。  \r\n在接下来的 $N$ 行中，第 $i$ 行有一个整数 $S_i$。\r\n在接下来的 $M$ 行中，第 $j$ 行有两个整数 $D_j, C_j$。\r\n"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"一行，一个整数，表示最少的花销。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n19 1 4 8 7\r\n10\r\n1 20\r\n2 10\r\n4 5\r\n6 5\r\n```\r\n\r\n#### 样例输出 1\r\n```plain\r\n103\r\n```\r\n\r\n#### 样例解释 1\r\n* 出发时装了 $7$ 升水；\r\n* 在时刻 $0, 1, 2, 4, 6$，司机与乘客 $1, 2, 3, 4$ 先后装水，饮水机剩 $2$ 升水；\r\n* 在时刻 $7,8$，司机和乘客 $1$ 先后装水，饮水机没水了；\r\n* 在时刻 $9$，乘客 $2$ 需要装水，但是饮水机没水了，因此乘客 $2$ 下车，需要向其退款；\r\n* 在时刻 $10$，车到了服务站，向饮水机加 $4$ 升水，此时饮水机剩余 $4$ 升水；\r\n* 在时刻 $11,13,14,15$，乘客 $3,4$，司机和乘客 $1$ 先后装水，饮水机没水了；\r\n* 在时刻 $18$，乘客 $3$ 需要装水，但是饮水机没水了，因此乘客 $3$ 下车，需要向其退款；\r\n* 在时刻 $19$，车到达终点，总计花销为 $8\\times(7+4)+(10+5)=103$，可以证明这是最小花销。\r\n\r\n#### 样例输入 2\r\n```plain\r\n105 3 5 9 10\r\n59\r\n68\r\n71\r\n4 71\r\n6 32\r\n7 29\r\n3 62\r\n2 35\r\n```\r\n\r\n#### 样例输出 2\r\n```plain\r\n547\r\n```\r\n\r\n#### 样例输入 3\r\n```plain\r\n1000000000000 1 1 1000000 6\r\n999999259244\r\n1 123456789\r\n```\r\n\r\n#### 样例输出 3\r\n```plain\r\n333333209997456789\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于所有数据，$1\\le T\\le X\\le 10^{12}, 1\\le N, M \\le 2\\times 10^5,$ $1\\le W\\le 10^6,$ $1\\le S_i< X(1\\le i\\le N),$ $1\\le D_j < T, $ $1\\le C_j\\le 10^9(1\\le j\\le M)$。保证 $D_j$ 两两不同。\r\n\r\n|子任务|分值|$N,M$|\r\n|-|-|-|\r\n|1|16|$N,M\\le 8$|\r\n|2|30|$N,M\\le 100$|\r\n|3|25|$N,M\\le 2000$|\r\n|4|29|$N,M\\le 2\\times 10^5$|"}]}