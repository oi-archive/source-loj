{"title":"「CodePlus 2017 11 月赛」找爸爸","time_limit":1000,"memory_limit":512,"tags":["CodePlus"],"operation":{"submit":"https://loj.ac/problem/6250#submit_code","submissions":"https://loj.ac/submissions?problem_id=6250","statistics":"https://loj.ac/problem/6250/statistics/fastest","testdata":"https://loj.ac/problem/6250/testdata","discussion":"https://loj.ac/discussion/problem/6250"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"小 A 最近一直在找自己的爸爸，用什么办法呢，就是 DNA 比对。\r\n\r\n小 A 有一套自己的 DNA 序列比较方法，其最终目标是最大化两个 DNA 序列的相似程度，具体步骤如下：\r\n\r\n1. 给出两个 DNA 序列，第一个长度为 $n$，第二个长度为 $m$。\r\n2. 在两个序列的任意位置插入任意多的空格，使得两个字符串长度相同。\r\n3. 逐位进行匹配，**如果两个序列相同位置上的字符都不是空格**，假设第一个是 $x$，第二个是 $y$，那么他们的相似程度由 $d(x,y)$ 定义。对于两个序列中任意一段极长连续空格，设其长度为 $k$，我们定义这段空格的相似程度为 $g(k)=-A-B\\times (k-1)$，其中 $A,B$ 均为正整数。\r\n\r\n那么最终两个序列的相似程度就是所有的 $d(x,y)$ 加上所有的极长空格段的相似程度之和。\r\n\r\n现在小 A 通过某种奥妙重重的方式得到了小 B 的 DNA 序列中的一段，他想请你帮他算一下小 A 的 DNA 序列和小 B 的 DNA 序列的最大相似程度。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"输入第 $1$ 行一个字符串，表示小 A 的 DNA 序列。\r\n\r\n输入第 $2$ 行一个字符串，表示小 B 的 DNA 序列。\r\n\r\n接下来 $4$ 行，每行 $4$ 个整数，用空格隔开，表示 $d$ 数组，具体顺序如下所示。\r\n\r\n> $d(A,A)$　$d(A,T)$　$d(A,G)$　$d(A,C)$  \r\n> $d(T,A)$　$d(T,T)$　$d(T,G)$　$d(T,C)$  \r\n> $d(G,A)$　$d(G,T)$　$d(G,G)$　$d(G,C)$  \r\n> $d(C,A)$　$d(C,T)$　$d(C,G)$　$d(C,C)$\r\n\r\n最后一行两个用空格隔开的正整数 $A,B$，意义如题中所述。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出共一行，表示两个序列的最大相似程度。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n```plain\r\nATGG\r\nATCC\r\n5 -4 -4 -4\r\n-4 5 -4 -4\r\n-4 -4 5 -4\r\n-4 -4 -4 5\r\n2 1\r\n```\r\n\r\n#### 样例输出\r\n```plain\r\n4\r\n```\r\n\r\n#### 样例解释\r\n\r\n首先，将序列补成如下形式（`-` 代表空格）\r\n\r\n```plain\r\nATGG--\r\nAT--CC\r\n```\r\n\r\n然后所有 $d(x,y)$ 的和为 $d(A,A)+d(T,T)=10$，所有极长连续空格段的相似程度之和为 $g(2)+g(2)=-6$。总和为 $4$，可以验证，这是相似程度最大的情况。"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于所有测试点，有 $0< B<A \\le 1000, -1000\\le d(x,y)\\le 1000,d(x,y)=d(y,x)$，序列只包含 $\\{\\text{A},\\text{T},\\text{G},\\text{C}\\}$ 四种字符。\r\n\r\n<!-- BEGIN: Migrated markdown table -->\n\n| 测试点编号 | $n + m$ 的范围 | 特殊约定 |\n|-|-|-|\n| 1 | $n = m = 1$ | 无特殊要求 |\n| 2 | $n + m \\leq 15$ | 无特殊要求 |\n| 3 | $n + m \\leq 300$ | 无特殊要求 |\n| 4 | $n + m \\leq 300$ | 无特殊要求 |\n| 5 | $n + m \\leq 3000$ | 序列中只包含一种字符 |\n| 6 | $n + m \\leq 3000$ | 无特殊要求 |\n| 7 | $n + m \\leq 3000$ | 无特殊要求 |\n| 8 | $n + m \\leq 3000$ | 无特殊要求 |\n| 9 | $n + m \\leq 3000$ | 无特殊要求 |\n| 10 | $n + m \\leq 3000$ | 无特殊要求 |\n\n<!-- Migrated from original HTML table:\n<table class='ui center aligned celled table'>\r\n<thead>\r\n  <tr>\r\n    <th>测试点编号</th>\r\n    <th>$n + m$ 的范围</th>\r\n    <th>特殊约定</th>\r\n  </tr>\r\n</thead>\r\n<tbody>\r\n  <tr>\r\n    <td>1</td>\r\n    <td>$n = m = 1$ </td>\r\n    <td rowspan='4'>无特殊要求</td>\r\n  </tr>\r\n  <tr>\r\n    <td>2</td>\r\n    <td>$n + m \\leq 15$ </td>\r\n  </tr>\r\n  <tr>\r\n    <td>3</td>\r\n    <td rowspan='2'>$n + m \\leq 300$ </td>\r\n  </tr>\r\n  <tr>\r\n    <td>4</td>\r\n  </tr>\r\n  <tr>\r\n    <td>5</td>\r\n    <td rowspan='6'>$n + m \\leq 3000$ </td>\r\n    <td>序列中只包含一种字符</td>\r\n  </tr>\r\n  <tr>\r\n    <td>6</td>\r\n    <td rowspan='5'>无特殊要求</td>\r\n  </tr>\r\n  <tr>\r\n    <td>7</td>\r\n  </tr>\r\n  <tr>\r\n    <td>8</td>\r\n  </tr>\r\n  <tr>\r\n    <td>9</td>\r\n  </tr>\r\n  <tr>\r\n    <td>10</td>\r\n  </tr>\r\n</tbody>\r\n</table>\n-->\n\n<!-- END: Migrated markdown table -->\r\n\r\n<hr style='color: #ddd; margin-bottom: 1em'>\r\n\r\n来自 CodePlus 2017 11 月赛，清华大学计算机科学与技术系学生算法与竞赛协会 荣誉出品。  \r\nCredit：idea/邢健开　命题/邢健开　验题/陈宇  \r\nGit Repo：https://git.thusaac.org/publish/CodePlus201711  \r\n感谢腾讯公司对此次比赛的支持。"}]}