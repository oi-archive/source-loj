{"title":"「IOI2019」矩形区域","time_limit":5000,"memory_limit":1024,"tags":["IOI","2019"],"operation":{"submit":"https://loj.ac/problem/3177#submit_code","submissions":"https://loj.ac/submissions?problem_id=3177","statistics":"https://loj.ac/problem/3177/statistics/fastest","testdata":"https://loj.ac/problem/3177/testdata","discussion":"https://loj.ac/discussion/problem/3177"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"<!--\r\n**本题以传统题方式测评。**\r\n\r\n有一个由正方形单元格组成的 $n \\times m$ 网格，行从 $0$ 到 $n-1$ 编号，列从 $0$ 到 $m-1$ 编号。第 $i$ 行第 $j$ 列的单元格记为 $(i, j)$，其海拔高度记为 $a_{i,j}$。\r\n\r\n现在，选定 $4$ 个整数 $r_1, r_2, c_1$ 和 $c_2$ ($1 \\le r_1 \\le r_2 \\le n - 2, 1 \\le c_1 \\le c_2 \\le m - 2$），表示包括所有满足 $r_1 \\le i \\le r_2, c_1 \\le i \\le c_2$ 的单元格 $(i,j)$ 的矩形区域。若满足以下条件，这个区域被认为是合法的：对于该区域中的每个单元格 $(i, j)$，都有 $a_{i, j}$ 严格小于 $a_{i, c_1 - 1}, a_{i, c_2 + 1},  a_{r_1 -1, j}, a_{r_2 +1, j}$。\r\n\r\n请求出合法的区域数量。\r\n-->\r\n\r\n19 世纪初，统治者下令在俯瞰美丽河景的高原上建造一座宫殿。这块高原被看做是一个由正方形单元格组成的 $n \\times m$ 网格。网格的行从 $0$ 到 $n-1$ 编号，列从 $0$ 到 $m-1$ 编号。第 $i$ 行第 $j$ 列（$0 \\le i \\le n - 1, 0 \\le j \\le m - 1$）的单元格记为单元格 $(i, j)$。每个单元格 $(i, j)$ 有特定的海拔高度，记为 $a[i][j]$。\r\n\r\n统治者指示他的建筑师选择一个矩形区域来建造宫殿。该区域不能包含网格边界（第 $0$ 行，第 $n-1$ 行，第 $0$ 列，以及第 $m-1$ 列）上的任何单元格。为此，建筑师应选出四个整数 $r_1$，$r_2$，$c_1$ 和 $c_2$（$1 \\le r_1 \\le r_2 \\le n - 2$ 且 $1 \\le c_1 \\le c_2 \\le m - 2$，对应于包括所有满足 $r_1 \\le i \\le r_2$ 且 $c_1 \\le j \\le c_2$ 的单元格 $(i, j)$ 的矩形区域。\r\n\r\n此外，一个区域被认为是**合法**的，当且仅当对于该区域中的每个单元格 $(i, j)$，以下条件成立：对于与该区域相邻的、位于第 $i$ 行的两个单元格（单元格 $(i, c_1-1)$ 和 $(i, c_2+1)$），以及与该区域相邻的、位于第 $j$ 列的两个单元格（单元格 $(r_1-1, j)$ 和 $(r_2+1, j)$），单元格 $(i, j)$ 的海拔高度必须严格小于这四个单元格的海拔高度。\r\n\r\n你的任务是帮助建筑师统计可建宫殿的合法区域的数量（也就是所对应区域为合法的 $r_1, r_2, c_1$ 和 $c_2$ 的数量）。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"<!--\r\n第一行，两个整数 $n$ 和 $m$。  \r\n接下来 $n$ 行，每行 $m$ 个整数。第 $i+1$ 行第 $j$ 个数表示 $a_{i - 1, j -1}$。\r\n-->\r\n第一行，两个整数 $n$ 和 $m$，表示网格的长和宽。  \r\n第 $i+2$ 行（$0 \\le i \\le n-1$）：$m$ 个整数，为 $a[i][0], a[i][1], \\cdots, a[i][m - 1]$。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"一行，一个整数，表示合法区域的数量。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n```plain\r\n6 5\r\n4 8 7 5 6\r\n7 4 10 3 5\r\n9 7 20 14 2\r\n9 14 7 3 6\r\n5 7 5 2 7\r\n4 5 13 5 6\r\n```\r\n\r\n#### 样例输出\r\n```plain\r\n6\r\n```\r\n\r\n#### 样例解释\r\n\r\n![](https://loj-img.upyun.menci.memset0.cn/2019/08/09/5d4d529d7be55.jpg)\r\n<!--\r\n$6$ 个合法区域的 $(r_1, r_2, c_1, c_2)$ 分别为：\r\n- $(1, 1, 1, 1)$\r\n- $(1, 2, 1, 1)$\r\n- $(1, 1, 3, 3)$\r\n- $(4, 4, 2, 3)$\r\n- $(4, 4, 3, 3)$\r\n- $(3, 4, 3, 3)$\r\n\r\n例如，$(1, 2, 1, 1)$（图中左上角包含 `4` 和 `7` 的区域）是一个合法区域，因为以下条件都成立：\r\n- $a_{1, 1}=4$ 严格小于 $a_{0, 1} = 8, a_{3, 1}=14, a_{1, 0}=7, a_{1, 2}=10$\r\n- $a_{2, 1}=7$ 严格小于 $a_{0,1}=8,a_{3, 1}=14, a_{2, 0}=9, a_{2, 2}=20$\r\n-->\r\n一共有 $6$ 个合法区域，分别为：\r\n- $r_1=r_2=1, c_1=c_2=1$\r\n- $r_1=1, r_2=2, c_1=c_2=1$\r\n- $r_1=r_2=1, c_1=c_2=3$\r\n- $r_1=r_2=4, c_1=2,c_2=3$\r\n- $r_1=r_2=4, c_1=c_2=3$\r\n- $r_1=3,r_2=4,c_1=c_2=3$\r\n\r\n例如，$r_1=1, r_2=2, c_1=c_2=1$ 对应一个合法区域，原因是以下两个条件都成立：\r\n- $a[1][1]=4$ 严格小于 $a[0][1]=8$，$a[3][1]=14$，$a[1][0]=7$，和 $a[1][2]=10$。\r\n- $a[2][1]=7$ 严格小于 $a[0][1]=8$，$a[3][1]=14$，$a[2][0]=9$，和 $a[2][2]=20$。"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于所有数据：\r\n- $1 \\le n, m \\le 2500$\r\n- $0 \\le a[i][j] \\le 7\\ 000\\ 000$（$0 \\le i \\le n - 1, 0 \\le j \\le m - 1$）\r\n\r\n详细子任务附加限制与分值如下表：\r\n\r\n|子任务编号|附加限制|分值|\r\n|:-:|:-:|:-:|\r\n|$1$|$n, m \\le 30$|$8$|\r\n|$2$|$n, m \\le 80$|$7$|\r\n|$3$|$n, m \\le 200$|$12$|\r\n|$4$|$n, m \\le 700$|$22$|\r\n|$5$|$n \\le 3$|$10$|\r\n|$6$|$0 \\le a[i][j] \\le 1$|$13$|\r\n|$7$|没有任何附加限制|$28$|"}]}