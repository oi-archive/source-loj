{"title":"「LibreOJ Round #10」Snakes 的 Naïve Graph","time_limit":1000,"memory_limit":512,"tags":["LibreOJ Round","二分图匹配","数学","数论","图论"],"operation":{"submit":"https://loj.ac/problem/563#submit_code","submissions":"https://loj.ac/submissions?problem_id=563","statistics":"https://loj.ac/problem/563/statistics/fastest","testdata":"https://loj.ac/problem/563/testdata","discussion":"https://loj.ac/discussion/problem/563"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"对于一个数 $m$，我们按如下方式确定一个有 $(2m-2)$ 个点的无重边二分图 $G(m)$：\r\n\r\n二分图 $G(m)$ 是一个可黑白二染色的无向图，其中有 $(m-1)$ 个黑色点与 $(m-1)$ 个白色点。令所有黑色点构成的集合为 $X$ ，所有白色点构成的集合为 $Y$。\r\n\r\n令 $i_X$ 表示集合 $X$ 的编号为 $i$ 的点，$i_Y$ 表示集合 $Y$ 的编号为 $i$ 的点，其中满足 $1\\leq i\\leq m-1$ 。$i_X$ 与 $j_Y$ 有一条无向边，当且仅当下列条件至少有一条成立：\r\n\r\n* $i=j$\r\n* $i\\times j\\equiv 1\\pmod m$\r\n\r\n令 $f[G(m)]$ 表示 $G(m)$ 的本质不同的最大匹配的个数。两个匹配本质不同当且仅当存在 $i_X$ 使得其在一种方案中与 $j_Y$ 匹配，在另一种方案中不与 $j_Y$ 匹配。\r\n\r\n共 $q$ 组询问，每组询问给出 $l,r$ ，求 $\\sum_{i=l}^r f[G(i)]$。\r\n\r\n输出答案对 $311021$ 取模的结果。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行包含一个正整数 $q$，表示数据组数。\r\n\r\n接下来 $q$ 行，每行两个正整数 $l,r$，表示一组询问。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"共 $q$ 行，每行一个整数，表示 $\\sum_{i=l}^r f[G(i)]$ 对 $311021$ 取模的结果。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n\r\n```plain\r\n5\r\n270 352\r\n24 28\r\n319 637\r\n312 932\r\n502 743\r\n```\r\n\r\n#### 样例输出\r\n\r\n```plain\r\n1926\r\n817\r\n404\r\n65535\r\n114514\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于全部数据，满足 $1\\leq l\\leq r\\leq 10^7$，$1\\leq q\\leq 10^5$。\r\n\r\n|子任务编号|分值|$l,r\\leq$|$q\\leq$|\r\n|:------------:|:----:|:---------:|:---------:|\r\n|1|$10$|$100$|$10$|\r\n|2|$9$|$1000$|$10^5$|\r\n|3|$12$|$5000$|$10^5$|\r\n|4|$13$|$2\\times 10^4$|$10^5$|\r\n|5|$15$|$5\\times 10^5$|$10^5$|\r\n|6|$18$|$2\\times 10^6$|$10^5$|\r\n|7|$23$|$10^7$|$10^5$|"}]}