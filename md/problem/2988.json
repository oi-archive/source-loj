{"title":"「CTSC2016」萨菲克斯 · 阿瑞","time_limit":5000,"memory_limit":256,"tags":["2016","CTSC","后缀数组","容斥原理","前缀和","文件 IO","DP"],"operation":{"submit":"https://loj.ac/problem/2988#submit_code","submissions":"https://loj.ac/submissions?problem_id=2988","statistics":"https://loj.ac/problem/2988/statistics/fastest","testdata":"https://loj.ac/problem/2988/testdata","discussion":"https://loj.ac/discussion/problem/2988"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"小 P 来到了 NOIP 2044 的赛场上，他发现第二题的题目是这样的：给你一个长度为 $n$ 的字符串，该字符串由至多 $m$ 种不同的字符组成，其中第 $i$ 种字符出现次数不超过 $c_i$，问你这个字符串的后缀数组是什么。\r\n\r\n聪明的小 P 想到了一个新的问题希望你来帮忙解答：在题目给定的限制下，能有多少种不同的答案。也就是所有由 $m$ 种字符组成，其中第 $i$ 种字符出现次数不超过 $c_i$，且长度为 $n$ 的字符串，共有多少种不同的后缀数组。\r\n\r\n由于答案很大，你只用输出答案对 $10^9 + 7$ 取模后的数。\r\n\r\n对于一个字符串 $s=s_1s_2\\cdots s_n$，记 $suf(i)$ 表示 $i$ 这个位置到末尾的子串。后缀数组为一个 $1$ 到 $n$ 的排列 $p_1, p_2, \\cdots , p_n$，满足 $suf(p_1)<suf(p_2)<\\ldots <suf(p_n)$。对于两个字符串 $s$ 和 $t$，令 $i$ 为第一个使得 $s_i \\neq t_i$ 的位置，那么我们称 $s_i$ 和 $t_i$ 中小的对应的字符串更小，如果 $i$ 不存在，那么长度小的字符串更小。\r\n\r\n对于字符之间的大小关系，我们规定第 $1$ 个字符最小，第 $2$ 个字符次小，依次类推。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"输入文件为 `suffix.in`。\r\n\r\n输入的第一行包含 $2$ 个正整数 $n, m$，表示字符串的长度为 $n$，共有 $m$ 种字符。\r\n\r\n接下来一行， 包含 $m$ 个非负整数 $c_1, c_2, \\ldots , c_m$，表示每种字符最多的出现次数。保证 $0 \\le c_1, c_2, \\ldots , c_m ≤ n$，$c_1 + c_2 + \\ldots + c_m \\ge n$。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出文件为 `suffix.out`。\r\n\r\n输出共 $1$ 行，包含一个整数，表示答案。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n3 2\r\n2 2\r\n```\r\n\r\n#### 样例输出 1\r\n```plain\r\n5\r\n```\r\n\r\n#### 样例说明 1\r\n我们记 `a` 为第一种字符，`b` 为第二种字符，那么共有 `aab`，`aba`，`abb`，`baa`，`bab`，`bba` 这六种可能的字符串。\r\n\r\n它们的后缀数组为 $(1,2,3)$，$(3,1,2)$，$(1,3,2)$，$(3,2,1)$，$(2,3,1)$，$(3,2,1)$。所以共有 $5$ 种不同的结果。\r\n\r\n#### 样例输入 2\r\n```plain\r\n10 5\r\n2 3 4 3 2\r\n```\r\n#### 样例输出 2\r\n```plain\r\n1003811\r\n```\r\n#### 样例 3\r\n见附加文件。"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"<!-- BEGIN: Migrated markdown table -->\r\n\r\n| 测试点 | $n$ | $m$ | 数据特点 |\r\n|:-:|:-:|:-:|:-:|\r\n| $1$ | $\\le 6$ | $\\le 6$ | 无 |\r\n| $2,3$ | $\\le 10$ | $\\le 10$ | 无 |\r\n| $4$ | $\\le 500$ | $=2$ | 无 |\r\n| $5$ | $\\le 500$ | $=3$ | 无 |\r\n| $6,7$ | $\\le 500$ | $\\le 500$ | $c_1=c_2=\\ldots =c_m=n$ |\r\n| $8\\sim 10$ | $\\le 50$ | $\\le 50$ | 无 |\r\n| $11\\sim 14$ | $\\le 200$ | $\\le 200$ | 无 |\r\n| $15\\sim 20$ | $\\le 500$ | $\\le 500$ | 无 |\r\n\r\n<!-- Migrated from original HTML table:\r\n<table><thead>\r\n  <tr>\r\n    <th style='text-align: center'>测试点</th>\r\n    <th style='text-align: center'> $n$ </th>\r\n    <th style='text-align: center'> $m$ </th>\r\n    <th style='text-align: center'>数据特点</th>\r\n  </tr></thead><tbody>\r\n  <tr>\r\n    <td style='text-align: center'> $1$ </td>\r\n    <td style='text-align: center'> $\\le 6$ </td>\r\n    <td style='text-align: center'> $\\le 6$ </td>\r\n    <td rowspan=\"4\" style='text-align: center'>无</td>\r\n  </tr>\r\n  <tr>\r\n    <td style='text-align: center'> $2,3$ </td>\r\n    <td style='text-align: center'> $\\le 10$ </td>\r\n    <td style='text-align: center'> $\\le 10$ </td>\r\n  </tr>\r\n  <tr>\r\n    <td style='text-align: center'> $4$ </td>\r\n    <td style='text-align: center'> $\\le 500$ </td>\r\n    <td style='text-align: center'> $=2$ </td>\r\n  </tr>\r\n  <tr>\r\n    <td style='text-align: center'> $5$ </td>\r\n    <td style='text-align: center'> $\\le 500$ </td>\r\n    <td style='text-align: center'> $=3$ </td>\r\n  </tr>\r\n  <tr>\r\n    <td style='text-align: center'> $6,7$ </td>\r\n    <td style='text-align: center'> $\\le 500$ </td>\r\n    <td style='text-align: center'> $\\le 500$ </td>\r\n    <td style='text-align: center'> $c_1=c_2=\\ldots =c_m=n$ </td>\r\n  </tr>\r\n  <tr>\r\n    <td style='text-align: center'> $8\\sim 10$ </td>\r\n    <td style='text-align: center'> $\\le 50$ </td>\r\n    <td style='text-align: center'> $\\le 50$ </td>\r\n    <td rowspan=\"3\" style='text-align: center'>无</td>\r\n  </tr>\r\n  <tr>\r\n    <td style='text-align: center'> $11\\sim 14$ </td>\r\n    <td style='text-align: center'> $\\le 200$ </td>\r\n    <td style='text-align: center'> $\\le 200$ </td>\r\n  </tr>\r\n  <tr>\r\n    <td style='text-align: center'> $15\\sim 20$ </td>\r\n    <td style='text-align: center'> $\\le 500$ </td>\r\n    <td style='text-align: center'> $\\le 500$ </td>\r\n  </tr></tbody>\r\n</table>\r\n-->\r\n\r\n<!-- END: Migrated markdown table -->"}]}