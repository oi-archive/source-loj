{"title":"「CodePlus 2017 12 月赛」火锅盛宴\t","time_limit":2000,"memory_limit":256,"tags":["CodePlus","数据结构"],"operation":{"submit":"https://loj.ac/problem/6258#submit_code","submissions":"https://loj.ac/submissions?problem_id=6258","statistics":"https://loj.ac/problem/6258/statistics/fastest","testdata":"https://loj.ac/problem/6258/testdata","discussion":"https://loj.ac/discussion/problem/6258"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"> SkyDec 和 YJQQQAQ 都是 Yazid 的好朋友。他们都非常喜欢吃火锅。有一天，他们聚在一起，享受一场火锅盛宴。\r\n\r\n\r\n在这场火锅盛宴中，有一个麻辣浓汤锅底的火锅和 $n$ 种食物，每种食物数量都是无限的。我们用 $1$ 至 $n$ 将这些食材编号。\r\n\r\n每种食物煮熟所需要的时间不同，第$i$种食物煮熟需要 $s_i$ 单位时间。这表示如果你在第 $T$ 个时刻将一个食物 $i$ 下到火锅里，那么它会在第 $T+s_i$ 个时刻被煮熟，并且此后一直会延续被煮熟的状态，直到它被拿走为止。\r\n\r\nYazid 和 YJQQQAQ 的口味不同：YJQQQAQ 觉得所有食物的好吃程度都是相同的；而 Yazid 则觉得没有两种食材的好吃程度是相同的，并且，巧合的是，编号越小的食物 Yazid 越喜欢吃。可怜的 S kyDec由于不能吃辣，所以只能帮 Yazid 和 YJQQQAQ 煮食物。\r\n\r\n整个火锅盛宴持续 $10^9$ 单位时间。在整个盛宴中，三位好朋友除了谈笑风生之外，最重要的事当然就是吃东西了。在任意整数时刻，都有可能发生下列 $4$ 种事件中的任意一种，我们用 $0$ 至 $3$ 之间的整数 $op$ 描述事件类型：\r\n\r\n* `0 id`：表示 SkyDec 往火锅里下了一个编号为$id$的食物。\r\n* `1`：Yazid在锅内搜寻熟了的**且**最喜欢吃的食物，并拿走**一个**这种食物。特别地，如果锅里没有熟了的食物，那么 Yazid 会很愤怒。\r\n* `2 id`：YJQQQAQ 在锅内搜寻编号为 $id$ 的食物：如果锅里不存在该种食物，则 YJQQQAQ 会很愤怒；如果锅里存在熟了的该食物，则 YJQQQAQ 会取走**一个**并食用；如果锅里只有未煮熟的该种食物，那么 YJQQQAQ 会希望知道最接近煮熟的该种食物（即锅内存在时间最长的该种食物）还需要多少时间被煮熟。\r\n* `3 l r`：馋涎欲滴的 SkyDec 想知道，锅里编号在 $[l,r]$ 之间的**且**熟了的食物总共有多少个。\r\n\r\n整个火锅晚宴中共发生了 $Q$ 个事件，且没有任意两个事件在同一时刻发生。\r\n\r\n他们的好朋友 Flvze 想知道这场火锅晚宴中发生的所有事，所以请你告诉她。\r\n"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"从标准输入读入数据。\r\n\r\n本题包含多组数据，输入的第一行为一个正整数 $T$，表示数据组数。接下来依次描述每组数据，对于每组数据：\r\n\r\n第一行一个正整数 $n$，表示食物的种类数。\r\n\r\n第二行 $n$ 个用空格隔开的正整数 $s_1,s_2,\\dots,s_n$，描述每种食物煮熟需要的时间。\r\n\r\n第三行一个正整数 $Q$，表示事件的数目。\r\n\r\n接下来 $Q$ 行，每行若干个用空格隔开的非负整数，描述一个事件。先是两个整数 $t,op$，分别表示发生事件的时间以及事件的类型。如果 $op=0$ 或 $op=2$，则接下来 $1$ 个正整数 $id$，意义见「题目描述」；如果 $op=1$，则接下来没有其他数；如果 $op=3$，则接下来 $2$ 个正整数 $l,r$，意义见「题目描述」。\r\n\r\n我们保证 $t$ 按输入顺序**严格**递增。\r\n\r\n我们保证 $1\\leq t\\leq 10^9$，$0\\leq op\\leq 3$，$1\\leq id\\leq n$，$1\\leq l\\leq r\\leq n$。\r\n"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出到标准输出。\r\n\r\n对于每个 $op\\neq 0$ 的操作，输出一行表示答案。对于不同的$op$，需要输出的内容如下：\r\n\r\n* 对于 $op=1$，如果 Yazid 成功取走食物，则输出他取走食物的编号；否则输出 \"Yazid is angry.\"（不含引号，下同）。\r\n* 对于 $op=2$，如果 YJQQQAQ 成功取走食物，则输出 \"Succeeded!\"；否则，如果锅里有未煮熟的该类食物，输出最接近煮熟的该种食物还需要多少时间被煮熟；否则，输出 \"YJQQQAQ is angry.\"。\r\n* 对于 $op=3$，输出锅内编号在指定范围内的熟食的数量。\r\n"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n\r\n```plain\r\n1\r\n2\r\n1 100\r\n10\r\n1 0 2\r\n2 0 1\r\n3 2 1\r\n4 2 2\r\n5 2 1\r\n200 0 1\r\n201 3 1 2\r\n202 1\r\n203 1\r\n204 1\r\n\r\n```\r\n\r\n\r\n\r\n#### 样例输出 1\r\n\r\n```plain\r\nSucceeded!\r\n97\r\nYJQQQAQ is angry.\r\n2\r\n1\r\n2\r\nYazid is angry.\r\n\r\n```\r\n\r\n\r\n"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"## 子任务\r\n\r\n \r\n\t\r\n\r\n\r\n<!-- BEGIN: Migrated markdown table -->\n\n| 测试点编号 | $n\\leq$ | $Q\\leq$ | 特殊约定 | 测试点分值 |\n|-|-|-|-|-|\n| 1 | $500$ | $1000$ | 无 | 8 |\n| 2-3 | $10$ | $300,000$ | 无 | 6 |\n| 4-5 | $100,000$ | $300,000$ | 所有 $s_i=1$ | 8 |\n| 6-7 | $100,000$ | $300,000$ | 所有 $s_i$ 都相同 | 11 |\n| 8-9 | $100,000$ | $300,000$ | $op\\neq 3$ | 7 |\n| 10-11 | $100,000$ | $300,000$ | 无 | 12 |\n| 12-13 | $100,000$ | $500,000$ | 无 | 2 |\n\n<!-- Migrated from original HTML table:\n<table class=\"ui celled center aligned table\"><thead><tr><th rowspan=\"1\">测试点编号</th><th rowspan=\"1\">$n\\leq$ </th><th rowspan=\"1\">$Q\\leq$ </th><th rowspan=\"1\">特殊约定</th><th rowspan=\"1\">测试点分值</th></tr></thead><tbody><tr><td rowspan=\"1\">1</td><td rowspan=\"1\">$500$ </td><td rowspan=\"1\">$1000$ </td><td rowspan=\"1\">无</td><td rowspan=\"1\">8</td></tr><tr><td rowspan=\"1\">2-3</td><td rowspan=\"1\">$10$ </td><td rowspan=\"5\">$300,000$ </td><td rowspan=\"1\">无</td><td rowspan=\"1\">6</td></tr><tr><td rowspan=\"1\">4-5</td><td rowspan=\"5\">$100,000$ </td><td rowspan=\"1\">所有 $s_i=1$ </td><td rowspan=\"1\">8</td></tr><tr><td rowspan=\"1\">6-7</td><td rowspan=\"1\">所有 $s_i$ 都相同</td><td rowspan=\"1\">11</td></tr><tr><td rowspan=\"1\">8-9</td><td rowspan=\"1\">$op\\neq 3$ </td><td rowspan=\"1\">7</td></tr><tr><td rowspan=\"1\">10-11</td><td rowspan=\"2\">无</td><td rowspan=\"1\">12</td></tr><tr><td rowspan=\"1\">12-13</td><td rowspan=\"1\">$500,000$ </td><td rowspan=\"1\">2</td></tr></tbody></table>\n-->\n\n<!-- END: Migrated markdown table --> \r\n\r\n对于所有数据，保证 $T\\leq 4$，保证 $n\\leq 100,000$，$Q\\leq 500,000$，$1\\leq s_i\\leq 10^8$。\r\n\r\n<hr style='color: #ddd; margin-bottom: 1em'>\r\n\r\n来自 CodePlus 2017 12 月赛，清华大学计算机科学与技术系学生算法与竞赛协会 荣誉出品。  \r\nCredit：idea/王聿中　命题/王聿中　验题/吕时清，杨景钦   \r\nGit Repo：https://git.thusaac.org/publish/CodePlus201712  \r\n感谢腾讯公司对此次比赛的支持。\r\n"}]}