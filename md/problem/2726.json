{"title":"「JOI 2015 Final」JOI 公园","time_limit":1000,"memory_limit":256,"tags":["2015","JOI","最短路"],"operation":{"submit":"https://loj.ac/problem/2726#submit_code","submissions":"https://loj.ac/submissions?problem_id=2726","statistics":"https://loj.ac/problem/2726/statistics/fastest","testdata":"https://loj.ac/problem/2726/testdata","discussion":"https://loj.ac/discussion/problem/2726"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"**译自 [JOI 2015 Final](https://www.ioi-jp.org/joi/2014/2015-ho/index.html) T3「[JOI 公園](https://www.ioi-jp.org/joi/2014/2015-ho/2015-ho.pdf)」**\r\n\r\n时值 20XX 年，为了给办奥赛做准备，IOI 国将要修缮 JOI 公园。 JOI 公园里有 $ N $ 个广场，这些广场从 $ 1 $ 到 $ N $ 编号。有 $ M $ 条道路连接各个广场，这些道路从 $ 1 $ 到 $ M $ 编号。第 $ i(1 \\leq i \\leq M) $ 条道路是一条连接第 $ A_i $ 和第 $ B_i $ 个广场的双向边，长度为 $ D_i $ 。任意两个广场间一定有道路（直接或间接）相连。\r\n\r\n修缮计划如下：首先，选择一个**自然数**  $ X $ ，将和第一个广场距离等于 $ X $ 或在 $ X $ 以下的所有广场（含第一个广场）相互之间连结一条地下通道。广场 $ i $ 和广场 $ j $ 的距离指，从广场 $ i $ 到广场 $ j $ 经过的道路长度总和的最小值。定义 $ C $ 为一个与修筑地下通道花费有关的量（ $ C $ 是整数）。修筑所有地下通道的花费为 $ C\\times X $ 。\r\n\r\n接下来，撤去已经通过地下通道连接的广场之间的道路。撤去道路的花费不计。\r\n\r\n最后，将没有被撤去的道路进行修补，长为 $ d $ 的道路修补的花费为 $ d $ 。\r\n\r\n修缮计划实施之前， JOI 公园没有地下通道。请求出 JOI 公园修缮花费总和的最小值。\r\n\r\n#### 任务\r\n给出 JOI 公园的广场间道路的情况和 $ C $ 的值，请编写程序求出修缮 JOI 公园的花费总和的最小值。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行为三个以空格分开的整数 $ N,M,C $ ，分别表示广场共有 $ N $ 个，道路有 $ M $ 条，而 $ C $ 为与修筑地下通道花费有关的量；  \r\n接下来 $ M $ 行中的第 $ i $ 行 $ (1 \\leq i \\leq M) $ 为三个以空格分开的整数 $ A_i,B_i,D_i $ 。表示第 $ i $ 条道路连接广场 $ A_i $ 和广场 $ B_i $ ，其长度为 $ D_i $ 。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出一行一个整数：修缮 JOI 公园的花费总和的最小值。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 输入样例 1\r\n```plain\r\n5 5 2\r\n2 3 1\r\n3 1 2\r\n2 4 3\r\n1 2 4\r\n2 5 5\r\n```\r\n#### 输出样例 1\r\n```plain\r\n14\r\n```\r\n#### 样例说明 1\r\n对于输入样例 $1$， $ X=3 $ 也就是说，和广场 $ 1 $ 的距离在 $ 3 $ 或以下的广场（广场 $ 1 $ ，广场 $ 2 $ ，广场 $ 3 $ ）互相之间连接一条地下通道。修缮总花费为 $ 2\\times 3+3+5=14 $ 。这就是最小值。\r\n#### 输入样例 2\r\n```plain\r\n5 4 10\r\n1 2 3\r\n2 3 4\r\n3 4 3\r\n4 5 5\r\n```\r\n#### 输出样例 2\r\n```plain\r\n15\r\n```\r\n#### 样例说明 2\r\n对于输入样例 $ 2 $ ，$ X=0 $ 时修缮总花费最小。\r\n#### 输入样例 3\r\n```plain\r\n6 5 2\r\n1 2 2\r\n1 3 4\r\n1 4 3\r\n1 5 1\r\n1 6 5\r\n```\r\n#### 输出样例 3\r\n```plain\r\n10\r\n```\r\n#### 样例说明 3\r\n对于输入样例 $3$，$ X=5 $ 时所有广场相互间都会连接一条地下通道，此时修缮的花费最小。"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于 $ 15\\% $ 的分值：\r\n- $ N \\leq 100 $\r\n- $ M \\leq 200 $\r\n- $ C \\leq 100 $\r\n- $ D_i \\leq 10 (1 \\leq i \\leq M) $\r\n\r\n对于另 $ 45\\% $ 的分值：\r\n- $ N \\leq 100 $\r\n- $ M \\leq 4000 $\r\n\r\n对于 $ 100\\% $ 的分值，所以输入数据满足以下条件：\r\n- $ 2 \\leq N \\leq 10^5 $\r\n- $ 1 \\leq M \\leq 2\\times 10^5 $\r\n- $ 1 \\leq C \\leq 10^5 $\r\n- $ 1 \\leq A_i,B_i \\leq N (1 \\leq i \\leq M) $\r\n- $ A_i\\not = B_i (1 \\leq i \\leq M) $\r\n- $ (A_i,B_i)\\not =(A_j,B_j) $ 而且 $ (A_i,B_i)\\not =(B_j,A_j) (1 \\leq i\\lt j \\leq M) $\r\n- $ 1 \\leq D_i \\leq 10^5 (1 \\leq i \\leq M) $\r\n- 输入数据保证任意两个广场之间一定有道路连接（直接或间接）。"}]}