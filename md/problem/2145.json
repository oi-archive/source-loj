{"title":"「SHOI2017」分手是祝愿","time_limit":1000,"memory_limit":512,"tags":["2017","SHOI","概率与期望","数学"],"operation":{"submit":"https://loj.ac/problem/2145#submit_code","submissions":"https://loj.ac/submissions?problem_id=2145","statistics":"https://loj.ac/problem/2145/statistics/fastest","testdata":"https://loj.ac/problem/2145/testdata","discussion":"https://loj.ac/discussion/problem/2145"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"> Zeit und Raum trennen dich und mich.  \r\n> 时空将你我分开。\r\n\r\nB 君在玩一个游戏，这个游戏由 $n$ 个灯和 $n$ 个开关组成，给定这 $n$ 个灯的初始状态，下标为从 $1$ 到 $n$ 的正整数。\r\n\r\n每个灯有两个状态亮和灭，我们用 $1$ 来表示这个灯是亮的，用 $0$ 表示这个灯是灭的，游戏的目标是使所有灯都灭掉。\r\n\r\n但是当操作第 $i$ 个开关时，所有编号为 $i$ 的约数（包括 $1$ 和 $i$）的灯的状态都会被改变，即从亮变成灭，或者是从灭变成亮。\r\n\r\nB 君发现这个游戏很难，于是想到了这样的一个策略，每次等概率随机操作一个开关，直到所有灯都灭掉。\r\n\r\n这个策略需要的操作次数很多，B 君想到这样的一个优化。如果当前局面，可以通过操作小于等于 $k$ 个开关使所有灯都灭掉，那么他将不再随机，直接选择操作次数最小的操作方法（这个策略显然小于等于 $k$ 步）操作这些开关。\r\n\r\nB 君想知道按照这个策略（也就是先随机操作，最后小于等于 $k$ 步，使用操作次数最小的操作方法）的操作次数的期望。\r\n\r\n这个期望可能很大，但是 B 君发现这个期望乘以 $n$ 的阶乘一定是整数，所以他只需要知道这个整数对 $100003$ 取模之后的结果。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行两个整数 $n, k$。\r\n接下来一行 $n$ 个整数，每个整数是 $0$ 或者 $1$，其中第 $i$ 个整数表示第 $i$ 个灯的初始情况。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出一行，为操作次数的期望乘以 $n$ 的阶乘对 $100003$ 取模之后的结果。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n4 0\r\n0 0 1 1\r\n```\r\n\r\n#### 样例输出 1\r\n```plain\r\n512\r\n```\r\n\r\n#### 样例输入 2\r\n```plain\r\n5 0\r\n1 0 1 1 1\r\n```\r\n\r\n#### 样例输出 2\r\n```plain\r\n5120\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于 $0\\%$ 的测试点，和样例一模一样；  \r\n对于另外 $30\\%$ 的测试点，$n \\leq 10$；  \r\n对于另外 $20\\%$ 的测试点，$n \\leq 100$；  \r\n对于另外 $30\\%$ 的测试点，$n \\leq 1000$；  \r\n对于 $100\\%$ 的测试点，$1 \\leq n \\leq 100000, 0 \\leq k \\leq n$；  \r\n对于以上每部分测试点，均有一半的数据满足 $k = n$。"}]}