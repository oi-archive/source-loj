{"title":"「CERC2018」The Bridge on the River Kawaii","time_limit":5000,"memory_limit":1024,"tags":["2018","ICPC","并查集","离线","分块及按大小分类","图论","分治"],"operation":{"submit":"https://loj.ac/problem/6548#submit_code","submissions":"https://loj.ac/submissions?problem_id=6548","statistics":"https://loj.ac/problem/6548/statistics/fastest","testdata":"https://loj.ac/problem/6548/testdata","discussion":"https://loj.ac/discussion/problem/6548"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"**译自 [CERC 2018](https://contest.felk.cvut.cz/18cerc/)「[B. The Bridge on the River Kawaii](https://contest.felk.cvut.cz/18cerc/solved/bridge.pdf)」**\r\n\r\n在一个遥远的，叫做 Midsommer 的地方，有一条叫做 delta 的小河。河里流的是深紫色的酸，所以不可能在那里游泳。这条河周围有一些小岛，并且有桥连接它们。每座桥都有一个**危险系数**，表示通过这座桥有多危险。危险系数越高，通过这座桥就越危险。\r\n\r\n一位叫做 Richard Hradecki 的侦探兼悬疑小说作家经常需要通过这些桥来追查案件。在所有可能的路径中，他更倾向于选择最安全的一条，也就是这条路径上经过桥的最大危险系数越低越好。\r\n\r\n为了规划路线，Richard 经常让你为他找从一个岛到他要调查的岛的最安全路线。为了满足他的需求，你需要连续处理以下三种事件：\r\n\r\n- 当地人在两座岛屿之间建了一座新桥；\r\n- 一只酸性的并且毛茸茸的大粉熊 Lug 出现了，并摧毁了一座桥；\r\n- Richard 要求你找两个岛屿之间的最安全路线。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行包含两个整数 $N,Q$。$N$ 是岛屿数（岛屿用 $0\\ldots N-1$ 标号），$Q$ 是需要处理的事件数。\r\n\r\n接下来 $Q$ 行，每行表示一个事件，包含三或四个整数，说明如下：\r\n\r\n- $0\\ X\\ Y\\ V$：在 $X$ 岛与 $Y$ 岛之间刚建成一座危险系数为 $V$ 的桥；\r\n- $1\\ X\\ Y$：连接 $X,Y$ 两岛的桥刚被摧毁；\r\n- $2\\ X \\ Y$：Richard 询问从 $X$ 到 $Y$ 的最安全路径。\r\n\r\n对于所有类型的询问，$X,Y$ 表示一对合法的岛屿。保证任意两个岛屿之间最多只存在一座直达的桥，要被摧毁的桥在那一刻是存在的。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"对于每个种类为 $2$ 的事件，输出 $X$ 到 $Y$ 最安全路径上经过的最危险的桥的危险系数。如果 $X$ 与 $Y$ 之间没有路径，输出 $-1$。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n6 15\r\n0 1 2 1\r\n2 1 4\r\n2 1 5\r\n0 2 3 2\r\n2 1 4\r\n2 1 5\r\n0 3 4 3\r\n2 1 4\r\n2 1 5\r\n0 4 5 4\r\n2 1 4\r\n2 1 5\r\n1 4 5\r\n2 1 4\r\n2 1 5\r\n```\r\n#### 样例输出 1\r\n```plain\r\n-1\r\n-1\r\n-1\r\n-1\r\n3\r\n-1\r\n3\r\n4\r\n3\r\n-1\r\n```\r\n#### 样例输入 2\r\n```plain\r\n6 6\r\n0 2 0 4\r\n0 3 4 3\r\n0 0 4 1\r\n0 2 5 4\r\n2 3 2\r\n2 4 2\r\n```\r\n#### 样例输出 2\r\n```plain\r\n4\r\n4\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"$2\\le N\\le 10^5,1\\le Q\\le 10^5,0\\le V\\lt 10,0\\le X,Y\\lt N,X\\neq Y$"}]}