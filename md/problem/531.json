{"title":"「LibreOJ β Round #5」游戏","time_limit":1200,"memory_limit":512,"tags":["LibreOJ β Round","基环树","博弈论"],"operation":{"submit":"https://loj.ac/problem/531#submit_code","submissions":"https://loj.ac/submissions?problem_id=531","statistics":"https://loj.ac/problem/531/statistics/fastest","testdata":"https://loj.ac/problem/531/testdata","discussion":"https://loj.ac/discussion/problem/531"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"LCR 三分钟就解决了问题，她自信地输入了结果……\r\n\r\n> \\> …… 正在检查程序 ……\r\n\r\n> \\> …… 检查通过，正在评估智商 ……\r\n\r\n> \\> 对不起，您解决问题的速度过快，与加密者的智商不符。转入精确匹配。\r\n\r\n> \\> 由于您在模糊匹配阶段的智商差距过大，需要进行精确匹配。[匹配方法]()\r\n\r\nLCR 发现，精确匹配是通过与随机对手（称为「神犇」）游戏的方式，藉由游戏的决策来评定智商的机制。游戏规则如下：\r\n\r\n有一个长为 $n$，下标为 $[1,n]$ 的数组 $f[]$，且满足 $f[i]\\in [1,n]$。\r\n\r\n有一个**变量** $a$ 初始值为 $1$。双方轮流操作，LCR 先手。\r\n\r\n操作方法：每次在所有满足 $f[i]=a$ 的 $i$ 中选一个，并将 $a$ 赋值为 $i$，不能不选。无法操作者输，若共 $2n$ 次操作后仍未决出胜负，则为平局。\r\n\r\n我们定义二元关系“到达”如下：\r\n\r\n* $i$ 可以到达 $i$\r\n* $i$ 可以到达 $f[i]$\r\n* 如果 $i$ 能到达 $j$，$j$ 能到达 $k$，则 $i$ 能到达 $k$。\r\n\r\n则 $f$ 数组满足性质：对于任意 $i,j$ 存在 $k$ 使得 $i$ 和 $j$ 都能到达 $k$。\r\n\r\nLCR 即将面对 $q$ 局游戏。她发现每局游戏的 $f[]$ 数组都和给定的「模板数组」很像。经过进一步研究她发现每局游戏可以描述如下：\r\n\r\n给出两个整数 $u,v$，**满足在模板数组中 $f[u]$ 能到达 $u$，$f[v]$ 能到达 $v$**。则该局游戏的 $f[]$ 是把模板数组的 $f[u]$ 赋值为 $v$ 后得到的。\r\n\r\n现在 LCR 希望你帮她计算每局游戏的胜负状态。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行两个正整数 $n,q$。\r\n\r\n第二行 $n$ 个整数表示 $f[]$。\r\n\r\n接下来 $q$ 行每行两个整数 $u,v$ 描述一局游戏。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出共 $q$ 行。\r\n\r\n每行一个整数 $r$ 表示结果。\r\n$r=1$ 表示先手（LCR）有必胜策略，$r=0$ 表示后手（神犇）有必胜策略，$r=2$ 表示平局。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n```plain\r\n7 3\r\n3 1 2 3 4 3 2\r\n1 1\r\n2 3\r\n2 1\r\n```\r\n\r\n#### 样例输出\r\n```plain\r\n2\r\n0\r\n0\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于所有数据，$1\\le n,q\\le 10^6$。\r\n\r\n\r\n|Subtask #|分值|$n,q$ 的限制|特殊限制|\r\n|:-:|:-:|:-:|:-:|\r\n|1|$15$|$n,q\\le 4$||\r\n|2|$27$|$n,q\\le 3000$||\r\n|3|$22$|$n,q\\le 2\\times 10^5$|$f[]$ 是排列|\r\n|4|$23$|$n,q\\le 2\\times 10^5$||\r\n|5|$13$|$n,q\\le 10^6$||"}]}