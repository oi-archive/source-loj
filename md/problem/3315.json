{"title":"「ZJOI2020」抽卡","time_limit":5000,"memory_limit":512,"tags":["ZJOI","2020","DFT（含 NTT）及FFT","生成函数"],"operation":{"submit":"https://loj.ac/problem/3315#submit_code","submissions":"https://loj.ac/submissions?problem_id=3315","statistics":"https://loj.ac/problem/3315/statistics/fastest","testdata":"https://loj.ac/problem/3315/testdata","discussion":"https://loj.ac/discussion/problem/3315"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"Bob 喜欢抽卡。\r\n\r\nBob 最近入坑了一款叫“主公连结” 的抽卡游戏。游戏中共有 $n$ 个不同的角色，编号为 $1\\sim n$。当 Bob 获得其中的编号连续的 $k$ 张卡时，就可以组出理论最强阵容。\r\n\r\n当期卡池中共有 $m$ 张不同的卡，每次抽卡，Bob 都可以等概率随机获得一张卡池中的卡。如果 Bob 抽到了一张他已经拥有的卡，那么什么事都不会发生，等于 Bob 浪费了这次抽卡机会。Bob 是个谨慎的人，他想知道，如果他不停地抽卡直到抽到编号连续的 $k$ 张卡时停止抽卡，期望需要抽多少轮。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行输入两个整数 $m, k$。\r\n\r\n第二行输入 $m$ 个两两不同的整数 $a_1, a_2, \\dots, a_m$，表示卡池中有哪些角色。\r\n\r\n题面中的 $n$ 即为最大的 $a_i$ 的值。\r\n"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出一行一个整数，代表期望轮数对 $p = 998244353$ 取模后的结果。即，如果期望数量的最简分数表示为 $\\frac ab$，你需要输出一个整数 $c$ 满足 $c\\times b \\equiv a \\pmod p$。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n\r\n```plain\r\n3 2\r\n1 2 3\r\n```\r\n\r\n#### 样例输出 1\r\n\r\n```plain\r\n499122180\r\n```\r\n\r\n#### 样例解释 1\r\n\r\n如果第一轮抽到的是 $2$ 号卡，那么期望需要抽 $1 + \\frac 32$ 轮；如果第一轮抽到的是 $1$ 号卡或 $3$ 号卡，那么期望需要抽 $1 + 3$ 轮。故答案为 $\\frac 13(1 + \\frac 32) + \\frac 23(1 + 3) = 3.5$\r\n\r\n#### 样例输入 2\r\n\r\n```plain\r\n10 2\r\n1 2 3 4 5 7 8 9 11 12\r\n```\r\n\r\n#### 样例输出 2\r\n\r\n```plain\r\n839792873\r\n```\r\n"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于前 $10\\%$ 的数据，$m\\le 10$。\r\n\r\n对于另外 $10\\%$ 的数据，$m \\le 500$ 且 $k = m − 1$。\r\n\r\n对于另外 $10\\%$ 的数据，$m \\le 500$ 且保证有且仅有一组理论最强阵容。\r\n\r\n对于另外 $10\\%$ 的数据，$m \\le 500$ 且保证任意两组可抽出的理论最强阵容不交。\r\n\r\n对于前 $50\\%$ 的数据，$m \\le 500$。\r\n\r\n对于前 $70\\%$ 的数据，$m \\le 5000$。\r\n\r\n对于另外 $10\\%$ 的数据，$k = 5$。\r\n\r\n对于另外 $10\\%$ 的数据，$k = 2000$。\r\n\r\n对于 $100\\%$ 的数据，$1 \\le m \\le 200000, 1 \\le a_i \\le 2m, 2 \\le k \\le m$，保证卡池中至少存在一组可抽出的理论最强阵容（即编号连续的 $k$ 张卡）。\r\n"}]}