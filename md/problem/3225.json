{"title":"「PA 2019」Podatki drogowe","time_limit":7000,"memory_limit":1024,"tags":["2019","PA","点分治","hash","可持久化"],"operation":{"submit":"https://loj.ac/problem/3225#submit_code","submissions":"https://loj.ac/submissions?problem_id=3225","statistics":"https://loj.ac/problem/3225/statistics/fastest","testdata":"https://loj.ac/problem/3225/testdata","discussion":"https://loj.ac/discussion/problem/3225"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"**题目译自 [PA 2019](https://sio2.mimuw.edu.pl/c/pa-2019-1/dashboard/) Runda 5 [Podatki drogowe](https://sio2.mimuw.edu.pl/c/pa-2019-1/p/pod/)**\r\n\r\n给定一棵 $ n $ 个点的无根树，点的编号为 $ 1 $ 到 $ n $。第 $ i $ 条边连接点 $a_i$ 和 $ b_i $，边权为 $ n^{p_i} $。\r\n\r\n定义 $ u $ 到 $ v $ 的距离 $ d(u, v) $ 为 $ u $ 和 $ v $ 在树上的简单路径的边权之和。\r\n\r\n给定 $ k $，请在 $ \\frac{n(n-1)}{2} $ 个 $ d(u, v) $（$1 \\le u < v  \\le n$）中找到第 $ k $ 小的值。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行两个正整数 $ n, k $。\r\n\r\n接下来 $ n - 1 $ 行，每行三个正整数 $ a_i, b_i, p_i$，表示一条连接 $ a_i $ 和 $ b_i $ 的边，其边权为 $ n^{p_i} $。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出一行一个整数，即第 $ k $ 小的值对 $ 10^9+7 $ 取模的结果。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n```plain\r\n5 8\r\n1 2 1\r\n3 1 3\r\n3 4 1\r\n5 3 2\r\n```\r\n#### 样例输出\r\n```plain\r\n135\r\n```\r\n\r\n#### 样例说明\r\n所有的 $ d(u, v) $ 有：$5, 5, 25, 30, 125, 130, 130, 135, 150, 155$，第 $8$ 小的为 $135$，是 $ u=2, v=4 $ 这条路径。"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"$ 2 \\le n \\le 25000, 1 \\le k \\le \\frac{n(n-1)}{2}, 1 \\le a_i, b_i, p_i \\le n $"}]}