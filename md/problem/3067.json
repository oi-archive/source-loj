{"title":"「ROI 2016 Day2」二指禅","time_limit":3000,"memory_limit":256,"tags":["2016","ROI"],"operation":{"submit":"https://loj.ac/problem/3067#submit_code","submissions":"https://loj.ac/submissions?problem_id=3067","statistics":"https://loj.ac/problem/3067/statistics/fastest","testdata":"https://loj.ac/problem/3067/testdata","discussion":"https://loj.ac/discussion/problem/3067"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"**译自 [ROI 2016](http://neerc.ifmo.ru/school/archive/2015-2016.html) Day2 T4.** ***[Тренажёр «10<sub>2</sub>-пальцевый набор»](http://neerc.ifmo.ru/school/archive/2015-2016/ru-olymp-roi-2016-day2.pdf)***\r\n\r\n<center><img src=\"https://loj-img.upyun.menci.memset0.cn/2019/05/15/5cdc207f9cac3.jpg\" width=\"40%\">\r\n</center>\r\n\r\n未来的机器人码农一定学过二指禅。为了帮助码农们精通二指禅，某打字软件推出了一种新的练习方法。\r\n\r\n屏幕的上半部分会显示一个 $m$ 位 01 串 $S$（01 串：只包含数字 0 和 1 的字符串）。下半部分会显示 $n$ 个 01 串（称之为模式串），编号分别为 $1\\ldots n$。第 $i$ 个模式串为 $c_i$。每个模式串有一个费用 $w_i$。模式串的总长度为 $L$。 \r\n\r\n你需要将 $S$ 分成若干个子串，使得对于 $S$ 的每个子串 $S_i$，存在一个 $j$ 满足：$S_i$ 是 $c_j$ 的前缀或后缀。\r\n\r\n划分的总花费就是每个子串对应的模型的模式串之和。试求最小总花费。如果没有合法划分方案，则输出 `-1`。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"$m,n,L$  \r\n$S$  \r\n$c_i,w_i$"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n9 2 8\r\n000110100\r\n1 100\r\n1 11001\r\n```\r\n\r\n#### 样例输出 1\r\n```plain\r\n4\r\n```\r\n\r\n#### 样例输入 2\r\n```plain\r\n9 3 10\r\n010110101\r\n3 0101\r\n10 011\r\n2 100\r\n```\r\n\r\n#### 样例输出 2\r\n```plain\r\n8\r\n```\r\n\r\n#### 样例输入 3\r\n```plain\r\n3 1 3\r\n100\r\n1 101\r\n```\r\n\r\n#### 样例输出 3\r\n```plain\r\n-1\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于所有数据，$1 ⩽ m, n, L ⩽ 300\\,000$；$1 ⩽ c_i ⩽ 10^9$。\r\n\r\n设 $l_{max}$ 表示单个模式串的最大长度。\r\n\r\n| 子任务 # | 分值 |        $m$       |     $n$     |        $L$       |      $c_i$     |      $l_{max}$     | 依赖子任务 |\r\n|:--------:|:----:|:----------------:|:-----------:|:----------------:|:--------------:|:------------------:|:----------:|\r\n|     1    |  20  |    $m \\le 50$    |  $n \\le 50$ |    $L \\le 500$   | $c_i \\le 1000$ |  $l_{max} \\le 50$  |            |\r\n|     2    |  10  |   $m \\le 5000$   |     ---     |   $L \\le 5000$   |       ---      | $l_{max} \\le 1000$ |      1     |\r\n|     3    |   8  |  $m \\le 10\\,000$ |     ---     |  $L \\le 50\\,000$ |       ---      | $l_{max} \\le 1000$ |    1, 2    |\r\n|     4    |   &nbsp;8&nbsp;  |  $m \\le 50\\,000$ |     ---     |  $L \\le 50\\,000$ |       ---      | $l_{max} \\le 2000$ |    1--3    |\r\n|     5    |  10  |  $m \\le 50\\,000$ |  $n \\le 20$ |  $L \\le 50\\,000$ |       ---      |         ---        |            |\r\n|     6    |   5  |  $m \\le 50\\,000$ | $n \\le 200$ |  $L \\le 50\\,000$ |       ---      |         ---        |      5     |\r\n|     7    |   9  |  $m \\le 50\\,000$ |     ---     |  $L \\le 50\\,000$ |     $c_i=1$    |         ---        |            |\r\n|     8    |   5  |  $m \\le 50\\,000$ |     ---     |  $L \\le 50\\,000$ |   $c_i\\le 10$  |         ---        |      7     |\r\n|     9    |   &nbsp;5&nbsp;  |  $m \\le 50\\,000$ |     ---     |  $L \\le 50\\,000$ |  $c_i\\le 100$  |         ---        |    7, 8    |\r\n|    10    |   5  |  $m \\le 50\\,000$ |     ---     |  $L \\le 50\\,000$ |       ---      |         ---        |    1--9    |\r\n|    11    |   &nbsp;5&nbsp;  | $m \\le 100\\,000$ |     ---     | $L \\le 100\\,000$ |       ---      |         ---        |    1--10   |\r\n|    12    |   5  | $m \\le 200\\,000$ |     ---     | $L \\le 200\\,000$ |       ---      |         ---        |    1--11   |\r\n|    13    |   &nbsp;5&nbsp;  | $m \\le 300\\,000$ |     ---     | $L \\le 300\\,000$ |       ---      |         ---        |    1--12   |"}]}