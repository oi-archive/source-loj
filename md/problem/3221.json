{"title":"「PA 2019」Szprotki i szczupaki","time_limit":7000,"memory_limit":256,"tags":["2019","PA","线段树","贪心","二分"],"operation":{"submit":"https://loj.ac/problem/3221#submit_code","submissions":"https://loj.ac/submissions?problem_id=3221","statistics":"https://loj.ac/problem/3221/statistics/fastest","testdata":"https://loj.ac/problem/3221/testdata","discussion":"https://loj.ac/discussion/problem/3221"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"**题目译自 [PA 2019](https://sio2.mimuw.edu.pl/c/pa-2019-1/dashboard/) Runda 4 [Szprotki i szczupaki](https://sio2.mimuw.edu.pl/c/pa-2019-1/p/sis/)**\r\n\r\n在湖中有 $ n $ 条小鱼，第 $ i $ 条小鱼的重量为 $ w_i $，$ q $ 个操作，每个操作是下面 $ 3 $ 种之一：\r\n\r\n+ $1$ $ s $ $ k $：假如现在来了一条重量为 $ s $ 的大鲨鱼，它的目标是让自己的重量达到至少 $ k $，问它至少需要吃掉多少条小鱼？如果鲨鱼当前的重量严格大于要吃掉的小鱼的重量 $ w $，那么它可以吃掉这条小鱼，并使得自己的重量增加 $ w $。\r\n+ $2$ $w$：添加一条重量为 $ w $ 的小鱼。\r\n+ $3$ $w$：删除一条重量为 $ w $ 的小鱼，保证存在至少一条这样的小鱼。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行一个正整数 $ n $。\r\n\r\n第二行 $ n $ 个正整数 $ w_1, w_2, \\dots, w_n $。\r\n\r\n第三行一个正整数 $ q $。接下来 $ q $ 行，每行若干个整数，描述一个操作，格式如题面所述。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"对于每个编号为 $ 1 $ 的操作，输出最后结果。如果不能让大鲨鱼的体重达到至少 $ k $，则输出 $ -1 $。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n```plain\r\n4\r\n1 4 8 1\r\n15\r\n1 2 3\r\n1 2 4\r\n1 2 5\r\n1 3 3\r\n1 3 5\r\n1 3 16\r\n1 4 16\r\n1 8 17\r\n1 100 101\r\n1 100 115\r\n1 3 9\r\n2 2\r\n1 3 9\r\n3 4\r\n1 3 9\r\n```\r\n#### 样例输出\r\n```plain\r\n1\r\n2\r\n-1\r\n0\r\n2\r\n4\r\n3\r\n2\r\n1\r\n-1\r\n3\r\n2\r\n-1\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"$ 1 \\le n \\le 3\\times 10^5, 1 \\le q \\le 10^5, 1 \\le w_i, w \\le 10^{12}, 1 \\le s, k \\le 10^{18} $"}]}