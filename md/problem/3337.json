{"title":"「BalticOI 2020」病毒","time_limit":700,"memory_limit":256,"tags":["BalticOI","2020"],"operation":{"submit":"https://loj.ac/problem/3337#submit_code","submissions":"https://loj.ac/submissions?problem_id=3337","statistics":"https://loj.ac/problem/3337/statistics/fastest","testdata":"https://loj.ac/problem/3337/testdata","discussion":"https://loj.ac/discussion/problem/3337"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"**题目译自 [BalticOI 2020](http://www.boi2020.lv/tasks.html) Day2 C「[Viruses](http://www.boi2020.lv/data/tasks/en/day2/viruses.pdf)」**\r\n\r\n科学家研究病毒的基因突变。病毒的基因由一个数列组成，当中的数字为 $0\\sim G-1$。根据突变表，当突变发生时，病毒基因序列中的一个数字就会被相应的数字串所取代。当病毒仅由 $0,1$ 组成时，突变终止。\r\n\r\n例如，按照如下的突变表所示：\r\n\r\n$$ 2 \\to \\langle 0\\ 1 \\rangle \\ $$\r\n$$3 \\to \\langle 2\\ 0\\ 0\\rangle\\ $$\r\n$$3 \\to \\langle 1\\ 3\\rangle\\ $$\r\n$$4 \\to \\langle 0\\ 3\\ 1\\ 2\\rangle\\ $$\r\n$$5 \\to \\langle 2\\ 1\\rangle\\ $$\r\n$$5 \\to \\langle 5\\rangle$$\r\n\r\n那么最初基因为一个 $4$ 的病毒可能会发生以下突变：\r\n\r\n$$\\langle 4 \\rangle \\to \\langle \\underline{0\\ 3\\ 1\\ 2} \\rangle \\to \\langle 0\\ \\underline{2\\ 0\\ 0}\\ 1\\ 2 \\rangle \\to \\langle 0\\ \\underline{0\\ 1}\\ 0\\ 0\\ 1\\ 2 \\rangle \\to \\langle 0\\ 0\\ 1\\ 0\\ 0\\ 1\\ \\underline{0\\ 1} \\rangle$$\r\n\r\n或以另一种方式：\r\n\r\n$$\\langle 4 \\rangle \\to \\langle \\underline{0\\ 3\\ 1\\ 2} \\rangle \\to \\langle 0\\ \\underline{1\\ 3}\\ 1\\ 2 \\rangle \\to \\langle 0\\ 1\\ 3\\ 1\\ \\underline{0\\ 1} \\rangle \\to \\langle 0\\ 1\\ \\underline{2\\ 0\\ 0}\\ 1\\ 0\\ 1 \\rangle \\to \\langle 0\\ 1\\ \\underline{0\\ 1}\\ 0\\ 0\\ 1\\ 0\\ 1 \\rangle$$\r\n\r\n病毒由抗体来识别。抗体的识别方法是检查病毒中是否含有一段特定的 $0,1$组成的片段。例如，抗体的特定片段为 $\\langle 0\\ 0\\ 1\\ 0\\ 0 \\rangle$，那么它可以检测到病毒 $\\langle 0\\ 0\\ 1\\ 0\\ 0\\ 1\\ 0\\ 1 \\rangle$，但却无法检测出病毒 $\\langle 0\\ 1\\ 0\\ 1\\ 0\\ 0\\ 1\\ 0\\ 1 \\rangle$。\r\n\r\n对于 $2\\sim G-1$ 的每一个基因，科学家们都想知道一组给定的抗体能否检测出通过突变最终产生的所有病毒。如果无法全部检测，他们就想知道最短的不能检测的病毒基因的长度。\r\n\r\n有时候科学家们没有抗体。此时显然没有任何病毒能被检验到，所以他们只想知道突变最终产生的病毒中长度最小的是多长。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"输入第一行三个整数 $G,N,M$（$G>2,N\\geq G-2,M\\geq 0$），表示基因的数量，突变表的行数和抗体的种类数。\r\n\r\n接下来的 $N$ 行描述了突变表：每行最开始输入两个整数 $a,k$（$2\\le a\\le G,k\\geq 1$）；接下来输入 $k$ 个整数 $b_1,b_2,\\dots,b_k$（$0\\le b_i<G$）。表示以下的突变方式：\r\n\r\n $$ a \\to \\langle b_1\\ b_2\\ \\ldots\\ b_k \\rangle $$\r\n\r\n题目保证所有的 $k$ 之和不超过 $100$。$2\\sim G-1$ 的整数至少在突变表中出现一次。\r\n\r\n接下来的 $M$ 行，每行为对抗体的描述：每行先输入一个整数 $ℓ$，然后是 $ℓ$ 个整数 $c_1,c_2,\\dots,c_ℓ$，描述抗体的序列。保证 $ℓ$ 之和不超过 $50$。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出共 $G-2$ 行，为 $2\\sim G-1$ 的基因对应的答案。\r\n\r\n如果所有从某一基因突变得到的病毒都能被抗体所检测，输出 `YES`。当没有病毒来着这一基因时，同样输出 `YES`（如果一个病毒不会停止突变，也属于这种情况。）。\r\n\r\n否则输出 `NO`。接着输出一个整数，表示最小的无法被检测出的基因长度。你可以假设在所有数据中这个值都小于 $263$。\r\n\r\n"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n```\r\n6 6 2\r\n2 2 0 1\r\n3 3 2 0 0\r\n3 2 1 3\r\n4 4 0 3 1 2\r\n5 2 2 1\r\n5 1 5\r\n2 1 1\r\n5 0 0 1 0 0\r\n``` \r\n\r\n#### 样例输出\r\n```\r\nNO 2\r\nNO 4\r\nNO 9\r\nYES\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"本题共 $5$ 个子任务，各子任务的分值和限制如下：\r\n\r\n子任务 $1$（$11$ 分）：$M=0$。\r\n\r\n子任务 $2$（$14$ 分）：$N=G-2$。\r\n\r\n子任务 $3$（$25$ 分）：$M=1$。\r\n\r\n子任务 $4$（$32$ 分）：$\\sum ℓ\\le 10$。\r\n\r\n子任务 $5$（$18$ 分）：无特殊限制。"}]}