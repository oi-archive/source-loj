{"title":"「JOISC 2017 Day 3」自然公园","time_limit":1500,"memory_limit":256,"tags":["2017","JOISC","DFS 树","二分","交互题"],"operation":{"submit":"https://loj.ac/problem/2398#submit_code","submissions":"https://loj.ac/submissions?problem_id=2398","statistics":"https://loj.ac/problem/2398/statistics/fastest","testdata":"https://loj.ac/problem/2398/testdata","discussion":"https://loj.ac/discussion/problem/2398"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"**题目译自 [JOISC 2017](https://www.ioi-jp.org/camp/2017/2017-sp-tasks/index.html) Day3 T3「[自然公園](https://www.ioi-jp.org/camp/2017/2017-sp-tasks/2017-sp-d3.pdf) / [Natural Park](https://www.ioi-jp.org/camp/2017/2017-sp-tasks/2017-sp-d3-en.pdf)」**\r\n\r\nJOI 岛是一个观光胜地，全岛被定为一个自然公园。\r\n\r\nJOI 岛有 $N$ 个广场和若干条道路。广场从 $0$ 至 $N - 1$ 编号。每条道路联结岛内两个不同的广场，可以双向通行。对于每一个广场，至多有 $7$ 条道路将它与其他广场相连。对于任意两个不同的广场，至多有 $1$ 条道路将它们相连。此外，我们已知任意两个广场都可以通过若干条道路互相到达。\r\n\r\n你和你的朋友 IOI 酱决定考察 JOI 岛。为了考察能够高效进行，你不得不掌握全岛的结构。岛上的诸多动物会带来危险，因此由运动细胞发达的 IOI 酱去探索全岛，而你则负责基于 IOI 酱的报告来确定岛的结构。\r\n\r\n你可以对 IOI 酱指定两个广场 $A$、$B$，以及若干可以经过的广场，向其询问是否可以只经由指定的广场从 $A$ 到达 $B$。IOI 酱会按照询问的内容在岛上探索并报告结果。\r\n\r\n由于考察不能持续过长时间，需要将询问次数限制在 $45\\,000$ 次以内。\r\n\r\n### 任务\r\n\r\n请编写一个程序与 IOI 酱交流并确定 JOI 岛的完整结构。\r\n\r\n### 实现细节\r\n\r\n你需要实现一个过程来确定岛的结构。请包含头文件 `park.h`。\r\n\r\n程序需要实现以下过程。\r\n\r\n* `void Detect(int T, int N)`\r\n   * 此函数只会被调用 $1$ 次。\r\n   * 参数 $\\texttt{T}$ 表示子任务编号，$\\texttt{N}$ 表示广场的数目。\r\n\r\n程序中需要调用以下函数来输出所确定的 JOI 岛的构造。\r\n\r\n* `void Answer(int A, int B)`\r\n   * 此函数被调用的次数须等于 JOI 岛的道路数目。\r\n   * 参数 $\\texttt{A}$ 和 $\\texttt{B}$ 表示确定了一条联结广场 $\\texttt{A}$ 和 $\\texttt{B}$ 的道路。\r\n   * 参数需要满足以下条件：\r\n      * $\\texttt{A}$ 和 $\\texttt{B}$ 须满足 $0 \\leq \\texttt{A} < \\texttt{B} \\leq N - 1$。不满足此条件时，会被判为 **Wrong Answer [1]**。\r\n      * 对于一组参数 $(\\texttt{A}, \\texttt{B})$，广场 $\\texttt{A}$ 与广场 $\\texttt{B}$ 之间须有一条道路。不满足此条件时，会被判为 **Wrong Answer [2]**。\r\n      * 对于一组参数 $(\\texttt{A}, \\texttt{B})$ 不得调用 $2$ 次及以上。不满足此条件时，会被判为 **Wrong Answer [3]**。\r\n\r\n此外，程序中可以调用如下函数。\r\n\r\n* `int Ask(int A, int B, int Place[])`\r\n   * 此函数用于向 IOI 酱提出询问。\r\n   * $\\texttt{Place}$ 指向表示每个广场是否可以经过的数组。对于每个 $\\texttt{i}$（$0 \\leq \\texttt{i} \\leq N - 1$），$\\texttt{Place[i]} = 1$ 表示可以经过广场 $i$，$\\texttt{Place[i]} = 0$ 表示不可以经过广场 $i$。\r\n   * 此函数的返回值在可以只经由允许的广场从广场 $A$ 到达广场 $B$ 的情况下返回 $1$，不能到达的情况下返回 $0$。\r\n   * 参数需要满足以下条件：\r\n      * $0 \\leq \\texttt{A} < \\texttt{B} \\leq N - 1$。\r\n      * $0 \\leq \\texttt{Place[i]} \\leq 1$（$0 \\leq \\texttt{i} \\leq N - 1$）。\r\n      * $\\texttt{Place[A]} = 1$。\r\n      * $\\texttt{Place[B]} = 1$。\r\n   * 不满足这些条件时，会被判为 **Wrong Answer [4]**。另外，数组 $\\texttt{Place[]}$ 的长度不足 $N$ 时的行为是未定义的。\r\n   * 此外，函数 $\\texttt{Ask}$ 被调用的次数不能超过 $45\\,000$ 次。超过的情况下，会被判为 **Wrong Answer [5]**。\r\n\r\n函数 $\\texttt{Detect}$ 结束时，若存在未被作为过函数 $\\texttt{Answer}$ 调用参数的道路，被判为 **Wrong Answer [6]**。\r\n\r\n为了内部使用而定义的其他函数及全局变量不作限制。但是，你的提交不应该向标准输入/输出或者其他文件进行任何读写操作。\r\n\r\n### 编译与运行方法\r\n\r\n「附加文件」中提供了 `park.h`、`grader.c` 和 `grader.cpp` 三个文件。若你编写的程序名称为 `park.c` 或 `park.cpp`，请运行以下命令来编译：\r\n* C 语言 `gcc -std=c11 -O2 -o grader grader.c park.c -lm`\r\n* C++ 语言 `g++ -std=c++14 -O2 -o grader grader.cpp park.cpp`\r\n\r\n当命令成功时，会产生一个可执行文件 `grader`。\r\n\r\n注意实际评测时的程序与下发的样例评测程序并不相同。实际的 `park.h` 函数实现将通过标准输入/输出与单独运行的交互器进行交互。\r\n\r\n### 样例评测程序输入格式\r\n\r\n样例评测程序将从标准输入读入以下数据。\r\n\r\n* 第 $1$ 行一个整数 $T$，表示子任务编号。\r\n* 第 $2$ 行一个整数 $N$，表示广场有 $N$ 个。\r\n* 第 $3$ 行一个整数 $M$，表示道路有 $M$ 条。\r\n* 接下来 $M$ 行中的第 $i$（$1 \\leq i \\leq M$）行包含两个空格分隔的整数 $A_i, B_i$，表示有一条联结广场 $A_i$ 与广场 $B_i$ 的双向道路。\r\n\r\n### 样例评测程序输出格式\r\n\r\n样例评测程序将向标准输出输出以下信息。\r\n\r\n* 判为正确时，输出 `Accepted`；\r\n* 运行过程中被判为错误时，以 `Wrong Answer [x]` 的格式报告并退出。\r\n\r\n程序执行过程中违反了多种限制时，只会报告其中的一种。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例评测程序输入\r\n```plain\r\n1\r\n6\r\n7\r\n0 1\r\n0 3\r\n1 2\r\n1 4\r\n2 4\r\n2 5\r\n3 4\r\n```\r\n\r\n####  样例交互\r\n| 函数调用 | 返回值 |\r\n|:---|:---|\r\n| `Ask(3, 5, { 0, 0, 1, 1, 1, 1 })` | 1 |\r\n| `Answer(2, 4)` | |\r\n| `Answer(2, 5)` | |\r\n| `Answer(3, 4)` | |\r\n| `Ask(0, 4, { 1, 0, 1, 0, 1, 0 })` | 0 |\r\n| `Answer(0, 1)` | |\r\n| `Answer(0, 3)` | |\r\n| `Answer(1, 4)` | |\r\n| `Answer(1, 2)` | |\r\n\r\n注意本样例中的函数调用可能并无实际意义。\r\n\r\n本样例中，函数 $\\texttt{Detect}$ 以参数 $\\texttt{T} = 1, \\texttt{N} = 6$ 被调用。\r\n\r\n本样例中，JOI 岛的结构如下图所示。\r\n\r\n<img src=\"https://i.loli.net/2018/08/05/5b66d3d1669ec.png\" alt=\"img\" style=\"display: block; margin: 0 auto;width: 38.2%;\">\r\n<div style='text-align: center; color: #999'>JOI 岛的结构。写有数字的圆表示广场及其编号，线段表示道路。</div>\r\n\r\n* 第 $1$ 次调用函数 $\\texttt{Ask}$ 时，允许经过广场 $2, 3, 4, 5$，询问从广场 $3$ 是否可以到达广场 $5$。由于可以到达，函数 $\\texttt{Ask}$ 返回 $1$。\r\n* 第 $2$ 次调用函数 $\\texttt{Ask}$ 时，允许经过广场 $0, 2, 4$，询问从广场 $0$ 是否可以到达广场 $4$。由于不可以到达，函数 $\\texttt{Ask}$ 返回 $0$。"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"所有数据满足下列条件。$T$，$N$，$M$ 的含义参照「样例评测程序输入格式」一节。\r\n* $1 \\leq T \\leq 5$。\r\n* $2 \\leq N \\leq 1\\,400$。\r\n* $1 \\leq M \\leq 1\\,500$。\r\n* 对于任意一个广场，至多有 $7$ 条道路将它与其他广场联结。\r\n* 对于任意两个不同广场，可以通过若干道路互相到达。\r\n* 对于任意两个不同广场，联结它们的道路至多有 $1$ 条。\r\n\r\n子任务数据满足下列条件。\r\n#### 子任务 1（10 分）\r\n* $T = 1$。\r\n* $N \\leq 250$。\r\n\r\n#### 子任务 2（10 分）\r\n* $T = 2$。\r\n* $M = N - 1$。\r\n* 对于广场 $0$ 与广场 $N - 1$，只有 $1$ 条道路将它们与其他广场相连。对于其他广场，恰有 $2$ 条道路将它们与其他广场相连。\r\n\r\n#### 子任务 3（27 分）\r\n* $T = 3$。\r\n* $M = N - 1$。\r\n* 对于任意一个 $i$（$1 \\leq i \\leq N - 1$），至多经由 $8$ 个其他广场即可从广场 $0$ 到达广场 $i$。\r\n\r\n#### 子任务 4（30 分）\r\n* $T = 4$。\r\n* $M = N - 1$。\r\n\r\n#### 子任务 5（23 分）\r\n* $T = 5$。"}]}