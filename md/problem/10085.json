{"title":"「一本通 3.3 练习 2」虫洞 Wormholes","time_limit":1000,"memory_limit":512,"tags":["早于 2010","USACO Contest","负环"],"operation":{"submit":"https://loj.ac/problem/10085#submit_code","submissions":"https://loj.ac/submissions?problem_id=10085","statistics":"https://loj.ac/problem/10085/statistics/fastest","testdata":"https://loj.ac/problem/10085/testdata","discussion":"https://loj.ac/discussion/problem/10085"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"**原题来自：USACO 2006 Dec. Gold，原文见 [POJ 3259](http://poj.org/problem?id=3259)**\r\n\r\nJohn 在他的农场中闲逛时发现了许多虫洞。虫洞可以看作一条十分奇特的有向边，并可以使你返回到过去的一个时刻（相对你进入虫洞之前）。John 的每个农场有 $M$ 条小路（无向边）连接着 $N$（从 $1$ 到 $N$ 标号）块地，并有 $W$ 个虫洞。\r\n\r\n现在 John 想借助这些虫洞来回到过去（**在出发时刻之前回到出发点**），请你告诉他能办到吗。 John 将向你提供 $F$ 个农场的地图。没有小路会耗费你超过 $10^4$ 秒的时间，当然也没有虫洞回帮你回到超过 $10^4$ 秒以前。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行一个整数 $F$，表示农场个数；\r\n\r\n对于每个农场：\r\n\r\n第一行，三个整数 $N, M, W$；\r\n\r\n接下来 $M$ 行，每行三个数 $S, E, T$，表示在标号为 $S$ 的地与标号为 $E$ 的地中间有一条用时 $T$ 秒的小路；\r\n\r\n接下来 $W$ 行，每行三个数 $S, E, T$，表示在标号为 $S$ 的地与标号为 $E$ 的地中间有一条可以使 John 到达 $T$ 秒前的虫洞。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出共 $F$ 行，如果 John 能在第 $i$ 个农场实现他的目标，就在第 $i$ 行输出 `YES`，否则输出 `NO`。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n```plain\r\n2\r\n3 3 1\r\n1 2 2\r\n1 3 4\r\n2 3 1\r\n3 1 3\r\n3 2 1\r\n1 2 3\r\n2 3 4\r\n3 1 8\r\n```\r\n#### 样例输出\r\n```plain\r\nNO\r\nYES\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于全部数据，$1\\le F\\le 5,1\\le N\\le 500,1\\le M\\le 2500,1\\le W\\le 200,1\\le S,E\\le N,|T|\\le 10^4$。"}]}