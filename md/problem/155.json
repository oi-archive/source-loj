{"title":"Tutte 多项式","time_limit":10000,"memory_limit":1024,"tags":["模板","组合计数","集合幂级数","数学"],"operation":{"submit":"https://loj.ac/problem/155#submit_code","submissions":"https://loj.ac/submissions?problem_id=155","statistics":"https://loj.ac/problem/155/statistics/fastest","testdata":"https://loj.ac/problem/155/testdata","discussion":"https://loj.ac/discussion/problem/155"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"这是一道（集合幂级数对数和指数以及一些其他东西的）模板题。\r\n\r\n对于一个无向图 $G = (V, E)$，[Tutte 多项式](https://en.wikipedia.org/wiki/Tutte_polynomial)可以定义为 $T_G(x,y)=\\sum_{A\\subseteq E}(x-1)^{k(A)-k(E)}(y-1)^{k(A)+|A|-|V|}$，其中 $k(E)$ 表示图 $(V, E)$ 的连通分量数。它还有一些看起来更简洁自然的定义和很多优秀的性质，但在这题只需要知道这个定义。\r\n\r\n在一些 $(x, y)$ 上，Tutte 多项式和一些计数问题相关。一个图的 Tutte 多项式等于它的所有连通分量的 Tutte 多项式之积，为了方便，以下假设图 $G$ 连通。\r\n\r\n - 容易观察到 $T_G(1, 1)$ 是 $G$ 的生成树（即无环连通生成子图）数量，$T_G(2, 1)$ 是 $G$ 的生成森林（即无环生成子图）数量，$T_G(1, 2)$ 为 $G$ 的连通生成子图数量，$T_G(2, 2)$ 是 $G$ 的生成子图数量，即 $2^{|E|}$。\r\n - $y=0$ 时有 $P_G(k)=(-1)^{|V|-k(E)}k^{k(E)}T_G(1-k, 0)$，$P_G(k)$ 表示 $G$ 的[色多项式](https://en.wikipedia.org/wiki/Chromatic_polynomial)，是 $G$ 的顶点 $k$ 染色的数量。\r\n   - 特别地，$T_G(2, 0)$ 是 $G$ 的[无环定向](https://en.wikipedia.org/wiki/Acyclic_orientation)数量。\r\n - $x=0$ 时有 $C_G(k)=(-1)^{|E|-|V|+k(E)}T_G(0, 1-k)$，$C_G(k)$ 表示 $G$ 的[流多项式](https://en.wikipedia.org/wiki/Nowhere-zero_flow#Flow_polynomial)，是 $G$ 的无处为零 $k$-流的数量。\r\n   - 特别地，$T_G(0, 2)$ 是 $G$ 的[强连通定向](https://en.wikipedia.org/wiki/Strong_orientation)数量。\r\n\r\n对一个无重边无自环的图 $G=(V, E)=(\\{0, 1, \\ldots, n-1\\}, E)$，求 $T_G(x, y) \\bmod 998244353$。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第 $1$ 行：$n$\r\n\r\n第 $2+i$ 行（$0 \\leq i \\leq n−1$）：$G_{i, 0}\\ G_{i, 1}\\ \\ldots G_{i, n-1}$，$G_{i, j}$ 为 $0$ 表示 $(i, j) \\notin E$ ，为 $1$ 表示 $(i, j) \\in E$\r\n\r\n第 $2+n$ 行：$x\\ y$"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"第 $1$ 行：$T_G(x, y) \\bmod 998244353$"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n```plain\r\n5\r\n0 1 1 0 1\r\n1 0 0 1 1\r\n1 0 0 1 1\r\n0 1 1 0 0\r\n1 1 1 0 0\r\n[x] [y]\r\n```\r\n`[x]` 和 `[y]` 是输入的 $x$ 和 $y$，样例输出中给出了一些可能的 $(x, y)$ 对应的输出。\r\n\r\n#### 样例输出\r\n|$(x, y)$|$T_G(x, y) \\bmod 998244353$|\r\n|-|-|\r\n|$(0, 1)$|$6$|\r\n|$(0, 2)$|$24$|\r\n|$(1, 0)$|$10$|\r\n|$(1, 1)$|$24$|\r\n|$(1, 2)$|$52$|\r\n|$(2, 0)$|$60$|\r\n|$(2, 1)$|$86$|"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"* $1 \\leq n \\leq 21$\r\n* $G_{i, j} \\in \\{0, 1\\}, G_{i, j} = G_{j, i}, G_{i, i} = 0$\r\n* $0 \\leq x, y < 998244353$\r\n\r\n#### 子任务\r\n\r\n1. （16 分）$n \\leq 7$\r\n2. （20 分）$n \\leq 11$\r\n2. （14 分）$n \\leq 14$\r\n3. （25 分）$n \\leq 18$\r\n4. （25 分）没有附加限制"}]}