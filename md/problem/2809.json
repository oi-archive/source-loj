{"title":"「COCI 2014.11.08」NORMA","time_limit":3000,"memory_limit":64,"tags":["2014","COCI"],"operation":{"submit":"https://loj.ac/problem/2809#submit_code","submissions":"https://loj.ac/submissions?problem_id=2809","statistics":"https://loj.ac/problem/2809/statistics/fastest","testdata":"https://loj.ac/problem/2809/testdata","discussion":"https://loj.ac/discussion/problem/2809"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"**译自 [COCI 2014.11.08](http://www.hsin.hr/coci/archive/2014_2015/) T6.** ***[NORMA](https://hsin.hr/coci/archive/2014_2015/contest2_tasks.pdf)***\r\n\r\n在 Mirko 生日那天，他收到了祖母送他的一个数列 $A$。Mirko 居住的小镇上有一户人家专门收购数列（~~什么人啊~~）。对于一个数列 $L$，它的价值 $v_L=\\min\\{L_i\\}\\times \\max\\{L_i\\}\\times \\mathit{len}_L$（即数列的最小值，最大值与长度的积）。Mirko 计算了 $A$ 的所有子串的价值之和。  \r\n为了检查他的结果，你也要这么做。答案对 $10^9$ 取模。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行一个正整数$N$。  \r\n接下来 $N$ 行，每行一个正整数 $a_i$，描述了 Mirko 的数列 $A$。 "},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"一行代表所有子串的价值之和对 $10^9$ 取模的结果。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n2\r\n1\r\n3\r\n```\r\n\r\n#### 样例输出 1\r\n```plain\r\n16\r\n```\r\n\r\n#### 样例说明 1\r\n所有子串分别为 $(1),(3),(1,3)$。\r\n\r\n#### 样例输入 2\r\n```plain\r\n4\r\n2\r\n4\r\n1\r\n4\r\n```\r\n\r\n#### 样例输出 2\r\n```plain\r\n109\r\n```\r\n\r\n#### 样例说明 2\r\n所有子串分别为 $(2),(4),(1),(4),(2,4),(4,1),(1,4),(2,4,1),(4,1,4),(2,4,1,4)$。\r\n\r\n#### 样例输入 3\r\n```plain\r\n6\r\n8\r\n1\r\n3\r\n9\r\n7\r\n4\r\n```\r\n\r\n#### 样例输出 3\r\n```plain\r\n1042\r\n```\r\n\r\n"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于 $40\\%$ 的数据，$N<5000$；  \r\n对于 $100\\%$ 的数据，$1\\leq N \\leq 5\\times 10^5,1\\leq a_i \\leq 10^8$。"}]}