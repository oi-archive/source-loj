{"title":"「雅礼集训 2018 Day2」农民","time_limit":1000,"memory_limit":128,"tags":["雅礼集训","2018","线段树","树链剖分","数据结构"],"operation":{"submit":"https://loj.ac/problem/6498#submit_code","submissions":"https://loj.ac/submissions?problem_id=6498","statistics":"https://loj.ac/problem/6498/statistics/fastest","testdata":"https://loj.ac/problem/6498/testdata","discussion":"https://loj.ac/discussion/problem/6498"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"「搞 OI 不如种田。」\r\n\r\n小 D 在家种了一棵二叉树，第 $i$ 个结点的权值为 $a_i$。\r\n\r\n小 D 为自己种的树买了肥料，每天给树施肥。\r\n\r\n可是几天后，小 D 却发现树上有几个结点枯死了，他这才发现，自己买的肥料是二叉搜索树专用版。\r\n\r\n二叉搜索树是一种二叉树，满足每个结点的权值大于左子树内所有点的权值，小于右子树内所有点的权值。\r\n\r\n二叉搜索树专用版肥料是这么工作的：首先，假设所有节点权值互不相同（小 D 的二叉树可能不满足），每种权值对应一种肥料，所有肥料会从根进入树中，如果一种肥料对应的权值等于当前结点权值，这种肥料会被当前结点完全吸收，否则若肥料对应的权值小于当前结点权值，肥料会流向左子树，否则流向右子树，如果流向的子树为空，肥料只好流失蒸发了。显然，如果树是二叉搜索树，所有节点都能吸收到肥料。\r\n\r\n小 D 觉得自己还能抢救一下，他会进行若干次操作，每次操作修改一个点的权值或者翻转一个子树（子树内所有节点左右儿子互换）。在操作过程中，他有时会想知道一个点当前是否能吸收到肥料，以决定之后如何操作，请你帮帮可怜的小 D 吧。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行两个正整数 $n, m$，分别表示节点数和操作数。\r\n\r\n接下来 $n$ 行，每行三个非负整数，其中第 $i$ 行第一个整数表示 $a_i$，后两个数分别表示 $i$ 号点的左右儿子，没有则为 $0$。\r\n\r\n接下来 $m$ 行，每行先给出两个正整数 ${\\rm opt}, x$。若 $\\rm opt = 1$，接下来还有一个整数 $y$，表示把结点 $x$ 的权值修改为 $y$；若 $\\rm opt = 2$，表示翻转以 $x$ 为根的子树；若 $\\rm opt = 3$，表示查询 $x$ 号点是否能吸收到肥料。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"对于每个询问，输出一行 `YES` 或 `NO` 表示答案。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n3 7\r\n10 2 3\r\n5 0 0\r\n5 0 0\r\n3 1\r\n3 2\r\n3 3\r\n1 3 100\r\n3 3\r\n2 1\r\n3 3\r\n```\r\n\r\n#### 样例输出 1\r\n```plain\r\nYES\r\nYES\r\nNO\r\nYES\r\nNO\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于全部数据， $1 \\leq n, m \\leq 10^5, 0 \\leq a_i, y \\leq 10^9$。\r\n\r\n- 子任务 $\\rm 1(points: 20)$：$n, m \\leq 5000$\r\n- 子任务 $\\rm 2(points: 30)$：$\\rm opt \\neq 2$\r\n- 子任务 $\\rm 3(points: 50)$：无特殊限制"}]}