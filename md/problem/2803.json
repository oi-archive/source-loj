{"title":"「CCC 2018」最大战略储备","time_limit":1000,"memory_limit":256,"tags":["2018","CCC"],"operation":{"submit":"https://loj.ac/problem/2803#submit_code","submissions":"https://loj.ac/submissions?problem_id=2803","statistics":"https://loj.ac/problem/2803/statistics/fastest","testdata":"https://loj.ac/problem/2803/testdata","discussion":"https://loj.ac/discussion/problem/2803"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"**题目译自 [CCC 2018](https://cemc.math.uwaterloo.ca/contests/computing/2018/) S5.** ***[Maximum Strategic Savings](https://cemc.math.uwaterloo.ca/contests/computing/2018/stage%201/seniorEF.pdf)***\r\n\r\n有 $N$ 个星球，编号为 $1\\ldots N$。每个星球有 $M$ 座城市，编号为 $1\\ldots M$。我们将 $e$ 星球上的城市 $f$ 记作 $(e,\\,f)$。\r\n\r\n有 $N\\times P$ 条双向航线，对于每个星球 $e(1\\le e\\le N)$，有 $P$ 条航线，编号为 $1$ 到 $P$。第 $i$ 条航线连接城市 $(e,\\,a_i)$ 和 $(e,\\,b_i)$，且每天需要花费 $c_i$ 的代价维护。\r\n\r\n有 $M\\times Q$ 个双向港口。对于所有编号为 $f(1\\le f\\le M)$ 的城市，有 $Q$ 个港口，编号为 $1$ 到 $Q$。第 $j$ 个港口可以连接城市 $(x_j,\\,f)$ 和 $(y_j,\\,f)$，且每天需要花费 $z_j$ 的代价维护。\r\n\r\n现在需要拆除一些港口和（或）取消一些航线，使得城市之间仍能保持联通，且节省的代价之和最大。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行四个整数，分别为 $N,\\,M,\\,P,\\,Q\\ (0\\le N,\\,M,\\,P,\\,Q\\le10^5)$。\r\n\r\n接下来 $P$ 行，每行三个整数 $a_i,\\,b_i,\\,c_i(1\\le a_i,\\,b_i\\le M,\\,1\\le c_i\\le10^8)$。\r\n\r\n再接下来 $Q$ 行，每行三个整数 $x_j,\\,y_j,\\,z_j(1\\le x_j,\\,y_j\\le N,\\,1\\le z_j\\le 10^8)$。\r\n\r\n数据保证城市之间两两联通，可能有重边或自环。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出一行一个整数表示每天最多能节省的代价之和。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例 1 输入\r\n```plain\r\n2 2 1 2\r\n1 2 1\r\n2 1 1\r\n2 1 1\r\n```\r\n#### 样例 1 输出\r\n```plain\r\n3\r\n```\r\n#### 样例 2 输入\r\n```plain\r\n2 3 4 1\r\n2 3 5\r\n3 2 7\r\n1 2 6\r\n1 1 8\r\n2 1 5\r\n```\r\n#### 样例 2 输出\r\n```plain\r\n41\r\n```\r\n#### 样例 2 解释\r\n一种可行的最优解是关闭城市 $(1,\\,1)$ 与 $(1,1)$、$(2,\\,1)$ 与 $(2,\\,1)$、$(1,\\,1)$ 与 $(1,\\,2)$、$(1,\\,3)$ 与 $(1,\\,2)$、$(2,\\,3)$ 与 $(2,\\,2)$ 之间的航线；并关闭城市 $(2,\\,3)$ 与 $(1,\\,3)$ 间的港口。最终可以节省 $8 + 8 + 6 + 7 + 7 + 5 = 41$ 的代价。"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于 $\\frac{2}{15}$ 的数据，$P,\\,Q\\le100$，且对于所有的 $1\\le i\\le P$，都有 $c_i=1$；对于所有的 $1\\le j\\le Q$，都有 $z_j=1$；\r\n\r\n对于另外 $\\frac{2}{15}$ 的数据，$P,\\,Q\\le 200$；\r\n\r\n对于另外 $\\frac{5}{15}$ 的数据，$N,\\,M\\le 200$；\r\n\r\n对于全部的数据，$1\\le N,\\,M,\\,P,\\,Q\\le10^5$。"}]}