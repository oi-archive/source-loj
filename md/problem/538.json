{"title":"「LibreOJ NOIP Round #1」数列递推","time_limit":1000,"memory_limit":512,"tags":["LibreOJ NOIP Round","数学","递推","复杂度分析"],"operation":{"submit":"https://loj.ac/problem/538#submit_code","submissions":"https://loj.ac/submissions?problem_id=538","statistics":"https://loj.ac/problem/538/statistics/fastest","testdata":"https://loj.ac/problem/538/testdata","discussion":"https://loj.ac/discussion/problem/538"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"sosusosu 虐爆 OI 之后成为了一名文化课选手。一天，他做作业碰到了一堆数列问题，每道题给出的数列都是以下形式：\r\n\r\n> 给定一个下标从 $0$ 开始，无限长的整数列 $\\{a_i\\},\\ i\\in \\mathbb{N}$，已知 $a_0,a_1$ 的值，以及递推式 $a_{i+2}=k a_{i+1}+a_i,\\ i\\in\\mathbb{N},k\\in {\\mathbb{N}^+}$。\r\n\r\nsosusosu 研究了这些数列，发现它们十分优美充满人类智慧，于是决定出一道 OI 题。\r\n\r\nsosusosu 给了你一个集合 $S\\subset \\mathbb{N}$，他想问你对于 $S$ 中的每个数 $s_i$，使得 $a_{s_i}$ 最大的 $s_i$ 和使得 $a_{s_i}$ 最小的 $s_i$ 分别是多少。如果这样的 $s_i$ 有多个，请你回答最小的一个。\r\n\r\n另外，sosusosu 准备对他作业中碰到的每个数列都让你回答一次，不过每次的集合 $S$ 是一样的。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"输入第一行一个整数 $m$ 表示 $S$ 中元素个数。  \r\n第二行 $m$ 个整数 $s_1,s_2,\\cdots ,s_m$ 表示 $S$ 中的元素。保证它们是非负整数且严格递增（即 $s_i<s_{i+1}$）。  \r\n第三行一个整数 $n$ 表示询问的数列个数。  \r\n接下来 $n$ 行每行三个整数 $a_0, a_1, k$ 描述一个数列。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出共 $n$ 行，每行依次输出两个整数 $\\mathrm{maxsi},\\mathrm{minsi}$，依次表示 $S$ 的元素 $s_i$ 中，使得 $a_{s_i}$ 最大的 $s_i$ 和使得 $a_{s_i}$ 最小的 $s_i$ 的值。如果这样的 $s_i$ 有多个，请你回答最小的一个。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n8\r\n1 2 3 4 5 6 7 8\r\n2\r\n10 -6 1\r\n0 0 1\r\n```\r\n\r\n#### 样例输出 1\r\n```plain\r\n2 1\r\n1 1\r\n```\r\n\r\n#### 样例解释 1\r\n第一个数列的前 $9$ 项分别为 $10,-6,4,-2,2,0,2,2,4$，使得 $a_{s_i}$ 最大的 $s_i$ 为 $2$ 和 $8$（$a_2=a_8=4$）其中 $2$ 较小，使得 $a_{s_i}$ 最小的 $s_i$ 为 $1$（$a_1=-6$）。  \r\n第二个数列每项都等于 $0$，因此 $S$ 中的每个元素 $s_i$ 都既使 $a_{s_i}$ 最大也使 $a_{s_i}$ 最小，故答案是 $S$ 中最小元素。\r\n\r\n#### 样例输入 2\r\n```plain\r\n3\r\n0 1 2\r\n2\r\n-2 3 1\r\n3 -2 2\r\n```\r\n\r\n#### 样例输出 2\r\n```plain\r\n1 0\r\n0 1\r\n```\r\n\r\n#### 样例解释 2\r\n第一个数列的前 $4$ 项分别为 $-2,3,1,4$，使得 $a_{s_i}$ 最大的 $s_i$ 为 $1$（$a_1=3$），使得 $a_{s_i}$ 最小的 $s_i$ 为 $0$（$a_0=-2$）。  \r\n第二个数列的前 $4$ 项分别为 $3,-2,-1,-4$，使得 $a_{s_i}$ 最大的 $s_i$ 为 $0$（$a_0=3$），使得 $a_{s_i}$ 最小的 $s_i$ 为 $1$（$a_1=-2$）。  \r\n\r\n#### 样例输入 3\r\n```plain\r\n29\r\n2 4 8 16 32 64 128 256 512 1024 2048 4096 8192 16384 32768 65536 131072 262144 524288 1048576 2097152 4194304 8388608 16777216 33554432 67108864 134217728 268435456 536870912\r\n4\r\n10000000 10000000 100\r\n9999984 -6180330 1\r\n9999984 -6180329 1\r\n-10000000 4142135 2\r\n```\r\n\r\n#### 样例输出 3\r\n```plain\r\n536870912 2\r\n2 536870912\r\n536870912 16\r\n8 536870912\r\n```\r\n\r\n#### 更多样例\r\n见附加文件（在页面上方下载）。其中除了前 3 个样例外还有约定分别和测试点 1, 9, 14 相同的样例各一个。"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于所有数据，$1\\le n\\le 3\\times 10^5$，$1\\le m\\le 10^5$，$0\\le s_i\\le 10^9$，$-10^7\\le a_0,a_1\\le 10^7$，$1\\le k\\le 5\\times 10^3$，保证 $s_i$ 严格单调递增。\r\n\r\n**注意，本题输入规模较大，请使用较快的方式读入。LOJ 上 C 语言的 `scanf`、C++ 的[关闭同步](http://en.cppreference.com/w/cpp/io/ios_base/sync_with_stdio)的 `cin`、Pascal 的 `read` 读入此题数据时间均在 50 ~ 200 毫秒之间。**\r\n\r\n所有测试数据的范围和特点如下表所示：  \r\n（未标明的以上述所有数据的限制为准）\r\n<!-- BEGIN: Migrated markdown table -->\n\n| 测试点编号 | $n,m$ 的限制 | $a_0,a_1,k$ 的范围 | 特殊限制 |\n|:-:|:-:|:-:|:-:|\n| 1 | $n,m\\le 100$ | $-100\\le a_0,a_1\\le 100,k\\le 10$ | $s_m\\le 10$ |\n| 2 | $n,m\\le 100$ | $-100\\le a_0,a_1\\le 100,k\\le 10$ | $s_m\\le 10$ |\n| 3 | $n,m\\le 100$ | $-100\\le a_0,a_1\\le 100,k\\le 10$ | $s_m\\le 10$ |\n| 4 | $n\\le 10^5$ | $k=1$ | - |\n| 5 | $n\\le 10^5$ | $k=1$ | - |\n| 6 | $n\\le 10^5$ | $k=1$ | - |\n| 7 | $n\\le 10^5$ | - | $a_0\\cdot a_1\\ge 0$（即 $a_0,a_1$ 不会一正一负） |\n| 8 | $n\\le 10^5$ | - | $\\|a_1\\|\\ge\\|a_0\\|$ |\n| 9 | $n\\le 10^5$ | - | $S$ 中元素都是偶数 |\n| 10 | $n\\le 10^5$ | - | $S$ 中元素都是偶数 |\n| 11 | $n\\le 10^5$ | - | $S$ 中元素都是偶数 |\n| 12 | $n\\le 10^5$ | $k\\le 10$ | $S$ 中元素都是偶数 |\n| 13 | $n\\le 10^5$ | $k\\le 100$ | $S$ 中元素都是偶数 |\n| 14 | $n\\le 10^5$ | $k\\le 1000$ | - |\n| 15 | $n\\le 10^5$ | - | - |\n| 16 | $n\\le 1.5\\times 10^5$ | $k\\le 10$ | - |\n| 17 | $n\\le 2\\times 10^5$ | $k\\le 100$ | - |\n| 18 | $n\\le 2.5\\times 10^5$ | $k\\le 1000$ | - |\n| 19 | - | - | - |\n| 20 | - | - | - |\n\n<!-- Migrated from original HTML table:\n<table class='ui table'>\r\n\t<thead>\r\n\t\t<tr>\r\n\t\t\t<th style='text-align: center'> 测试点编号 </th>\r\n\t\t\t<th style='text-align: center'> $n,m$ 的限制 </th>\r\n\t\t\t<th style='text-align: center'> $a_0,a_1,k$ 的范围 </th>\r\n\t\t\t<th style='text-align: center'> 特殊限制 </th>\r\n\t\t</tr>\r\n\t</thead>\r\n\t<tbody>\r\n\t\t<tr>\r\n\t\t\t<td style='text-align: center; border-right: rgba(34, 36, 38, 0.1) 1px solid;'>1</td>\r\n\t\t\t<td style='text-align: center; border-right: rgba(34, 36, 38, 0.1) 1px solid;' rowspan='3'> $n,m\\le 100$ </td>\r\n\t\t\t<td style='text-align: center; border-right: rgba(34, 36, 38, 0.1) 1px solid;' rowspan='3'> $-100\\le a_0,a_1\\le 100,k\\le 10$ </td>\r\n\t\t\t<td style='text-align: center' rowspan='3'> $s_m\\le 10$ </td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td style='text-align: center; border-right: rgba(34, 36, 38, 0.1) 1px solid;'>2</td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td style='text-align: center; border-right: rgba(34, 36, 38, 0.1) 1px solid;'>3</td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td style='text-align: center; border-right: rgba(34, 36, 38, 0.1) 1px solid;'>4</td>\r\n\t\t\t<td style='text-align: center; border-right: rgba(34, 36, 38, 0.1) 1px solid;' rowspan='12'> $n\\le 10^5$ </td>\r\n\t\t\t<td style='text-align: center; border-right: rgba(34, 36, 38, 0.1) 1px solid;' rowspan='3'> $k=1$ </td>\r\n\t\t\t<td style='text-align: center' rowspan='3'> - </td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td style='text-align: center; border-right: rgba(34, 36, 38, 0.1) 1px solid;'>5</td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td style='text-align: center; border-right: rgba(34, 36, 38, 0.1) 1px solid;'>6</td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td style='text-align: center; border-right: rgba(34, 36, 38, 0.1) 1px solid;'>7</td>\r\n\t\t\t<td style='text-align: center; border-right: rgba(34, 36, 38, 0.1) 1px solid;' rowspan='5'> - </td>\r\n\t\t\t<td style='text-align: center'> $a_0\\cdot a_1\\ge 0$（即 $a_0,a_1$ 不会一正一负） </td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td style='text-align: center; border-right: rgba(34, 36, 38, 0.1) 1px solid;'>8</td>\r\n\t\t\t<td style='text-align: center'> $|a_1|\\ge|a_0|$ </td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td style='text-align: center; border-right: rgba(34, 36, 38, 0.1) 1px solid;'>9</td>\r\n\t\t\t<td style='text-align: center' rowspan='5'> $S$ 中元素都是偶数 </td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td style='text-align: center; border-right: rgba(34, 36, 38, 0.1) 1px solid;'>10</td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td style='text-align: center; border-right: rgba(34, 36, 38, 0.1) 1px solid;'>11</td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td style='text-align: center; border-right: rgba(34, 36, 38, 0.1) 1px solid;'>12</td>\r\n\t\t\t<td style='text-align: center; border-right: rgba(34, 36, 38, 0.1) 1px solid;'> $k\\le 10$ </td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td style='text-align: center; border-right: rgba(34, 36, 38, 0.1) 1px solid;'>13</td>\r\n\t\t\t<td style='text-align: center; border-right: rgba(34, 36, 38, 0.1) 1px solid;'> $k\\le 100$ </td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td style='text-align: center; border-right: rgba(34, 36, 38, 0.1) 1px solid;'>14</td>\r\n\t\t\t<td style='text-align: center; border-right: rgba(34, 36, 38, 0.1) 1px solid;'> $k\\le 1000$ </td>\r\n\t\t\t<td style='text-align: center' rowspan='7'> - </td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td style='text-align: center; border-right: rgba(34, 36, 38, 0.1) 1px solid;'>15</td>\r\n\t\t\t<td style='text-align: center; border-right: rgba(34, 36, 38, 0.1) 1px solid;'> - </td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td style='text-align: center; border-right: rgba(34, 36, 38, 0.1) 1px solid;'>16</td>\r\n\t\t\t<td style='text-align: center; border-right: rgba(34, 36, 38, 0.1) 1px solid;'> $n\\le 1.5\\times 10^5$ </td>\r\n\t\t\t<td style='text-align: center; border-right: rgba(34, 36, 38, 0.1) 1px solid;'> $k\\le 10$ </td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td style='text-align: center; border-right: rgba(34, 36, 38, 0.1) 1px solid;'>17</td>\r\n\t\t\t<td style='text-align: center; border-right: rgba(34, 36, 38, 0.1) 1px solid;'> $n\\le 2\\times 10^5$ </td>\r\n\t\t\t<td style='text-align: center; border-right: rgba(34, 36, 38, 0.1) 1px solid;'> $k\\le 100$ </td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td style='text-align: center; border-right: rgba(34, 36, 38, 0.1) 1px solid;'>18</td>\r\n\t\t\t<td style='text-align: center; border-right: rgba(34, 36, 38, 0.1) 1px solid;'> $n\\le 2.5\\times 10^5$ </td>\r\n\t\t\t<td style='text-align: center; border-right: rgba(34, 36, 38, 0.1) 1px solid;'> $k\\le 1000$ </td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td style='text-align: center; border-right: rgba(34, 36, 38, 0.1) 1px solid;'>19</td>\r\n\t\t\t<td style='text-align: center; border-right: rgba(34, 36, 38, 0.1) 1px solid;' rowspan='2'> - </td>\r\n\t\t\t<td style='text-align: center; border-right: rgba(34, 36, 38, 0.1) 1px solid;' rowspan='2'> - </td>\r\n\t\t</tr>\r\n\t\t<tr>\r\n\t\t\t<td style='text-align: center; border-right: rgba(34, 36, 38, 0.1) 1px solid;'>20</td>\r\n\t\t</tr>\r\n\t</tbody>\r\n</table>\n-->\n\n<!-- END: Migrated markdown table -->"}]}