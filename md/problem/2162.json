{"title":"「POI2011 R2 Day1」垃圾运输 Garbage","time_limit":600,"memory_limit":256,"tags":["POI","2011","欧拉回路","图论","Special Judge"],"operation":{"submit":"https://loj.ac/problem/2162#submit_code","submissions":"https://loj.ac/submissions?problem_id=2162","statistics":"https://loj.ac/problem/2162/statistics/fastest","testdata":"https://loj.ac/problem/2162/testdata","discussion":"https://loj.ac/discussion/problem/2162"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"**译自 POI 2011 Round 2. Day 1. B「[Garbage](https://szkopul.edu.pl/problemset/problem/Oa79BU5CwOGRXG_BHQN1tZJ8/site/?key=statement)」**\r\n\r\n给定一张 $n$ 个点 $m$ 条边的无向图，每条边居黑白二色之一，且有一个黑或白的目标颜色。\r\n\r\n有一辆卡车，可以从任意一个结点开始，经过一个简单环（不经过重复边或起点以外结点的环）回到出发点，将所有经过边的颜色反转，即黑色变为白色，白色变为黑色。卡车可以从不同的结点出发行走若干次。\r\n\r\n请给出一个合法的方案，使得每条边最终都变为目标颜色，或判定不可行。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"输入的第一行包含两个空格分隔的正整数 $n$ 和 $m$（$1 \\leq n \\leq 100\\,000$，$1 \\leq m \\leq 1\\,000\\,000$），表示图的点数和边数。\r\n\r\n接下来 $m$ 行，每行包含四个空格分隔的正整数 $a, b, s, t$（$1 \\leq a \\lt b \\leq n$，$s, t \\in \\{0, 1\\}$），表示一条联结结点 $a$ 与 $b$ 的边，初始颜色和目标颜色分别为 $s$ 与 $t$。\r\n\r\n你可以认为若存在合法方案，则存在一个卡车经过总边数不超过 $5m$ 的方案。\r\n\r\n对于 $60\\%$ 分数的数据，有 $m \\leq 10\\,000$。\r\n"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"如果不存在合法方案，输出一行 `NIE`（波兰语「否」）；\r\n\r\n否则按下列格式输出任意一种方案：\r\n* 第一行包含一个整数 $k$，表示卡车行驶环路的总数；\r\n* 接下来 $k$ 行，每行描述一条环路：\r\n  * 首先是一个正整数 $k_i$ 表示环路经过的边数，后接一个空格；\r\n  * 接下来 $k_i + 1$ 个空格分隔的整数，依次表示环路上结点的编号。\r\n"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"细线=初始白色，粗线=初始黑色；  \r\n虚线=目标白色，实线=目标黑色。\r\n\r\n#### 样例输入 1\r\n```plain\r\n6 8\r\n1 2 0 1\r\n2 3 1 0\r\n1 3 0 1\r\n2 4 0 0\r\n3 5 1 1\r\n4 5 0 1\r\n5 6 0 1\r\n4 6 0 1\r\n```\r\n![smizad1.gif](https://ooo.0o0.ooo/2017/04/20/58f84297efb95.gif)\r\n\r\n#### 样例输出 1\r\n```plain\r\n2\r\n3 1 3 2 1\r\n3 4 6 5 4\r\n```\r\n\r\n#### 样例输入 2\r\n```plain\r\n6 8\r\n1 2 0 1\r\n2 3 1 0\r\n1 3 0 1\r\n2 4 0 0\r\n3 5 1 1\r\n4 5 0 1\r\n5 6 0 1\r\n4 6 0 0\r\n```\r\n![smizad2.gif](https://ooo.0o0.ooo/2017/04/20/58f84298d5bdb.gif)\r\n\r\n#### 样例输出 2\r\n```plain\r\nNIE\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"Task author: Michal Pilipczuk.  \r\nSPJ: ceba.  \r\nTranslation: Red Scarf."}]}