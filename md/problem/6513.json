{"title":"「雅礼集训 2018 Day10」足球大战","time_limit":1000,"memory_limit":64,"tags":["雅礼集训","2018","概率与期望"],"operation":{"submit":"https://loj.ac/problem/6513#submit_code","submissions":"https://loj.ac/submissions?problem_id=6513","statistics":"https://loj.ac/problem/6513/statistics/fastest","testdata":"https://loj.ac/problem/6513/testdata","discussion":"https://loj.ac/discussion/problem/6513"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"有一场足球比赛，还有 $n$ 秒就要结束了，比分还是 $0:0$。\r\n\r\n主队每秒进球概率为 $p$，客队每秒进球概率为 $q$，求主队获胜概率。\r\n\r\n注意，一秒钟一个队最多进一个球，主队获胜当且仅当主队进球比客队多。\r\n\r\n为了避免精度误差，把最后的答案化成最简分数 $\\frac{x}{y}$，输出 $x$ 和 $y$ 关于 $(10^9+7)$ 的逆元的乘积即可。\r\n\r\n根据费马小定理， $\\frac{x}{y} \\bmod (10^9+7) = x\\times y^{10^9+5} \\bmod (10^9+7)$.\r\n\r\n$p$ 和 $q$ 将通过一种特别的方式给出：给出 $pa, pb, qa, qb$，$p = \\frac{pa}{pb}, q = \\frac{qa}{qb}$。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行一个正整数 $n$，表示剩余的秒数。\r\n\r\n第二行两个整数 $pa, pb, p = \\frac{pa}{pb}$，表示主队每秒进球期望数。\r\n\r\n第三行两个整数 $qa, qb, q = \\frac{qa}{qb}$，表示客队每秒进球期望数。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出一行一个整数，表示把答案化成最简分数 $\\frac{x}{y}$ 后， $x$ 乘以 $y$ 的逆元关于 $(10^9+7)$ 取模后的值。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n1\r\n1 2\r\n1 2\r\n```\r\n\r\n#### 样例输出 1\r\n```plain\r\n250000002\r\n```\r\n\r\n#### 样例解释 1\r\n\r\n比赛还剩 $1$ 秒，主队获胜当且仅当主队进球且客队不进球，概率为 $\\frac{1}{2} \\times (1 - \\frac{1}{2}) = \\frac{1}{4}$， $4$ 关于 $10^9+7$ 的逆元为 $250 000 002$。\r\n\r\n#### 样例输入 2\r\n```plain\r\n10\r\n1 1\r\n1 3\r\n```\r\n\r\n#### 样例输出 2\r\n```plain\r\n762519270\r\n```\r\n\r\n#### 样例解释 2\r\n\r\n获胜概率为 $1 - \\left(\\frac{1}{3}\\right)^{10}$。\r\n\r\n\r\n#### 样例输入 3\r\n```plain\r\n233333\r\n233 2333333\r\n566 5666666\r\n```\r\n\r\n#### 样例输出 3\r\n```plain\r\n46387011\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"| 测试点编号 | $n$ | 特殊情况 |\r\n| :-: | :-: | :-: | :-: |\r\n| 1 | $=1$ | | \r\n| 2 | $ \\leq 2$ | | \r\n| 3 | $ \\leq 5$ | | \r\n| 4 | $ \\leq 10$ | | \r\n| 5 | $ \\leq 20$ | | \r\n| 6 | $ \\leq 50$ | $p = 0$ | \r\n| 7 | $ \\leq 100$ | | \r\n| 8 | $ \\leq 200$ | $q = 1$ | \r\n| 9 | $ \\leq 500$ | | \r\n| 10 | $ \\leq 1000$ | $p = q = \\frac{1}{2}$ | \r\n| 11 | $ \\leq 2000$ | | \r\n| 12 | $ \\leq 5000$ | $q = 0$ | \r\n| 13 | $ \\leq 10^4$ | | \r\n| 14 | $ \\leq 2\\times 10^4$ | $p = q$ | \r\n| 15 | $ \\leq 5\\times 10^4$ | | \r\n| 16 | $ \\leq 10^5$ | $p = 1$ | \r\n| 17 | $ \\leq 10^5$ | | \r\n| 18 | $ \\leq 2\\times 10^5$ | $p = 1$ | \r\n| 19 | $ \\leq 5\\times 10^5$ | | \r\n| 20 | $ \\leq 10^6$ | $q = 0$ | \r\n| 21 | $ \\leq 10^6$ | | \r\n| 22 | $ \\leq 2\\times 10^6$ | $p = q$ | \r\n| 23 | $ \\leq 5\\times 10^6$ | | \r\n| 24 | | $p = q$ | \r\n| 25 | | | |\r\n\r\n对于所有的数据， $1 \\leq n \\leq 10^7, 0 \\leq pa,qa \\leq 10^9, 1 \\leq pb, qb \\leq 10^9, pa \\leq pb, qa \\leq qb$。注意常数优化！注意内存限制！\r\n"}]}