{"title":"「EC Final 2019」狄利克雷 k 次根 加强版","time_limit":1000,"memory_limit":256,"tags":["2019","EC Final","生成函数","数论"],"operation":{"submit":"https://loj.ac/problem/6713#submit_code","submissions":"https://loj.ac/submissions?problem_id=6713","statistics":"https://loj.ac/problem/6713/statistics/fastest","testdata":"https://loj.ac/problem/6713/testdata","discussion":"https://loj.ac/discussion/problem/6713"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"题面参考 [Codeforces Gym 102471 C. Dirichlet $k$-th root](https://codeforces.com/gym/102471/problem/C)。\r\n\r\n**请注意，唯一的不同为数据范围。**\r\n\r\n定义两个函数 $f, g: \\{1, 2, \\dots, n\\} \\rightarrow \\mathbb Z$ 的狄利克雷卷积 $f * g$ 为：\r\n\r\n$$\r\n(f * g)(n) = \\sum_{d | n} f(d)g(\\frac nd)\r\n$$\r\n\r\n我们定义 $g = f^k$ 即 $k$ 次幂为：\r\n\r\n$$\r\nf^{k}=\\underbrace {f * \\dots * f} _{k~{\\textrm {个}}}\r\n$$\r\n\r\n在本题中，我们想要解决这个问题的逆问题：给你 $g$ 和 $k$，你需要找到一个函数 $f$ 使得 $g = f^k$。\r\n\r\n另外，保证 $g(1)=1$，你需要保证 $f(1)=1$。所有的运算在 $\\mathbb F_p$ 上进行，其中 $p = 998244353$，这意味着狄利克雷卷积为 $(f*g)(n) = \\left(\\sum_{d|n} f(d)g(\\frac nd)\\right) \\bmod p$。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行输入两个正整数 $n, k$。\r\n\r\n第二行输入 $n$ 个整数，$g(1), g(2), \\dots, g(n)$，保证 $0\\le g(i) < 998244353, g(1) = 1$。\r\n"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"如果无解，输出 $-1$。\r\n\r\n否则，一行输出 $n$ 个整数 $f(1), f(2), \\dots, f(n)$，要求 $0\\le f(i) < 998244353, f(1)=1$，如果有多个解，你只需要输出任意一个。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n\r\n```plain\r\n5 2\r\n1 8 4 26 6\r\n```\r\n\r\n#### 样例输出 1\r\n\r\n```plain\r\n1 4 2 5 3\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于 $50\\%$ 的数据，保证 $n\\le 10^5$。\r\n\r\n对于 $100\\%$ 的数据，保证 $2\\le n\\le 10^6, 1\\le k < 998244353$。"}]}