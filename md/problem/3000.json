{"title":"「JOISC 2015 Day2」Road Development","time_limit":2000,"memory_limit":256,"tags":["2015","JOISC","DFS 序","树状数组"],"operation":{"submit":"https://loj.ac/problem/3000#submit_code","submissions":"https://loj.ac/submissions?problem_id=3000","statistics":"https://loj.ac/problem/3000/statistics/fastest","testdata":"https://loj.ac/problem/3000/testdata","discussion":"https://loj.ac/discussion/problem/3000"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"**译自 [JOISC 2015](https://www.ioi-jp.org/camp/2015/2015-sp-tasks/index.html) Day2 T3「[Road Development](https://www.ioi-jp.org/camp/2015/2015-sp-tasks/2015-sp-d2.pdf)」。**\r\n\r\n有一个 $ N $ 个点的无向图，一开始不存在任何边。给出 $ Q $ 个操作：\r\n\r\n+ $ 1\\ A_i\\ B_i $：如果 $ A_i $ 和 $ B_i $ 不连通，加入一条白色边。如果 $ A_i $ 和 $ B_i $ 连通，把在 $ A_i $ 到 $ B_i $ 的最短路上的白边都染黑。\r\n+ $ 2\\ A_i\\ B_i $：求出如果执行上述操作后，有多少条边被染黑了。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行包含两个整数 $ N $ 和 $ Q $，含义如题面所述。\r\n\r\n接下来 $ Q $ 行，第 $ i $ 行包含三个整数 $ T_i $，$ A_i $ 和 $ B_i $，表示一个操作，含义如题面所述。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"对于每个 $ T_i = 2 $ 的操作，如果 $ A_i $ 和 $ B_i $ 不连通，输出 $ -1 $，否则输出染黑的白边数目。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n3 7\r\n1 1 2\r\n2 2 1\r\n2 2 3\r\n1 2 1\r\n2 1 2\r\n1 2 3\r\n2 1 3\r\n```\r\n\r\n#### 样例输出 1\r\n```plain\r\n1\r\n-1\r\n0\r\n1\r\n```\r\n\r\n#### 样例输入 2\r\n```plain\r\n6 8\r\n1 1 3\r\n1 6 1\r\n1 2 5\r\n2 3 6\r\n1 3 6\r\n1 4 1\r\n2 4 3\r\n2 2 5\r\n```\r\n\r\n#### 样例输出 2\r\n```plain\r\n2\r\n1\r\n1\r\n```\r\n\r\n#### 样例输入 3\r\n```plain\r\n7 11\r\n1 5 1\r\n1 6 2\r\n1 1 3\r\n1 3 5\r\n1 5 7\r\n1 4 5\r\n1 4 1\r\n2 1 3\r\n2 3 7\r\n2 4 3\r\n2 5 6\r\n```\r\n\r\n#### 样例输出 3\r\n```plain\r\n0\r\n1\r\n0\r\n-1\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于全部数据，满足 $ 2 \\le N \\le 10^5, 1 \\le Q \\le 3 \\times 10^5, 1 \\le T_i \\le 2, 1 \\le A_i, B_i \\le N, A_i \\ne B_i $。\r\n\r\n本题共有 $ 5 $ 个子任务。每个子任务的分数和附加限制如下：\r\n\r\n| Subtask | 附加限制 | 分数 |\r\n|:-------:|:-------:|:---:|\r\n| 1 | $ N \\le 1000, Q \\le 3000 $ | 10 |\r\n| 2 | 存在一个 $P$ ($ 1 \\le P \\le Q - 1 $)，对于 $ T_i = 1 $ 的 $ i $ 有 $ 1 \\le i \\le P $ , 对于 $ T_i = 2 $ 的 $ i $ 有 $ P + 1 \\le i \\le Q $ | 25 |\r\n| 3 | 对于 $ T_i=1 $ 的 $ i $，要么 $ A_i $ 和 $ B_i $ 不连通，要么 $ A_i $ 和 $ B_i $ 所在的连通块有不超过 $ 200 $ 条边 | 25 |\r\n| 4 | 满足 $ T_i = 2$ 的 $ i $ ($1 \\le i \\le Q$) 不超过 $ 200 $ 个 | 25 |\r\n| 5 | 无附加限制 | 15 |\r\n"}]}