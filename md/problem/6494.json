{"title":"LJJ 的字符串","time_limit":3000,"memory_limit":1024,"tags":["后缀数组","差分"],"operation":{"submit":"https://loj.ac/problem/6494#submit_code","submissions":"https://loj.ac/submissions?problem_id=6494","statistics":"https://loj.ac/problem/6494/statistics/fastest","testdata":"https://loj.ac/problem/6494/testdata","discussion":"https://loj.ac/discussion/problem/6494"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"LJJ 拿到了一串来自火星的字符串。\r\n\r\n字符串中，每个字符都是一种火星字母，LJJ 将其转换为**小写英文字母 $\\texttt{a}\\sim \\texttt{z}$**，为了便于发现其中的奥秘。\r\n\r\n仔细看，这个字符串杂乱中带着有序，有许多重复的片段。于是，LJJ 请来了作为字符串分析专家的你，来帮他分析计算这个字符串的神秘度。\r\n\r\n**设 $n$ 是这个字符串的长度。**\r\n**设 $S[i,j]$ 表示字符串 $S$ 中第 $i$ 个位置到第 $j$ 个位置的连续子串（字符串下标从 $1$ 开始）。**\r\n\r\n若 $i$ , $j$ , $\\text{len}$ 同时满足\r\n* $1\\leqslant i<j\\leqslant i+\\text{len}-1<j+\\text{len}-1\\leqslant n$\r\n* $S[i,i+\\text{len}-1]=S[j,j+\\text{len}-1]$\r\n\r\n**则这个三元数对 $(i,j,\\text{len})$ 对 $S$ 的神秘度的贡献是 $\\text{len}$ 。**\r\n\r\n输入一个字符串，输出其**所有前缀的神秘度**。**由于这个值过大，所以请对 $10^9+7$ 取模并输出**。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"输入仅一行：仅由小写字母构成的字符串 $S$。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出共 $n$ 行，第 $i$ 行的整数是前 $i$ 个位置表示的前缀的神秘度。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\naaaaaa\r\n```\r\n#### 样例输出 1\r\n```plain\r\n0\r\n0\r\n2\r\n7\r\n19\r\n40\r\n```\r\n#### 样例输入 2\r\n```plain\r\nababab\r\n```\r\n#### 样例输出 2\r\n```plain\r\n0\r\n0\r\n0\r\n0\r\n3\r\n10\r\n```\r\n#### 样例输入 3\r\n```plain\r\naabababacbacbac\r\n```\r\n#### 样例输出 3\r\n```plain\r\n0\r\n0\r\n0\r\n0\r\n0\r\n3\r\n10\r\n22\r\n22\r\n22\r\n22\r\n22\r\n26\r\n35\r\n50\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于 $20\\%$ 的数据，$1\\leqslant n\\leqslant 1000$；  \r\n对于 $40\\%$ 的数据，$1\\leqslant n\\leqslant 5\\times 10^5$，且 $S$ 仅由 $\\texttt{a}$ 构成；  \r\n对于 $60\\%$ 的数据，$1\\leqslant n\\leqslant 10^5$；  \r\n对于 $100\\%$ 的数据，$1\\leqslant n\\leqslant 5\\times 10^5$。"}]}