{"title":"「LibreOJ NOI Round #2」黄金矿工","time_limit":2000,"memory_limit":512,"tags":["LibreOJ NOI Round","费用流","Link-Cut Tree","线段树","树链剖分","可并堆","线段树分治"],"operation":{"submit":"https://loj.ac/problem/574#submit_code","submissions":"https://loj.ac/submissions?problem_id=574","statistics":"https://loj.ac/problem/574/statistics/fastest","testdata":"https://loj.ac/problem/574/testdata","discussion":"https://loj.ac/discussion/problem/574"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"你是一处金矿的主人，并且有若干矿工要来这里挖黄金。\r\n\r\n这处宝藏有 $n$ 个可能的藏宝点，这 $n$ 个点构成了一棵有根树的结构。\r\n\r\n树上的每条边都是**有向**的，**从父亲指向儿子**，并且有个正整数权值 $c_i$，表示每有一个矿工从这条边走过，你会收取 $c_i$ 的过路费。\r\n\r\n每个矿工 $x$ 会从某一个藏宝点 $u$ 出发，并且有一个正整数权值 $P_x$，表示如果你允许他来挖宝，将会获得 $P_x$ 的入场费。\r\n\r\n某个藏宝点 $u$ 可能还会出现一块权值为 $Q_y$ 黄金，表示如果有矿工挖取了这个黄金，你会从中提走 $Q_y $的利润。\r\n\r\n一个矿工 $x$ 挖取一块黄金 $y$ 的收益是 $P_x+Q_y+\\sum_{e}{c_e}$，其中边 $e$ 在人 $x$ 和黄金 $y$ 的路径上。\r\n\r\n注意**一个矿工只能挖取一块黄金，一块黄金也只能被一个矿工挖取**。一个矿工只能挖取他沿着树上有向边能到的黄金，**同一条边在同一个挖取方案中可以被多个人经过**。\r\n\r\n一开始既没有黄金也没有矿工。\r\n\r\n我们需要支持 $q$ 次操作，每次操作有两种类型：\r\n\r\n+ $1$ $u$ $v$：表示在点 $u$ 上新出现了一个权为 $v$ 的矿工。\r\n+ $2$ $u$ $v$：表示在点 $u$ 上新出现了一块权为 $v$ 的黄金。\r\n\r\n你需要在每次操作后算出，如果让某些矿工去挖取黄金，那么可能的最大收益是多少。\r\n\r\n**注意你并不需要最大化挖到黄金的人数量**。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"从标准输入读入数据。\r\n\r\n第一行两个整数 $n$ 和 $q$，表示树的节点和操作数。\r\n\r\n接下来 $n-1$ 行，每行三个正整数 $u,v,c$，表示有一条权为 $c$ 的边从点 $u$ 指向点 $v$。\r\n\r\n接下来 $q$ 行每行描述一次操作。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出到标准输出。\r\n\r\n对于每次操作，输出一个整数表示这次操作执行后的答案。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n\r\n```plain\r\n5 5\r\n1 2 1\r\n1 3 1\r\n1 4 1\r\n4 5 1\r\n1 3 5\r\n2 3 1\r\n1 4 8\r\n1 1 1\r\n2 1 10\r\n```\r\n\r\n#### 样例输出 1\r\n\r\n```plain\r\n0\r\n6\r\n6\r\n6\r\n17\r\n```\r\n\r\n\r\n#### 样例解释 1\r\n\r\n第二次操作后，最优匹配方案是，让第一次操作添加的矿工挖去第二次操作添加的黄金。\r\n\r\n第五次操作后，最优匹配方案为，在前一方案的基础上，让第四次操作添加的矿工挖去第五次操作添加的黄金。\r\n\r\n#### 样例 2\r\n\r\n见下发文件。\r\n\r\n#### 样例 3\r\n\r\n见下发文件。"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于所有数据，保证 $n,q \\le 10^5$，并且所有树边的权均为不超过 $10^3$ 的正整数，所有矿工和黄金的权均为不超过 $10^8$ 的正整数。\r\n\r\n| 测试点  |   $n=$   |  $q= $   | 特殊性质 |\r\n| :-----: | :------: | :------: | :------: |\r\n|    1    |   $8$    |   $8$    |    C2    |\r\n|    2    |  $300$   |  $300$   |    C2     |\r\n|    3,4    |  $4 * 10^3$   |  $4 * 10^3$   |    C2    |\r\n| 5 ~ 10 | $ 10^3 $ | $ 5 * 10^4 $ |    C1    |\r\n| 11 ~ 13 | $ 10^3 $ | $ 5 * 10^4 $ |    C2    |\r\n| 14,15 |  $10^5$  |  $5 * 10^4$  |    A1     |\r\n| 16,17 |  $10^5$  |  $5 * 10^4$  |    B1    |\r\n| 18,19 |  $10^5$  |  $5 * 10^4$  |    C1     |\r\n| 20 ~ 24 |  $10^5$  |  $5 * 10^4$  |    C2    |\r\n| 25 |  $10^5$  |  $10^5$  |    C2    |\r\n\r\n#### 表格中的特殊性质\r\n\r\n+ A：第 $i$ 条边从 $i$ 指向 $i+1$\r\n+ B：第 $i$ 条边从 $\\lfloor \\frac{i+1}{2} \\rfloor$ 指向 $i+1$\r\n+ C：在树的形态上无特殊约束\r\n+ 1：保证所有 $1$ 操作都在 $2$ 操作之后\r\n+ 2：在操作类型上无特殊约束\r\n"}]}