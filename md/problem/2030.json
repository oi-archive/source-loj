{"title":"「SDOI2016」储能表","time_limit":1000,"memory_limit":128,"tags":["SDOI","2016","数位 DP","数学","DP","异或"],"operation":{"submit":"https://loj.ac/problem/2030#submit_code","submissions":"https://loj.ac/submissions?problem_id=2030","statistics":"https://loj.ac/problem/2030/statistics/fastest","testdata":"https://loj.ac/problem/2030/testdata","discussion":"https://loj.ac/discussion/problem/2030"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"有一个 $ n $ 行 $ m $ 列的表格，行从 $ 0 $ 到 $ n - 1 $ 编号，列从 $ 0 $ 到 $ m - 1 $ 编号。  \r\n每个格子都储存着能量。最初，第 $ i $ 行第 $ j $ 列的格子储存着 $ (i \\mathbin{\\text{xor}} j) $ 点能量。所以，整个表格储存的总能量是，\r\n\r\n$$ \\sum\\limits_{i = 0} ^ {n - 1} \\sum\\limits_{j = 0} ^ {m - 1} (i \\mathbin{\\text{xor}} j) $$\r\n\r\n随着时间的推移，格子中的能量会渐渐减少。一个时间单位，每个格子中的能量都会减少 $ 1 $。显然，一个格子的能量减少到 $ 0 $ 之后就不会再减少了。  \r\n也就是说，$ k $ 个时间单位后，整个表格储存的总能量是，\r\n\r\n$$ \\sum\\limits_{i = 0} ^ {n - 1} \\sum\\limits_{j = 0} ^ {m - 1} \\max((i \\mathbin{\\text{xor}} j) - k, 0) $$\r\n\r\n给出一个表格，求 $ k $ 个时间单位后它储存的总能量。  \r\n由于总能量可能较大，输出时对 $ p $ 取模。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行一个整数 $ T $，表示数据组数。  \r\n接下来 $ T $ 行，每行四个整数 $ n $、$ m $、$ k $、$ p $。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"共 $T$ 行，每行一个数，表示总能量对 $p$ 取模后的结果。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n```plain\r\n3\r\n2 2 0 100\r\n3 3 0 100\r\n3 3 1 100\r\n```\r\n\r\n#### 样例输出\r\n```plain\r\n2\r\n12\r\n6\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"测试点 1 ~ 2：$ T = 5000 $，$ n \\leq 100 $，$ m \\leq 100 $，$ k \\leq 100 $，$ p \\leq 10 ^ 9 $；  \r\n测试点 3：$ T = 5000 $，$ n \\leq 10 ^ {18} $，$ m \\leq 10 ^ {18} $，$ k = 0 $，$ p \\leq 10 ^ 9 $；  \r\n测试点 4：$ T = 5000 $，$ n \\leq 10 ^ {18} $，$ m \\leq 10 ^ {18} $，$ k = 1 $，$ p \\leq 10 ^ 9 $；  \r\n测试点 5：$ T = 5000 $，$ n \\leq 10 $，$ m \\leq 10 ^ {18} $，$ k \\leq 10 $，$ p \\leq 10 ^ 9 $；  \r\n测试点 6：$ T = 1 $，$ n \\leq 10 ^ 5 $，$ m \\leq 10 ^ {18} $，$ k \\leq 10 ^ 5 $，$ p \\leq 10 ^ 9 $；  \r\n测试点 7：$ T = 1 $，$ n \\leq 10 ^ {18} $，$ m \\leq 10 ^ {18} $，$ k \\leq 10 ^ {18} $，$ p \\leq 10 ^ 9 $；  \r\n测试点 8：$ T = 100 $，$ n \\leq 10 ^ {18} $，$ m \\leq 10 ^ {18} $，$ k \\leq 10 ^ {18} $，$ p \\leq 10 ^ 9 $；  \r\n测试点 9 ~ 10：$ T = 5000 $，$ n \\leq 10 ^ {18} $，$ m \\leq 10 ^ {18} $，$ k \\leq 10 ^ {18} $，$ p \\leq 10 ^ 9 $。"}]}