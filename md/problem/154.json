{"title":"集合划分计数","time_limit":7000,"memory_limit":514,"tags":["模板","容斥原理","组合计数","生成函数","集合幂级数","数学"],"operation":{"submit":"https://loj.ac/problem/154#submit_code","submissions":"https://loj.ac/submissions?problem_id=154","statistics":"https://loj.ac/problem/154/statistics/fastest","testdata":"https://loj.ac/problem/154/testdata","discussion":"https://loj.ac/discussion/problem/154"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"这是一道（集合幂级数问题转化为形式幂级数问题，利用求导 $O(n^2)$ 完成形式幂级数操作的）模板题。\r\n\r\n给定一个集合 $S = \\{{x_1}, {x_2}, \\dots, {x_n}\\}$ 和一个 $S$ 上的集合族 $\\mathcal F = \\{{S_0}, {S_1}, \\dots, {S_{m-1}}\\}$。\r\n\r\n一个划分 $\\mathcal P$ 是 $\\mathcal F$ 的一个子族，满足 $\\mathcal P$ 中所有集合的并为 $S$ ，任意两个集合不相交。\r\n\r\n求大小不大于 $k$ 的划分的数量 $\\text{mod}\\;998244353 %% \\bmod 会在前面产生一个空白。。$。\r\n\r\n两个划分 ${\\mathcal P_1}, {\\mathcal P_2}$ 不同，当且仅当存在 $i$ 使 $S_i \\in {\\mathcal P_1} \\land S_i \\notin {\\mathcal P_2}$ 或 $S_i \\notin {\\mathcal P_1} \\land S_i \\in {\\mathcal P_2}$。$S_i$ 和 $S_j$ 不同当且仅当 $i \\neq j$。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第 $1$ 行：$n\\ m\\ k$\r\n\r\n第 $2$ 行：$s_0\\ s_1\\ \\ldots s_{m-1}$，$s_i$ 二进制第 $j$ 位为 $0$ 表示 ${x_j} \\notin {S_i}$ ，为 $1$ 表示 ${x_j} \\in {S_i}$"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"$1$ 个非负整数，表示大小不大于 $k$ 的划分的数量 $\\text{mod}\\;998244353 %% \\bmod 会在前面产生一个空白。。$。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n```plain\r\n4 8 2\r\n7 10 8 11 5 15 4 5\r\n```\r\n\r\n#### 样例输出\r\n```plain\r\n5\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"* $1 \\leq k \\leq n \\leq 21$\r\n* $1 \\leq m \\leq 262144$\r\n* $1 \\leq s_i \\leq 2^n-1 %% 想了想果然还是别非负整数了吧……$\r\n\r\n#### 子任务\r\n\r\n1. （16 分）$n \\leq 7$，$m \\leq 16$\r\n2. （20 分）$n \\leq 11$，$m \\leq 256$\r\n2. （14 分）$n \\leq 14$，$m \\leq 2048$\r\n3. （25 分）$n \\leq 18$，$m \\leq 32768$\r\n4. （25 分）没有附加限制"}]}