{"title":"「2017 山东一轮集训 Day6」重建","time_limit":1000,"memory_limit":512,"tags":["2017","山东省队集训","标签待整理"],"operation":{"submit":"https://loj.ac/problem/6075#submit_code","submissions":"https://loj.ac/submissions?problem_id=6075","statistics":"https://loj.ac/problem/6075/statistics/fastest","testdata":"https://loj.ac/problem/6075/testdata","discussion":"https://loj.ac/discussion/problem/6075"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"给定一个 $ n $ 个点 $ m $ 条边的带权无向连通图 $ G $，以及一个大小为 $ k $ 的关键点集合 $ A $。有个人要从点 $ s $ 走到点 $ t $，现在可以对所有边加上一个非负整数 $ c $，问最大的 $ c $，使得加上 $ c $ 后，满足：$ s $ 到 $ t $ 的最短路长度 $ = s $ 到 $ t $ 且只能经过 $ A $ 中的点的最短路长度。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行一个整数 $ T $。代表这个数据点中有 $ T $ 个测试数据。  \r\n对于每个测试数据：  \r\n第一行包含四个整数 $ n, m, s, t $。  \r\n接下来 $ m $ 行，每行三个整数 $ u_i, v_i, c_i $，代表 $ G $ 中有一条 $ u_i $ 到 $ v_i $ 的长度为 $ c_i $ 的无向边。  \r\n第 $ m + 1 $ 行包含一个整数 $ k $。  \r\n接下来一行 $ k $ 个整数，代表关键点集合 $ A $。保证 $ s $ 与 $ t $ 都在 $ A $ 中。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"对于每个测试数据，输出一行一个整数 $ c $，代表最大的合法的加到每条边的权值。假如不存在这样的合法的 $ c $，则输出 $ \\texttt{Impossible} $，假如这样的 $ c $ 可以无穷大，则输出 $ \\texttt{Infinity} $。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n```plain\r\n3\r\n6 8 1 6\r\n1 2 5\r\n1 3 1\r\n2 6 6\r\n2 3 6\r\n4 2 3\r\n3 4 1\r\n4 5 1\r\n5 6 1\r\n5\r\n1 3 6 5 4\r\n3 4 1 2\r\n1 2 6\r\n1 3 2\r\n1 2 7\r\n2 3 3\r\n2\r\n1 2\r\n4 4 1 4\r\n1 2 1\r\n1 3 1\r\n2 4 1\r\n3 4 1\r\n3\r\n1 2 4\r\n```\r\n\r\n#### 样例输出\r\n```plain\r\n3\r\nInfinity\r\nInfinity\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于 $ 20\\% $ 的数据，$ n, m, c_i \\leq 100 $；  \r\n对于 $ 40\\% $ 的数据，$ n, m \\leq 100 $；  \r\n另外有 $ 20\\% $ 的数据，每个测试数据的答案要么为 $ \\texttt{Infinity} $，要么为 $ \\texttt{Impossible} $；  \r\n对于 $ 100\\% $ 的数据，满足 $ 1 \\leq n \\leq 1000, 1 \\leq m \\leq 10000, 1 \\leq c_i \\leq 10 ^ 9, 1 \\leq T \\leq 3 $。"}]}