{"title":"「JOISC 2018 Day 4」野猪","time_limit":10000,"memory_limit":1024,"tags":["2018","JOISC","最短路","线段树"],"operation":{"submit":"https://loj.ac/problem/2842#submit_code","submissions":"https://loj.ac/submissions?problem_id=2842","statistics":"https://loj.ac/problem/2842/statistics/fastest","testdata":"https://loj.ac/problem/2842/testdata","discussion":"https://loj.ac/discussion/problem/2842"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"**译自 [JOISC 2018](https://www.ioi-jp.org/camp/2018/2018-sp-tasks/index.html) Day4 T3「[イノシシ](https://www.ioi-jp.org/camp/2018/2018-sp-tasks/day4/wild_boar.pdf) / [Wild Boar](https://www.ioi-jp.org/camp/2018/2018-sp-tasks/day4/wild_boar-en.pdf)」**\r\n\r\nJOI 君是生活在 IOI 森林里的一头野猪。森林可视为一个包含 $N$ 个结点，$M$ 条带权无向边的连通图。结点的编号分别为 $1\\ldots N$。$i$ 号边连接结点 $A_i$ 和 $B_i$，权值为 $C_i$。保证 $(A_i,B_i)\\neq(A_j,B_j)$，并且保证：对于任意两点互相可达。\r\n\r\n开始时有一个长度为 $L$ 的序列 $X_1,$ $X_2$ $\\ldots$ $X_L$，表示 JOI 君开始时在 $X_1$，它要依次访问结点 $X_2$ $\\ldots$ $X_L$。序列中可能有重复结点，但保证序列中相邻两结点不同，即保证序列中 $X_j\\not=X_{j+1}$。注意，不要求从 $X_j$ 直达 $X_{j+1}$，JOI 君可以从 $X_j$ 出发，经过其他结点作为中转，再到达 $X_{j+1}$。但是，JOI 君不能沿**原路**返回**前一个**到达的结点。参见样例。\r\n\r\n接下来有 $T$ 次修改，每次修改会给出两个整数 $P_k, Q_k$，表示将 $X_{P_{\\scriptsize k}}$ 修改为 $Q_k$。每次修改后，JOI 君想知道：他能否找到满足要求的路径。如果能，请输出最短路的长度，反之则输出 `-1`。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行，四个整数 $N,M,T,L$。  \r\n接下来 $M$ 行，每行三个整数 $A_i, B_i, C_i$。  \r\n接下来 $L$ 行，每行一个整数 $X_j$。  \r\n接下来 $T$ 行，每行三个整数 $P_k, Q_k$。\r\n\r\n保证输入均合法。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出共 $T$ 行，第 $i$ 行有一个整数，表示查询的结果。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n3 3 1 3\r\n1 2 1\r\n2 3 1\r\n1 3 1\r\n1\r\n2\r\n3\r\n3 1\r\n```\r\n\r\n#### 样例输出 1\r\n```plain\r\n3\r\n```\r\n\r\n#### 样例说明 1\r\n从结点 $1$ 沿着 $1$ 号道路到结点 $2$，再沿 $2$ 号道路到结点 $3$，再沿 $3$ 号道路到结点 $1$。\r\n\r\n注意 JOI 君在结点 $2$ 时不能沿着 $1$ 号道路直接回到结点 $1$。\r\n\r\n#### 样例输入 2\r\n```plain\r\n4 4 4 3\r\n1 2 1\r\n2 3 1\r\n1 3 1\r\n1 4 1\r\n4\r\n1\r\n3\r\n3 4\r\n1 2\r\n3 2\r\n2 4\r\n```\r\n\r\n#### 样例输出 2\r\n```plain\r\n5\r\n2\r\n3\r\n-1\r\n```\r\n\r\n#### 样例说明 2\r\n\r\n在第一天，$\\{X_n\\}=4,1,4$，JOI 君可以沿着 $4$ 号道路从结点 $4$ 到 $1$。然后 JOI 君再依次经过 $1,$ $2,$ $3,$ $4$ 号道路回到结点 $4$。\r\n\r\n注意，尽管 JOI 君开始沿着 $4$ 号道路从结点 $4$ 到 $1$，后来又沿着 $4$ 号道路从结点 $1$ 到 $4$，但由于 JOI 君没有沿原路返回**前一个**到达的结点，因此这一方案合法。\r\n\r\n#### 样例输入 3\r\n```plain\r\n5 6 1 5\r\n1 2 8\r\n1 3 8\r\n1 4 8\r\n2 5 2\r\n3 4 6\r\n4 5 6\r\n2\r\n5\r\n1\r\n5\r\n3\r\n5 2\r\n```\r\n\r\n#### 样例输出 3\r\n```plain\r\n38\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于所有数据，\r\n\r\n* $2\\le N\\le 2000$，$N-1\\le M\\le 2000$，$1\\le T\\le 10^5$，$2\\le L\\le 10^5$；\r\n* $1\\le A_i<B_i\\le N$，保证图是连通图；\r\n* $1\\le C_i\\le 10^9$；\r\n* $X_j\\neq X_{j+1}$。\r\n\r\n|子任务|分值|附加限制|\r\n|:-:|:-:|:-:|\r\n|1|12|$N,M,L,C_i\\le 10;$ $T=1$|\r\n|2|35|$N,M\\le 500;$ $T=1$|\r\n|3|15|$T=1$|\r\n|4|38||"}]}