{"title":"「NOI2016」循环之美","time_limit":2000,"memory_limit":512,"tags":["2016","NOI","杜教筛","数学","数论"],"operation":{"submit":"https://loj.ac/problem/2085#submit_code","submissions":"https://loj.ac/submissions?problem_id=2085","statistics":"https://loj.ac/problem/2085/statistics/fastest","testdata":"https://loj.ac/problem/2085/testdata","discussion":"https://loj.ac/discussion/problem/2085"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"牛牛是一个热爱算法设计的高中生。在他设计的算法中，常常会使用带小数的数进行计算。牛牛认为，如果在 $k$ 进制下，一个数的小数部分是**纯循环**的，那么它就是美的。\r\n\r\n现在，牛牛想知道：对于已知的十进制数 $n$ 和 $m$，在 $k$ 进制下，有多少个数值上**互不相等**的纯循环小数，可以用分数 $\\frac x y$ 表示，其中 $1\\le x\\le n,1\\le y\\le m$，且 $x,y$ 是整数。\r\n\r\n一个数是纯循环的，当且仅当其可以写成以下形式：\r\n$$a.\\dot{c_1} c_2 c_3 \\ldots c_{p - 1} \\dot{c_p}$$\r\n其中，$a$ 是一个整数，$p\\ge1$；对于 $1\\le i\\le p$，$c_i$ 是 $k$ 进制下的一位数字。\r\n\r\n例如，在十进制下，$0.45454545\\dots=0.\\dot{4}\\dot{5}$ 是纯循环的，它可以用 $\\frac 5 {11}$、$\\frac{10}{22}$ 等分数表示；在十进制下，$0.1666666\\dots=0.1\\dot{6}$ 则不是纯循环的，它可以用 $\\frac 1 6$ 等分数表示。\r\n\r\n需要特别注意的是，我们认为一个整数是纯循环的，因为它的小数部分可以表示成 $0$ 的循环或是 $k-1$ 的循环；而一个小数部分非 $0$ 的有限小数不是纯循环的。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"输入文件只有一行，包含三个十进制数 $n,m,k$，意义如题所述。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"只输出一行一个整数，表示满足条件的美的数的个数。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n2 6 10\r\n```\r\n\r\n#### 样例输出 1\r\n```plain\r\n4\r\n```\r\n#### 样例解释 1\r\n满足条件的数分别是：\r\n$$1/1 = 1.0000 \\ldots \\ldots$$\r\n$$1/3 = 0.3333 \\ldots \\ldots$$\r\n$$2/1 = 2.0000 \\ldots \\ldots$$\r\n$$2/3 = 0.6666 \\ldots \\ldots$$\r\n$1/1$ 和 $2/2$ 虽然都是纯循环小数，但因为它们相等，因此只计数一次；同样，$1/3$ 和 $2/6$ 也只计数一次。\r\n\r\n#### 样例输入 2\r\n```plain\r\n23333 666666 310\r\n```\r\n#### 样例输出 2\r\n```plain\r\n5089564081\r\n```\r\n"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于所有的测试点，保证 $1\\le n\\le 10^9$，$1\\le m\\le 10^9$，$2\\le k\\le2000$。\r\n\r\n对于每个测试点，有以下约束（其中留空的表示没有特殊的约束）：\r\n\r\n| 测试点编号 | $n$ | $m$ | $k$ |\r\n| :-: | :-: | :-: | :-: |\r\n| 1 | $\\le 10$ | $\\le 20$ | $=2$ |\r\n| 2 | $\\le 100$ | $\\le 10^4$ | $=2$ |\r\n| 3 | $\\le 1000$ | | $=2$ |\r\n| 4 | $\\le 10000$ | | $=2$ |\r\n| 5 | $\\le 10$ | $\\le 20$ | $=3$ |\r\n| 6 | $\\le 100$ | $\\le 10^4$ | $=3$ |\r\n| 7 | $\\le 1000$ |  | $=3$ |\r\n| 8 | $\\le 10000$ |  | $=3$ |\r\n| 9 | $\\le 10$ | $\\le 20$ | $\\le 100$ |\r\n| 10 | $\\le 100$ | $\\le 10^4$ | $\\le 100$ |\r\n| 11 | $\\le 1000$ | | $\\le 1000$ |\r\n| 12 | $\\le 10000$ | | |\r\n| 13 | $\\le 10^5$ | $\\le 10^8$ | $\\le 100$ |\r\n| 14 | $\\le 2\\times 10^5$ | | $\\le 1000$ |\r\n| 15 | $\\le 5\\times 10^5$ | | |\r\n| 16 | $\\le 10^6$ | $\\le 10^8$ | $\\le 100$ |\r\n| 17 | $\\le 2\\times 10^6$ | | $\\le 1000$ |\r\n| 18 | $\\le 5\\times 10^6$ | | |\r\n| 19 | $\\le 10^7$ | $\\le 10^8$ | $\\le 100$ |\r\n| 20 | $\\le 2\\times 10^7$ | | $\\le 1000$ |\r\n| 21 | $\\le 2\\times 10^7$ | | |\r\n| 22 | $\\le 10^8$ | $\\le 10^8$ | |\r\n| 23 | $\\le 10^8$ | $\\le 10^8$ | |\r\n| 24 | | | |\r\n| 25 | | | |"}]}