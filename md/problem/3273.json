{"title":"「JOISC 2020 Day1」扫除","time_limit":10000,"memory_limit":1024,"tags":["JOISC","2020","平衡树","CDQ 分治","线段树合并","数据结构"],"operation":{"submit":"https://loj.ac/problem/3273#submit_code","submissions":"https://loj.ac/submissions?problem_id=3273","statistics":"https://loj.ac/problem/3273/statistics/fastest","testdata":"https://loj.ac/problem/3273/testdata","discussion":"https://loj.ac/discussion/problem/3273"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"**题目译自 [JOISC 2020](https://www.ioi-jp.org/camp/2020/2020-sp-tasks/index.html) Day1 T3「[掃除](https://www.ioi-jp.org/camp/2020/2020-sp-tasks/day1/sweeping.pdf) / [Sweeping](https://www.ioi-jp.org/camp/2020/2020-sp-tasks/day1/sweeping-en.pdf)」**\r\n\r\nBitaro 的房间是一个边长为 $N$ 的等腰直角三角形。房间内一点用坐标 $(x,y)$ 表示，其中 $0\\le x\\le N,0\\le y\\le N,x+y\\le N$。直角顶点为原点，三角形两腰分别为 $x$ 轴与 $y$ 轴。\r\n\r\n![sweeping_0.png](https://loj-img.upyun.menci.memset0.cn/2020/03/20/5e746284034b6.png)\r\n\r\n一天，Bitaro 注意到他的房间满是灰尘。初始时，房间内有 $M$ 堆灰尘。第 $i\\ (1\\le i\\le M)$ 堆灰尘位于点 $(X_i,Y_i)$。在同一点可能有多堆灰尘。\r\n\r\n现在，Bitaro 打算用扫帚打扫房间。我们认为扫帚是在房间里的一条线段，并且称线段的长度为扫帚的**宽度**。因为 Bitaro 做事很有条理，他只能按如下两种方式使用扫帚：\r\n\r\n- Bitaro 将扫帚放在房间里，使得扫帚的一个端点位于原点，并且扫帚平行于 $y$ 轴。然后，他会沿 $x$ 轴正方向水平移动扫帚，直到不能移动为止。在移动过程中，他会保证扫帚始终与 $y$ 轴平行，并且一个端点始终在 $x$ 轴上。如果扫帚宽度为 $l$，则在 $(x,y)$ 位置的灰尘（$x<N-l,y\\le l$）将会移动到 $(N-l,y)$（在 $(N-l,y)$ 处可能存在其他堆灰尘）。这个过程称为**过程 H**。\r\n- Bitaro 将扫帚放在房间里，使得扫帚的一个端点位于原点，并且扫帚平行于 $x$ 轴。然后，他会沿 $y$ 轴正方向水平移动扫帚，直到不能移动为止。在移动过程中，他会保证扫帚始终与 $x$ 轴平行，并且一个端点始终在 $y$ 轴上。如果扫帚宽度为 $l$，则在 $(x,y)$ 位置的灰尘（$x\\le l,y<N-l$）将会移动到 $(x,N-l)$（在 $(x,N-l)$ 处可能存在其他堆灰尘）。这个过程称为**过程 V**。\r\n\r\n在 Bitaro 的房间里，会按顺序发生 $Q$ 个事件。第 $j\\ (1\\le j\\le Q)$ 个事件是以下事件中的一个：\r\n\r\n- Bitaro 计算第 $P_j$ 堆灰尘的位置坐标；\r\n- Bitaro 使用宽度为 $L_j$ 的扫帚，进行了过程 H；\r\n- Bitaro 使用宽度为 $L_j$ 的扫帚，进行了过程 V；\r\n- 一堆新灰尘出现在点 $(A_j,B_j)$ 处。如果在这个事件之前一共有 $c$ 堆灰尘，那么这堆灰尘就是房间中的第 $(c+1)$ 堆灰尘。\r\n\r\n写一个程序，给出房间的腰长，每一堆灰尘的位置坐标和每个事件的细节，求出要求的某堆灰尘的位置坐标。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"从标准输入读入以下数据，所有输入的值均为整数。\r\n\r\n第一行三个整数，分别为 $N,M,Q$。\r\n\r\n接下来 $M$ 行，每行两个整数 $X_i,Y_i$，表示第 $i$ 堆灰尘的初始坐标。\r\n\r\n接下来 $Q$ 行，每行表示一个事件，有两或三个整数。设 $T_j$ 为第一个整数，每行含义如下：\r\n\r\n- 如果 $T_j=1$，则这行有两个整数 $T_j,P_j$。表示 Bitaro 要计算第 $P_j$ 堆灰尘的坐标；\r\n- 如果 $T_j=2$，则这行有两个整数 $T_j,L_j$。表示 Bitaro 用宽度为 $L_j$ 的扫帚进行了过程 H；\r\n- 如果 $T_j=3$，则这行有两个整数 $T_j,L_j$。表示 Bitaro 用宽度为 $L_j$ 的扫帚进行了过程 V；\r\n- 如果 $T_j=4$，则这行有三个整数 $T_j,A_j,B_j$。表示一堆新的灰尘出现在 $(A_j,B_j)$ 位置。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"对于每个 $T_j=1$ 的事件，输出一行两个整数到标准输出。输出在事件 $j$ 发生时第 $P_j$ 堆灰尘的位置坐标。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n6 2 10\r\n1 1\r\n4 0\r\n4 2 3\r\n3 3\r\n1 1\r\n4 1 2\r\n2 3\r\n2 0\r\n1 4\r\n3 2\r\n1 3\r\n1 2\r\n```\r\n#### 样例输出 1\r\n```plain\r\n1 3\r\n3 2\r\n3 3\r\n6 0\r\n```\r\n#### 样例说明 1\r\n\r\n初始时，第一堆灰尘位于 $(1,1)$，第二堆灰尘位于 $(4,0)$。图一描述了房间现在的情况。\r\n\r\n![sweeping_1.png](https://loj-img.upyun.menci.memset0.cn/2020/03/20/5e746282cc05e.png)\r\n\r\n对于第一个事件，第三堆灰尘添加到点 $(2,3)$ 的位置。图二描述了房间现在的情况。\r\n\r\n![sweeping_2.png](https://loj-img.upyun.menci.memset0.cn/2020/03/20/5e74628483a7f.png)\r\n\r\n对于第二个事件，Bitaro 用宽度为 $3$ 的扫帚进行了过程 V。之后，第一堆灰尘移动到了 $(1,3)$，图三描述了房间现在的情况。\r\n\r\n![sweeping_3.png](https://loj-img.upyun.menci.memset0.cn/2020/03/20/5e746285311c0.png)\r\n\r\n对于第三个事件，Bitaro 计算了第一堆灰尘的坐标 $(1,3)$。\r\n\r\n对于第四个事件，第四堆灰尘添加到点 $(1,2)$ 的位置。图四描述了房间现在的情况。\r\n\r\n![sweeping_4.png](https://loj-img.upyun.menci.memset0.cn/2020/03/20/5e746284cadae.png)\r\n\r\n对于第五个事件，Bitaro 用宽度为 $3$ 的扫帚进行了过程 H。之后，第一堆灰尘移到了 $(3,3)$，第三堆灰尘移到了 $(3,3)$，第四堆灰尘移到了 $(3,2)$。图五描述了房间现在的情况。\r\n\r\n![sweeping_5.png](https://loj-img.upyun.menci.memset0.cn/2020/03/20/5e74628580437.png)\r\n\r\n对于第六个事件，Bitaro 用宽度为 $0$ 的扫帚进行了过程 H。之后，第二堆灰尘移到了 $(6,0)$。图六描述了房间现在的情况。\r\n\r\n![sweeping_6.png](https://loj-img.upyun.menci.memset0.cn/2020/03/20/5e746285091e3.png)\r\n\r\n对于第七个事件，Bitaro 计算了第四堆灰尘的坐标 $(3,2)$。\r\n\r\n对于第八个事件，Bitaro 用宽度为 $2$ 的扫帚进行了过程 V。没有任何灰尘堆移动。图七描述了房间现在的情况。\r\n\r\n![sweeping_7.png](https://loj-img.upyun.menci.memset0.cn/2020/03/20/5e746285b91b5.png)\r\n\r\n对于第九个事件，Bitaro 计算了第三堆灰尘的坐标 $(3,3)$。\r\n\r\n对于第十个事件，Bitaro 计算了第二堆灰尘的坐标 $(6,0)$。\r\n\r\n这组样例满足子任务 1 和子任务 5 的限制。\r\n\r\n#### 样例输入 2\r\n```plain\r\n9 4 8\r\n2 3\r\n3 1\r\n1 6\r\n4 3\r\n2 6\r\n1 3\r\n2 2\r\n1 4\r\n2 3\r\n1 2\r\n2 4\r\n1 1\r\n```\r\n#### 样例输出 2\r\n```plain\r\n3 6\r\n4 3\r\n7 1\r\n6 3\r\n```\r\n#### 样例说明 2\r\n\r\n这组样例满足子任务 1, 2, 4, 5 的限制。\r\n\r\n#### 样例输入 3\r\n```plain\r\n8 1 8\r\n1 5\r\n4 4 1\r\n2 6\r\n1 2\r\n2 3\r\n4 2 2\r\n2 5\r\n1 1\r\n1 3\r\n```\r\n#### 样例输出 3\r\n```plain\r\n4 1\r\n3 5\r\n3 2\r\n```\r\n#### 样例说明 3\r\n\r\n这组样例满足子任务 1, 2, 5 的限制。\r\n\r\n#### 样例输入 4\r\n```plain\r\n7 4 9\r\n1 5\r\n2 2\r\n4 2\r\n5 0\r\n2 6\r\n2 3\r\n1 2\r\n3 6\r\n1 4\r\n3 1\r\n1 1\r\n2 2\r\n1 3\r\n```\r\n#### 样例输出 4\r\n```plain\r\n4 2\r\n5 1\r\n1 6\r\n5 2\r\n```\r\n#### 样例说明 4\r\n\r\n这组样例满足子任务 1, 3, 4, 5 的限制。\r\n\r\n#### 样例输入 5\r\n```plain\r\n20 5 25\r\n10 6\r\n0 4\r\n2 1\r\n1 0\r\n2 3\r\n2 18\r\n3 9\r\n4 1 5\r\n4 0 2\r\n3 10\r\n4 3 3\r\n3 3\r\n2 9\r\n4 9 1\r\n3 12\r\n1 4\r\n3 19\r\n1 3\r\n1 9\r\n2 1\r\n1 7\r\n1 6\r\n4 3 3\r\n1 10\r\n1 1\r\n1 5\r\n2 0\r\n1 2\r\n2 2\r\n1 7\r\n```\r\n#### 样例输出 5\r\n```plain\r\n2 17\r\n2 17\r\n9 8\r\n0 17\r\n1 17\r\n3 3\r\n10 10\r\n2 17\r\n2 17\r\n0 17\r\n```\r\n#### 样例说明 5\r\n这组样例满足子任务 1 和子任务 5 的限制。"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于全部数据，$1\\le N\\le 10^9,1\\le M\\le 5\\times 10^5,1\\le Q\\le 10^6$。保证：\r\n\r\n- $0\\le X_i,Y_i\\le N,\\ X_i+Y_i\\le N\\ (1\\le i\\le M)$；\r\n- $1\\le P_j\\le M'\\ (1\\le j\\le Q)$，其中 $M'$ 表示当事件 $j$ 发生时灰尘的堆数；\r\n- $0\\le L_j\\le N-1\\ (1\\le j\\le Q)$；\r\n- $0\\le A_j,B_j\\le N,\\ A_j+B_j\\le N\\ (1\\le j\\le Q)$；\r\n- 存在至少一个事件 $T_j=1\\ (1\\le j\\le Q)$。\r\n\r\n详细子任务与附加限制如下表：\r\n\r\n| 子任务 |                           附加限制                           | 分值 |\r\n| :----: | :----------------------------------------------------------: | :--: |\r\n|  $1$   |            $M\\le 2\\times 10^3,Q\\le 5\\times 10^3$             | $1$  |\r\n|  $2$   |                         $T_j=1,2,4$                          | $10$ |\r\n|  $3$   | $T_j=1,2,3,\\ X_j\\le X_{j+1},\\ Y_j\\ge Y_{j+1}\\ (1\\le j\\le M-1)$ | $11$ |\r\n|  $4$   |                         $T_j=1,2,3$                          | $53$ |\r\n|  $5$   |                          无附加限制                          | $25$ |\r\n\r\n"}]}