{"title":"寻宝游戏","time_limit":2250,"memory_limit":512,"tags":["最短路","概率与期望","图论"],"operation":{"submit":"https://loj.ac/problem/6533#submit_code","submissions":"https://loj.ac/submissions?problem_id=6533","statistics":"https://loj.ac/problem/6533/statistics/fastest","testdata":"https://loj.ac/problem/6533/testdata","discussion":"https://loj.ac/discussion/problem/6533"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"有一张 $n$ 个点 $m$ 条边的带正整数边权无向连通图，图上有 $z$ 个关键点。\r\n\r\n你可以选择一条从一个关键点到另一个关键点的简单路径，设这条路径上边权和为 $w$，那么你的得分将会是 $w$ 个服从 $[0, 1]$ 上的连续型均匀分布的互相独立的随机变量中第 $k$ 小的期望值。\r\n\r\n请选择这样一条路径，最大化最后的得分。请将得分对 $31525197391593473$ 取模后输出。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行三个整数，$n, m, k$。\r\n\r\n接下来$m$行每行三个整数 $u, v, c$，表示 $u$ 和 $v$ 间有一条边权为 $c$ 的边（保证 $c\\ge k$）。\r\n\r\n接下来一行一个整数 $z$。\r\n\r\n接下来一行 $z$ 个整数，表示关键点的编号。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"一行一个数，答案。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 输入样例\r\n```plain\r\n6 5 1\r\n1 2 1\r\n2 3 1\r\n3 4 1\r\n4 5 1\r\n5 6 1\r\n3\r\n3 4 1\r\n```\r\n#### 输出样例\r\n```plain\r\n15762598695796737\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于所有数据，$2\\le z\\le n\\le 10^5,$ $m\\le 5\\times 10^{5},$ $1\\le k\\le c\\le 10^9$。\r\n\r\n| 子任务编号 | 分值 |     特殊性质     |\r\n| :--------: | :--: | :--------------: |\r\n|     1      |  30  |  $n, m\\le 1000$  |\r\n|     2      |  10  | 给定的图是一条链 |\r\n|     3      |  20  | 给定的图是一棵树 |\r\n|     4      |  40  |        无        |"}]}