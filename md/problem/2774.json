{"title":"「BalticOI 2018」多角恋","time_limit":2000,"memory_limit":1024,"tags":["2018","BalticOI"],"operation":{"submit":"https://loj.ac/problem/2774#submit_code","submissions":"https://loj.ac/submissions?problem_id=2774","statistics":"https://loj.ac/problem/2774/statistics/fastest","testdata":"https://loj.ac/problem/2774/testdata","discussion":"https://loj.ac/discussion/problem/2774"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"**题目译自 [BalticOI 2018](https://boi2018.progolymp.se/tasks/) Day1「[Love Polygon](https://boi18-day1-open.kattis.com/problems/boi18.polygon)」**\r\n\r\n给一张 $N$ 个点的有向图，每次可以花费 $1$ 的代价修改图上的一条边的终点。求最少需要花费多少代价，才能使这张图形成若干个两两不相交的二元环，并且图上的所有点都在某一个环里。\r\n"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行包含一个整数 $N$。\r\n\r\n接下来的 $N$ 行每行包含两个字符串 $s$ 和 $t$，表示图中存在一条 $(s\\rightarrow t)$ 的边。\r\n\r\n字符串只包含小写英文字母，且长度不超过 $10$。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出一个整数，表示最少需要花费多少代价，才能使这张图形成若干个两两不相交的环，并且图上的所有点都在某一个环里。无解请输出 $-1$。\r\n"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n\r\n```plain\r\n8\r\nleonard emmy\r\nada emmy\r\nisaac leonard\r\nemmy pierre\r\npierre bernhard\r\nbernhard emmy\r\nsofia karl\r\nkarl sofia\r\n```\r\n\r\n#### 样例输出 1\r\n\r\n```plain\r\n3\r\n```\r\n#### 样例 1 解释\r\n\r\n<img src=\"https://gitee.com/mingqihuang/pics/raw/master/gg.svg\" width = 50%>\r\n\r\n唯一的最优解如上图所示，图的上半部分为原图，底色为粉色的三个点为需要修改的边的起点；图的下半部分表示修改后的情况。\r\n\r\n#### 样例输入 2\r\n\r\n```plain\r\n4\r\na\r\nc\r\nb c\r\nc d\r\nd d\r\n```\r\n\r\n#### 样例输出 2\r\n\r\n```plain\r\n3\r\n```\r\n\r\n#### 样例 2 解释\r\n\r\n存在多组最优解。其中一种是分别改变一条以 ``a``、``b`` 和 ``d`` 为起点的边，使他们分别连接到 ``b``、``a`` 和 `c`。\r\n\r\n#### 样例输入 3\r\n\r\n```plain\r\n3\r\nrocky scarlet\r\nscarlet patrick\r\npatrick rocky\r\n```\r\n\r\n#### 样例输出 3\r\n\r\n```plain\r\n-1\r\n```\r\n\r\n#### 样例 3 解释\r\n\r\n图中有 $3$ 个点，无论如何修改边的终点，总会有一个人不在环里。"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"| 子任务 | 分值 | 数据范围 | 附加限制 |\r\n|:----------:|:-------:|:-------------:|:-------------:|\r\n|$1$|$21$|$2\\leqslant N\\leqslant 20$||\r\n|$2$|$25$|$2\\leqslant N\\leqslant 100\\, 000$|每个点都有一条入边（可能有自环）|\r\n|$3$|$29$|$2\\leqslant N\\leqslant 100\\, 000$|不存在两个点或更多个点构成的环|\r\n|$4$|$25$|$2\\leqslant N\\leqslant 100\\, 000$||\r\n**请注意在 LibreOJ 上共有 $5$ 个子任务，其中第一个子任务为样例。**"}]}