{"title":"「雅礼集训 2017 Day1」字符串","time_limit":1000,"memory_limit":256,"tags":["2017","雅礼集训","后缀数组","后缀自动机","字符串","数据结构"],"operation":{"submit":"https://loj.ac/problem/6031#submit_code","submissions":"https://loj.ac/submissions?problem_id=6031","statistics":"https://loj.ac/problem/6031/statistics/fastest","testdata":"https://loj.ac/problem/6031/testdata","discussion":"https://loj.ac/discussion/problem/6031"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"令 $ s $ 与 $ w $ 为两字符串，**下标从 $0$ 开始**，定义：\r\n\r\n1. $ w[l, r] $ 表示字符串 $ w $ 在区间 $ [l, r] $ 中的子串；\r\n2. $ w $ 在 $ s $ 中出现的频率定义为 $ w $ 在 $ s $ 中出现的次数；\r\n3. $ f(s, w, l, r) $ 表示 $ w[l, r] $ 在 $ s $ 中出现的频率。\r\n\r\n比如 $ f(\\texttt{ababa}, \\texttt{aba}, 0, 2) = 2 $。\r\n\r\n现在给定串 $ s $，$ m $ 个区间 $ [l, r] $ 和长度 $ k $，你要回答 $ q $ 个询问，每个询问给你一个长度为 $ k $ 的字符串 $ w $ 和两个整数 $ a, b $，求：\r\n\r\n$$ \\sum\\limits_{i = a} ^ b f(s, w, l_i, r_i) $$"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行四个整数 $ n, m, q, k $，$ n $ 表示 $ s $ 的长度。  \r\n接下来一行一个长为 $ n $ 的字符串 $ s $。  \r\n接下来 $ m $ 行，每行两个整数表示 $ l_i, r_i $。  \r\n接下来 $ q $ 行，每行一个字符串 $ w $，两个整数 $ a, b $。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"对于每个询问一行，输出答案。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n```plain\r\n8 5 3 3\r\nabacdaba\r\n0 2\r\n1 2\r\n0 0\r\n2 2\r\n1 2\r\ndab 1 4\r\nbac 2 3\r\neeb 1 3\r\n```\r\n\r\n#### 样例输出\r\n```plain\r\n7\r\n3\r\n2\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于 $ 10\\% $ 的数据，$ n, m, k, q \\leq 10 $；  \r\n对于 $ 30\\% $ 的数据，满足 $ n, m, k, q \\leq 10 ^ 2 $；  \r\n对于 $ 50\\% $ 的数据，满足 $ n, m, k, q \\leq 10 ^ 4 $；  \r\n对于 $ 100\\% $ 的数据，满足 $ 0 < n, m, k, q \\leq 10 ^ 5, \\sum |w| \\leq 10 ^ 5, 0 \\leq l_i, r_i < k, 0 \\leq a, b < m $，字符串由小写英文字母构成。"}]}