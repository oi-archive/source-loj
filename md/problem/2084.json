{"title":"「NOI2016」网格","time_limit":2000,"memory_limit":1024,"tags":["2016","NOI","离散化","图论"],"operation":{"submit":"https://loj.ac/problem/2084#submit_code","submissions":"https://loj.ac/submissions?problem_id=2084","statistics":"https://loj.ac/problem/2084/statistics/fastest","testdata":"https://loj.ac/problem/2084/testdata","discussion":"https://loj.ac/discussion/problem/2084"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"跳蚤国王和蛐蛐国王在玩一个游戏。\r\n\r\n他们在一个 $n$ 行 $m$ 列的网格上排兵布阵。其中的 $c$ 个格子中 $(0 \\leq c \\leq n\\cdot m)$，每个格子有一只蛐蛐，其余的格子中，每个格子有一只跳蚤。\r\n\r\n我们称占据的格子有公共边的两只跳蚤是相邻的。\r\n\r\n我们称两只跳蚤是连通的，当且仅当这两只跳蚤相邻，或存在另一只跳蚤与这两只跳蚤都连通。\r\n\r\n现在，蛐蛐国王希望，将某些（零个，一个或多个）跳蚤替换成蛐蛐，使得在此之后存在至少两只跳蚤不连通。\r\n\r\n<img src=\"https://loj-img.upyun.menci.memset0.cn/2020/04/29/5ea936f5bd6e1.png\" alt=\"left\" title=\"left\" width=\"300px\" height=\"300px\" />\r\n<img src=\"https://loj-img.upyun.menci.memset0.cn/2020/04/29/5ea936f639d3c.png\" alt=\"right\" title=\"right\" width=\"300px\" height=\"300px\"/>\r\n\r\n例如：我们用图<img src=\"https://loj-img.upyun.menci.memset0.cn/2020/04/29/5ea9393d612f0.png\" alt=\"tiaozao\" title=\"tiaozao\" width=\"40px\" height=\"30px\" />表示一只跳蚤，用图<img src=\"https://loj-img.upyun.menci.memset0.cn/2020/04/29/5ea9393dac165.png\" alt=\"ququ\" title=\"ququ\" width=\"40px\" height=\"40px\" />表示一只蛐蛐，那么左图描述了一个 $n=4,$ $m=4,$ $c=2$ 的情况。\r\n\r\n这种情况下蛐蛐国王可以通过将第二行第二列，和第三行第三列的两只跳蚤替换为蛐蛐，从而达成他的希望，如右图所示。并且，不存在更优的方案，但是可能存在其他替换两只跳蚤的方案。\r\n\r\n你需要首先判断蛐蛐国王的希望能否被达成。如果能够达成，你还需要最小化被替换的跳蚤的个数。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"每个输入文件包含多组数据。  \r\n输入文件的第一行只有一个整数 $T$，表示数据的组数。  \r\n接下来依次输入 $T$ 组数据，每组数据的第一行包含三个整数 $n, m, c$。  \r\n接下来 $c$ 行，每行包含两个整数 $x, y$ 表示第 $x$ 行，第 $y$ 列的格子被一个蛐蛐占据。每一组数据当中，同一个蛐蛐不会被多次描述。  \r\n同一行相邻的整数之间由一个空格隔开。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"对于每一组数据依次输出一行答案。\r\n\r\n如果这组数据中，蛐蛐国王的希望不能被达成，输出``-1``。否则，输出被替换的跳蚤的个数的最小值。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n```plain\r\n4\r\n4 4 2\r\n1 1\r\n4 4\r\n2 3 1\r\n1 2\r\n2 2 2\r\n1 1\r\n2 2\r\n1 1 0\r\n```\r\n\r\n#### 样例输出\r\n```plain\r\n2\r\n1\r\n0\r\n-1\r\n```\r\n\r\n#### 样例解释\r\n第一组数据就是问题描述中的例子。\r\n\r\n对于第二组数据，可以将第二行第二列的一只跳蚤替换为蛐蛐，从而使得存在两只跳蚤不连通，并且不存在更优的方案。\r\n\r\n对于第三组数据，最初已经存在两只跳蚤不连通，故不需要再进行替换。\r\n\r\n对于第四组数据，由于最多只有一只跳蚤，所以无论如何替换都不能存在两只跳蚤不连通。"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于所有的数据，$1 \\leq n,m \\leq 10^9, \\ 0 \\leq c \\leq \\text{min}(nm,10^5),\\ 1 \\leq x \\leq n,\\ 1 \\leq y \\leq m,\\ 1 \\leq T \\leq 20$。\r\n\r\n我们记 $\\sum c$ 为某个测试点中，其 $T$ 组输入数据的所有 $c$ 的总和，则保证 $\\sum c≤10^5$。"}]}