{"title":"「COCI 2020.1」Klasika","time_limit":5000,"memory_limit":512,"tags":["COCI","2020"],"operation":{"submit":"https://loj.ac/problem/3244#submit_code","submissions":"https://loj.ac/submissions?problem_id=3244","statistics":"https://loj.ac/problem/3244/statistics/fastest","testdata":"https://loj.ac/problem/3244/testdata","discussion":"https://loj.ac/discussion/problem/3244"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"**译自 [COCI 2019/2020 Contest #4](https://hsin.hr/coci/contest4_tasks.pdf) T4「Klasika」**\r\n\r\n开始时，有一个编号为 $1$ 的节点，它代表一棵树的根节点。你的任务是支持以下两种形式的 $Q$ 次操作：\r\n- $\\texttt{Add x y}$：给树上编号为 $x$ 的节点加一个儿子，新加入的节点和节点 $x$ 之间用一条边权为 $y$ 的边连接，新加入的节点编号等于该节点加入后树上所有的节点数；\r\n- $\\texttt{Query a b}$：找到从节点 $a$ 出发，到节点 $b$ 的子树中的节点（节点本身也算作在自己的子树中）的最长路径长度。这里路径的长度定义为在路径上所有边权的异或值。\r\n"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行一个正整数 $Q$，与题目描述中意义相同；\r\n\r\n接下来 $Q$ 行，每行表示一个操作，格式同题目描述。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"对于每个 $\\texttt{Query}$ 操作，输出一行一个整数，表示对应答案。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n4\r\nAdd 1 5\r\nQuery 1 1\r\nAdd 1 7\r\nQuery 1 1\r\n```\r\n#### 样例输出 1\r\n```plain\r\n5\r\n7\r\n```\r\n#### 样例输入 2\r\n```plain\r\n6\r\nAdd 1 5\r\nAdd 2 7\r\nAdd 1 4\r\nAdd 4 3\r\nQuery 1 1\r\nQuery 2 4\r\n```\r\n#### 样例输出 2\r\n```plain\r\n7\r\n2\r\n```\r\n#### 样例输入 3\r\n```plain\r\n10\r\nAdd 1 4\r\nAdd 1 9\r\nAdd 1 10\r\nAdd 2 2\r\nAdd 3 3\r\nAdd 4 4\r\nQuery 4 2\r\nQuery 1 3\r\nAdd 6 7\r\nQuery 1 3\r\n```\r\n#### 样例输出 3\r\n```plain\r\n14\r\n10\r\n13\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于所有数据，$1\\le Q\\le 2\\times 10^5$，保证 $x,a,b$ 是在此时刻存在的节点编号，$y$ 不超过 $2^{30}$。\r\n\r\n详细子任务限制及分值如下表：\r\n\r\n|子任务编号|附加限制|分值|\r\n|:-:|:-:|:-:|\r\n|$1$|$Q\\le 200$|$10$|\r\n|$2$|$Q\\le 2\\times 10^3$|$20$|\r\n|$3$|对于所有 $\\texttt{Query}$ 操作，保证 $b=1$|$30$|\r\n|$4$|无附加限制|$40$|"}]}