{"title":"「THUSCH 2017」巧克力","time_limit":5000,"memory_limit":512,"tags":["2017","THUSC","状态压缩","最短路","斯坦纳树"],"operation":{"submit":"https://loj.ac/problem/2977#submit_code","submissions":"https://loj.ac/submissions?problem_id=2977","statistics":"https://loj.ac/problem/2977/statistics/fastest","testdata":"https://loj.ac/problem/2977/testdata","discussion":"https://loj.ac/discussion/problem/2977"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"「人生就像一盒巧克力，你永远不知道吃到的下一块是什么味道。」\r\n\r\n明明收到了一大块巧克力，里面有若干小块，排成 $n$ 行 $m$ 列。每一小块都有自己特别的图案 $c_{i,j}$，它们有的是海星，有的是贝壳，有的是海螺……其中还有一些因为挤压，已经分辨不出是什么图案了。明明给每一小块巧克力标上了一个美味值 $a_{i,j}$（$0\\leq a_{i,j} \\leq 10^6$），这个值越大，表示这一小块巧克力越美味。\r\n\r\n​正当明明咽了咽口水，准备享用美味时，舟舟神奇地出现了。看到舟舟恳求的目光，明明决定从中选出一些小块与舟舟一同分享。\r\n\r\n​舟舟希望这些被选出的巧克力是连通的（两块巧克力连通当且仅当他们有公共边），而且这些巧克力要包含至少 $k$（$1\\leq k\\leq 5$）种。而那些被挤压过的巧克力则是不能被选中的。\r\n\r\n明明想满足舟舟的愿望，但他又有点「抠」，想将美味尽可能多地留给自己。所以明明希望选出的巧克力块数能够尽可能地少。如果在选出的块数最少的前提下，美味值的中位数（我们定义 $n$ 个数的中位数为第 $\\left \\lfloor \\frac{n+1}{2}\\right\\rfloor$ 小的数）能够达到最小就更好了。\r\n\r\n你能帮帮明明吗？"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"每个测试点包含多组测试数据。\r\n\r\n输入第一行包含一个正整数 $T$（$1\\leq T \\leq 5$），表示测试数据组数。\r\n\r\n对于每组测试数据：\r\n\r\n输入第一行包含三个正整数 $n,m$ 和 $k$；\r\n\r\n接下来 $n$ 行，每行 $m$ 个整数，表示每小块的图案 $c_{i,j}$。若 $c_{i,j}=-1$ 表示这一小块受到过挤压，不能被选中；\r\n\r\n接下来 $n$ 行，每行 $m$ 个整数，表示每个小块的美味值 $a_{i,j}$。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出共包括 $T$ 行，每行包含两个整数，用空格隔开，即最少的块数和最小的美味值中位数。\r\n\r\n若对于某组测试数据，不存在任意一种合法的选取方案，请在对应行输出两个 $-1$。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n```plain\r\n1\r\n5 4 5\r\n3 4 3 4\r\n5 5 -1 5\r\n-1 4 5 5\r\n5 5 4 2\r\n1 -1 2 4\r\n1 3 1 1\r\n3 2 3 3\r\n4 4 4 5\r\n8 9 9 5\r\n7 2 6 3\r\n```\r\n#### 样例输出\r\n```plain\r\n9 5\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"<!-- BEGIN: Migrated markdown table -->\n\n| 测试点编号 | $n,m$ 的限制 | $c_{i,j}$ 的限制 | 部分分说明 |\n|:-:|:-:|:-:|:-:|\n| 1 | $n = 1, 1\\leq m \\leq 233$ | $c_{i,j} = -1$ 或 $1\\leq c_{i,j} \\leq n \\times m$ | 若输出的最少块数均正确，<br> 但最小中位数存在错误，<br> 选手可以获得该测试点 $80\\%$ 的分数。 |\n| 2 | $1\\leq n\\times m \\le 20$ | $c_{i,j} = -1$ 或 $1\\leq c_{i,j} \\leq n \\times m$ | 若输出的最少块数均正确，<br> 但最小中位数存在错误，<br> 选手可以获得该测试点 $80\\%$ 的分数。 |\n| 3 | $n = 2, m = 15$ | $c_{i,j} = -1$ 或 $1\\leq c_{i,j} \\leq n \\times m$ | 若输出的最少块数均正确，<br> 但最小中位数存在错误，<br> 选手可以获得该测试点 $80\\%$ 的分数。 |\n| 4 | $n = 2, m = 15$ | $c_{i,j} = -1$ 或 $1\\leq c_{i,j} \\leq n \\times m$ | 若输出的最少块数均正确，<br> 但最小中位数存在错误，<br> 选手可以获得该测试点 $80\\%$ 的分数。 |\n| 5 | $1\\leq n\\times m \\leq 30$ | $c_{i,j} = -1$ 或 $1\\leq c_{i,j} \\leq n \\times m$ | 若输出的最少块数均正确，<br> 但最小中位数存在错误，<br> 选手可以获得该测试点 $80\\%$ 的分数。 |\n| 6 | $1\\leq n\\times m \\leq 30$ | $c_{i,j} = -1$ 或 $1\\leq c_{i,j} \\leq n \\times m$ | 若输出的最少块数均正确，<br> 但最小中位数存在错误，<br> 选手可以获得该测试点 $80\\%$ 的分数。 |\n| 7 | $1 \\leq n\\times m \\leq 50$ | $c_{i,j} = -1$ 或 $1\\leq c_{i,j} \\leq 8$ | 若输出的最少块数均正确，<br> 但最小中位数存在错误，<br> 选手可以获得该测试点 $80\\%$ 的分数。 |\n| 8 | $1 \\leq n\\times m \\leq 50$ | $c_{i,j} = -1$ 或 $1\\leq c_{i,j} \\leq 8$ | 若输出的最少块数均正确，<br> 但最小中位数存在错误，<br> 选手可以获得该测试点 $80\\%$ 的分数。 |\n| 9 | $1 \\leq n\\times m \\leq 50$ | $c_{i,j} = -1$ 或 $1\\leq c_{i,j} \\leq 8$ | 若输出的最少块数均正确，<br> 但最小中位数存在错误，<br> 选手可以获得该测试点 $80\\%$ 的分数。 |\n| 10 | $ 1 \\leq n\\times m \\leq 233$ | $c_{i,j} = -1$ 或 $1\\leq c_{i,j} \\leq 8$ | 若输出的最少块数均正确，<br> 但最小中位数存在错误，<br> 选手可以获得该测试点 $80\\%$ 的分数。 |\n| 11 | $ 1 \\leq n\\times m \\leq 233$ | $c_{i,j} = -1$ 或 $1\\leq c_{i,j} \\leq 8$ | 若输出的最少块数均正确，<br> 但最小中位数存在错误，<br> 选手可以获得该测试点 $60\\%$ 的分数。 |\n| 12 | $ 1 \\leq n\\times m \\leq 233$ | $c_{i,j} = -1$ 或 $1\\leq c_{i,j} \\leq 8$ | 若输出的最少块数均正确，<br> 但最小中位数存在错误，<br> 选手可以获得该测试点 $60\\%$ 的分数。 |\n| 13 | $ 1 \\leq n\\times m \\leq 233$ | $c_{i,j} = -1$ 或 $1\\leq c_{i,j} \\leq 14$ | 若输出的最少块数均正确，<br> 但最小中位数存在错误，<br> 选手可以获得该测试点 $60\\%$ 的分数。 |\n| 14 | $ 1 \\leq n\\times m \\leq 233$ | $c_{i,j} = -1$ 或 $1\\leq c_{i,j} \\leq 14$ | 若输出的最少块数均正确，<br> 但最小中位数存在错误，<br> 选手可以获得该测试点 $60\\%$ 的分数。 |\n| 15 | $ 1 \\leq n\\times m \\leq 233$ | $c_{i,j} = -1$ 或 $1\\leq c_{i,j} \\leq 14$ | 若输出的最少块数均正确，<br> 但最小中位数存在错误，<br> 选手可以获得该测试点 $60\\%$ 的分数。 |\n| 16 | $ 1 \\leq n\\times m \\leq 233$ | $c_{i,j} = -1$ 或 $1\\leq c_{i,j} \\leq n \\times m$ | 若输出的最少块数均正确，<br> 但最小中位数存在错误，<br> 选手可以获得该测试点 $60\\%$ 的分数。 |\n| 17 | $ 1 \\leq n\\times m \\leq 233$ | $c_{i,j} = -1$ 或 $1\\leq c_{i,j} \\leq n \\times m$ | 若输出的最少块数均正确，<br> 但最小中位数存在错误，<br> 选手可以获得该测试点 $60\\%$ 的分数。 |\n| 18 | $ 1 \\leq n\\times m \\leq 233$ | $c_{i,j} = -1$ 或 $1\\leq c_{i,j} \\leq n \\times m$ | 若输出的最少块数均正确，<br> 但最小中位数存在错误，<br> 选手可以获得该测试点 $60\\%$ 的分数。 |\n| 19 | $ 1 \\leq n\\times m \\leq 233$ | $c_{i,j} = -1$ 或 $1\\leq c_{i,j} \\leq n \\times m$ | 若输出的最少块数均正确，<br> 但最小中位数存在错误，<br> 选手可以获得该测试点 $60\\%$ 的分数。 |\n| 20 | $ 1 \\leq n\\times m \\leq 233$ | $c_{i,j} = -1$ 或 $1\\leq c_{i,j} \\leq n \\times m$ | 若输出的最少块数均正确，<br> 但最小中位数存在错误，<br> 选手可以获得该测试点 $60\\%$ 的分数。 |\n\n<!-- Migrated from original HTML table:\n<table><thead>\r\n<tr>\r\n<th rowspan=\"1\" style='text-align:center'>测试点编号 </th>\r\n<th rowspan=\"1\" style='text-align:center'>$n,m$ 的限制 </th>\r\n<th rowspan=\"1\" style='text-align:center'>$c_{i,j}$ 的限制 </th>\r\n<th rowspan=\"1\" style='text-align:center'>部分分说明 </th>\r\n</tr>\r\n</thead>\r\n<tbody>\r\n<tr>\r\n<td rowspan=\"1\" style='text-align:center'>1</td>\r\n<td rowspan=\"1\" style='text-align:center'>$n = 1, 1\\leq m \\leq 233$ </td>\r\n<td rowspan=\"6\" style='text-align:center'>$c_{i,j} = -1$ 或 $1\\leq c_{i,j} \\leq n \\times m$ </td>\r\n<td rowspan=\"10\" style='text-align:center'>若输出的最少块数均正确，<br> 但最小中位数存在错误，<br> 选手可以获得该测试点 $80\\%$ 的分数。</td>\r\n</tr>\r\n<tr>\r\n<td rowspan=\"1\" style='text-align:center'>2</td>\r\n<td rowspan=\"1\" style='text-align:center'>$1\\leq n\\times m \\le 20$ </td>\r\n</tr>\r\n<tr>\r\n<td rowspan=\"1\" style='text-align:center'>3</td>\r\n<td rowspan=\"2\" style='text-align:center'>$n = 2, m = 15$ </td>\r\n</tr>\r\n<tr>\r\n<td rowspan=\"1\" style='text-align:center'>4</td>\r\n</tr>\r\n<tr>\r\n<td rowspan=\"1\" style='text-align:center'>5</td>\r\n<td rowspan=\"2\" style='text-align:center'>$1\\leq n\\times m \\leq 30$ </td>\r\n</tr>\r\n<tr>\r\n<td rowspan=\"1\" style='text-align:center'>6</td>\r\n</tr>\r\n<tr>\r\n<td rowspan=\"1\" style='text-align:center'>7</td>\r\n<td rowspan=\"3\" style='text-align:center'>$1 \\leq n\\times m \\leq 50$ </td>\r\n<td rowspan=\"6\" style='text-align:center'>$c_{i,j} = -1$ 或 $1\\leq c_{i,j} \\leq 8$ </td>\r\n</tr>\r\n<tr>\r\n<td rowspan=\"1\" style='text-align:center'>8</td>\r\n</tr>\r\n<tr>\r\n<td rowspan=\"1\" style='text-align:center'>9</td>\r\n</tr>\r\n<tr>\r\n<td rowspan=\"1\" style='text-align:center'>10</td>\r\n<td rowspan=\"11\" style='text-align:center'>$ 1 \\leq n\\times m \\leq 233$ </td>\r\n</tr>\r\n<tr><td rowspan=\"1\" style='text-align:center'>11</td>\r\n<td rowspan=\"10\" style='text-align:center'>若输出的最少块数均正确，<br> 但最小中位数存在错误，<br> 选手可以获得该测试点 $60\\%$ 的分数。</td>\r\n</tr>\r\n<tr>\r\n<td rowspan=\"1\" style='text-align:center'>12</td>\r\n</tr>\r\n<tr>\r\n<td rowspan=\"1\" style='text-align:center'>13</td>\r\n<td rowspan=\"3\" style='text-align:center'>$c_{i,j} = -1$ 或 $1\\leq c_{i,j} \\leq 14$ </td>\r\n</tr>\r\n<tr>\r\n<td rowspan=\"1\" style='text-align:center'>14</td>\r\n</tr>\r\n<tr>\r\n<td rowspan=\"1\" style='text-align:center'>15</td>\r\n</tr>\r\n<tr>\r\n<td rowspan=\"1\" style='text-align:center'>16</td>\r\n<td rowspan=\"5\" style='text-align:center'>$c_{i,j} = -1$ 或 $1\\leq c_{i,j} \\leq n \\times m$ </td>\r\n</tr>\r\n<tr>\r\n<td rowspan=\"1\" style='text-align:center'>17</td>\r\n</tr>\r\n<tr>\r\n<td rowspan=\"1\" style='text-align:center'>18</td>\r\n</tr>\r\n<tr>\r\n<td rowspan=\"1\" style='text-align:center'>19</td>\r\n</tr>\r\n<tr>\r\n<td rowspan=\"1\" style='text-align:center'>20</td>\r\n</tr>\r\n</tbody>\r\n</table>\n-->\n\n<!-- END: Migrated markdown table --> "}]}