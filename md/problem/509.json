{"title":"「LibreOJ NOI Round #1」动态几何问题","time_limit":3000,"memory_limit":1024,"tags":["LibreOJ NOI Round","杜教筛","数学","数论"],"operation":{"submit":"https://loj.ac/problem/509#submit_code","submissions":"https://loj.ac/submissions?problem_id=509","statistics":"https://loj.ac/problem/509/statistics/fastest","testdata":"https://loj.ac/problem/509/testdata","discussion":"https://loj.ac/discussion/problem/509"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"一天，神犇醒来时发现他的面前摆着一张初中数学试卷 …… 上面是这样一道题：\r\n\r\n> 22.如图，已知两圆相交，作过两圆圆心的直线与两圆依次交于点 $W,X,Y,Z$，过 $X$ 作直线 $XK$ 垂直于 $WZ$ 交圆 $WKY$ 于点 $K$，过 $Y$ 作直线 $YL$ 垂直于 $WZ$ 交圆 $XLZ$ 于点 $L$，且 $K$ 和 $L$ 在直线的异侧。以 $KL$ 为一边作正方形 $KLCD$。\r\n>\r\n> ![D.png](https://ooo.0o0.ooo/2017/06/27/59523aefa7dea.png)\r\n>\r\n> (1).已知 $XY=1$，$S_{KLCD}$ 为整数；设 $WX=a,YZ=b$，若 $a,b$ 都是整数且 $a\\in[1,N],b\\in[1,M]$，则有序数对 $(a,b)$ 共有多少种可能的取值？\r\n\r\n神犇自然是秒了这道题。然而他发现不远处有一名抓耳挠腮丝毫不会的学生，看了十几分钟后神犇终于忍不住了，站起来大喊：\r\n\r\n> 你怎么这么菜啊？我来告诉你：由圆的性质显然可得 $KX=\\sqrt a,YL=\\sqrt b$ ……\r\n\r\n但话还没说完，他就被监考老师拦住了，飒然惊觉的神犇才发现这是一场梦，只留下梦中的你在一脸苦闷地做着题。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"一行两个正整数 $N$ 和 $M$。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"一行一个正整数，表示满足要求的有序整数对 $(a,b)$ 的种数。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n2 2\r\n```\r\n\r\n#### 样例输出 1\r\n```plain\r\n2\r\n```\r\n\r\n#### 样例输入 2\r\n```plain\r\n77777 66666\r\n```\r\n\r\n#### 样例输出 2\r\n```plain\r\n495197\r\n```\r\n\r\n#### 样例输入 3\r\n```plain\r\n1000000000 1000000000\r\n```\r\n\r\n#### 样例输出 3\r\n```plain\r\n12735999860\r\n```\r\n"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于$100\\%$的数据，$1 \\le N,M \\le 1.5*10^{16}$。\r\n\r\n$S_{KLCD}$ 表示正方形 $KLCD$ 的面积。\r\n\r\n| Subtask # | 分值   | $N$             | $M$               |\r\n| :---------: | :----: | :---------------: | :-----------------: |\r\n| 1         | $3$  | $\\le 1$         | $\\le 10^{15}$     |\r\n| 2         | $5$  | $\\le 5000$      | $\\le 5000$        |\r\n| 3         | $7$  | $\\le 10^5$      | $\\le 10^5$        |\r\n| 4         | $3$  | $\\le 10^6$      | $\\le 10^6$        |\r\n| 5         | $12$ | $\\le 10^7$      | $\\le 10^9$        |\r\n| 6         | $9$  | $\\le 10^9$      | $\\le 10^9$        |\r\n| 7         | $11$ | $\\le 10^{11}$   | $\\le 10^{11}$     |\r\n| 8         | $10$ | $\\le 10^{13}$   | $\\le 10^{13}$     |\r\n| 9         | $10$ | $\\le 10^{15}$   | $\\le 10^{15}$     |\r\n| 10        | $8$  | $\\le 10^{13}$   | $\\le 5 \\times 10^{15}$ |\r\n| 11        | $17$ | $\\le 3\\times 10^{15}$ | $\\le 3\\times 10^{15}$   |\r\n| 12        | $5$ | $\\le 1.5\\times 10^{16}$   | $\\le 1.5\\times 10^{16}$     |\r\n"}]}