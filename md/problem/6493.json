{"title":"graph","time_limit":1000,"memory_limit":256,"tags":["最小生成树","单调队列","笛卡尔树 / Kruskal 重构树","瓶颈路","数据结构","图论"],"operation":{"submit":"https://loj.ac/problem/6493#submit_code","submissions":"https://loj.ac/submissions?problem_id=6493","statistics":"https://loj.ac/problem/6493/statistics/fastest","testdata":"https://loj.ac/problem/6493/testdata","discussion":"https://loj.ac/discussion/problem/6493"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"给定一张 $n$ 个点，$m$ 条边的无向图，边有边权，每一个点都有一种颜色 $c_{i}$。\r\n\r\n一个友好点对是指一个无序点对其为两个点的颜色差 $\\geq L$。\r\n\r\n两个点之间的最短路径定义为最小的权值 $d$ 使得存在一条只经过权值 $\\leq d$ 的边的路径。\r\n\r\n求所有友好点对之间最短路径之和。\r\n"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"输入的第一行给出三个数，即上述的 $n, m, L$。\r\n\r\n接下来一行有 $n$ 个数，表示每一个点的颜色 $c_i$。\r\n\r\n接下来 $m$ 行表示每条边，每行将给出三个数 $u_i, v_i, w_i$，表示点 $u_i$ 和点 $v_i$ 之间有一条长为 $w_i$ 的边。\r\n\r\n保证整张图连通。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出一个数，表示所有友好点对之间的最短路径之和。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"##### 样例输入\r\n```plain\r\n4 5 2\r\n6 4 5 2\r\n1 2 8\r\n2 3 7\r\n2 4 8\r\n1 3 2\r\n1 4 1\r\n```\r\n\r\n##### 样例输出\r\n```plain\r\n17\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"$1 \\leq n \\leq 200000$\r\n\r\n$1 \\leq m \\leq 400000$\r\n\r\n$1 \\leq w_i, c_i \\leq 10^8$"}]}