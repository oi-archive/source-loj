{"title":"「清华集训 2017」生成树计数","time_limit":5000,"memory_limit":1024,"tags":["2017","清华集训","多项式 / 形式幂级数","DFT（含 NTT）及FFT","生成函数","数学","分治"],"operation":{"submit":"https://loj.ac/problem/2320#submit_code","submissions":"https://loj.ac/submissions?problem_id=2320","statistics":"https://loj.ac/problem/2320/statistics/fastest","testdata":"https://loj.ac/problem/2320/testdata","discussion":"https://loj.ac/discussion/problem/2320"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"在一个 $s$ 个点的图中，存在 $s-n$ 条边，使图中形成了 $n$ 个连通块，第 $i$ 个连通块中有 $a_i$ 个点。\r\n\r\n现在我们需要再连接 $n-1$ 条边，使该图变成一棵树。对一种连边方案，设原图中第 $i$ 个连通块连出了 $d_i$ 条边，那么这棵树 $T$ 的价值为：\r\n\r\n$$ \\mathrm{val}(T) = \\left(\\prod_{i=1}^{n} {d_i}^m\\right)\\left(\\sum_{i=1}^{n} {d_i}^m\\right) $$\r\n\r\n你的任务是求出所有可能的生成树的价值之和，对 $998244353$ 取模。\r\n"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"输入的第一行包含两个整数 $n,m$，意义见题目描述。\r\n\r\n接下来一行有 $n$ 个整数，第 $i$ 个整数表示 $a_i$ $(1\\le a_i< 998244353)$。\r\n\r\n* 你可以由 $a_i$ 计算出图的总点数 $s$，所以在输入中不再给出 $s$ 的值。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出包含一行一个整数，表示答案。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"####  样例输入 1\r\n```plain\r\n3 1\r\n2 3 4\r\n```\r\n####  样例输出 1\r\n\r\n```plain\r\n1728\r\n```\r\n\r\n####  样例解释 1\r\n\r\n令 $i$ 表示大小为 $i$ 的原连通块，我们在连通块之间的连边有以下三种可能:\r\n- $2-3-4$\r\n- $3-2-4$\r\n- $2-4-3$\r\n\r\n价值和为:\r\n$$(2×3^2 ×4×2+3×2^2 ×4×2+2×4^2 ×3×2)×(1+2+1)=1728$$\r\n\r\n\r\n#### 样例 2\r\n\r\n见附加文件"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"本题共有 $20$ 个测试点，每个测试点 $5$ 分。 \r\n\r\n- $20\\%$ 的数据中，$n\\le500$。\r\n\r\n- 另外 $20\\%$ 的数据中，$n \\le 3000$。\r\n\r\n- 另外 $10\\%$ 的数据中，$n \\le 10010, m = 1$。 \r\n\r\n- 另外 $10\\%$的数据中，$n \\le 10015,m = 2$。 \r\n\r\n- 另外 $20\\%$ 的数据中，所有 $a_i$ 相等。\r\n\r\n- $100\\%$ 的数据中，$n \\le 3\\times 10^4,m \\le 30$。  \r\n\r\n其中，每一个部分分的测试点均有一定梯度。"}]}