{"title":"「2019 集训队互测 Day 3」组合数求和","time_limit":3000,"memory_limit":256,"tags":["集训队互测","2019"],"operation":{"submit":"https://loj.ac/problem/3075#submit_code","submissions":"https://loj.ac/submissions?problem_id=3075","statistics":"https://loj.ac/problem/3075/statistics/fastest","testdata":"https://loj.ac/problem/3075/testdata","discussion":"https://loj.ac/discussion/problem/3075"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"定义 $f(j)\\ \\equiv\\ \\sum_{i=0}^{n-1}\\ C_{i\\cdot d}^{j}\\ (\\bmod\\ M),\\ 0\\ \\leq\\ f(j)\\ <\\ M$，其中 $n,\\ d,\\ M$ 为给定值。\r\n\r\n现在给定 $m$，输出 $f(0)\\ \\mathrm{xor}\\ f(1)\\ \\mathrm{xor}\\ f(2)\\ \\mathrm{xor}\\ \\cdots\\ \\mathrm{xor}\\ f(m\\ -\\ 1)$ 的值。\r\n\t\r\n其中 $C_{n}^{m}$ 为组合数 $n$ 选 $m$，即 $C_{n}^{m}\\ =\\ \\begin{cases}\\frac{n!}{m!\\cdot (n-m)!}&, 0\\leq m\\leq n \\cr 0&, \\text{otherwise}\\end{cases}$。$\\mathrm{xor}$ 表示异或和。\r\n"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"一行四个整数 $n,\\ m,\\ d,\\ M$，由空格隔开。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"一行一个整数表示答案。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入一\r\n\r\n```\r\n3 2 3 998244353\r\n```\r\n\r\n#### 样例输出一\r\n\r\n```\r\n10\r\n```\r\n\r\n#### 样例一解释\r\n$f(0)\\ \\equiv\\ C_0^0\\ +\\ C_3^0\\ +\\ C_6^0\\ \\equiv\\ 1\\ +\\ 1\\ +\\ 1\\ \\equiv\\ 3\\ (\\bmod\\ 998244353)$\r\n\r\n$f(1)\\ \\equiv\\ C_0^1\\ +\\ C_3^1\\ +\\ C_6^1\\ \\equiv\\ 0\\ +\\ 3\\ +\\ 6\\ \\equiv\\ 9\\ (\\bmod\\ 998244353)$\r\n\r\n$f(0)\\ \\mathrm{xor}\\ f(1)\\ =\\ 3\\ \\mathrm{xor}\\ 9\\ =\\ 10$\r\n"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"本题采用捆绑测试。\r\n\t\r\n对于所有测试包均满足 $1\\ \\leq\\ d\\ \\leq\\ 100,\\ 1\\ \\leq\\ m\\cdot d\\ \\leq\\ 3\\times 10^6,\\ 1\\ \\leq\\ n\\cdot d\\ \\leq\\ 10^9,\\ 10^8\\ \\leq\\ M\\ \\leq\\ 10^9$。\r\n\t\r\n| 测试包编号 | 测试包分值 | 其它约定 |\r\n| :-----: | :-----: | :-----: |\r\n| $1$ | $4$ | $n\\cdot d,\\ m\\ \\leq\\ 2000$ |\r\n| $2$ | $10$ | $m\\ \\leq\\ 400$ |\r\n| $3$ | $6$ | $m\\ \\leq\\ 8000,\\ M\\ =\\ 998244353$ |\r\n| $4$ | $6 $ | $m\\ \\leq\\ 8000$ |\r\n| $5$ | $7$ | $d\\ =\\ 1$ |\r\n| $6$ | $22$ | $\\gcd(d,\\ M)\\ =\\ 1$ |\r\n| $7 $ | $7$ | $d\\ =\\ 2$ |\r\n| $8$ | $7 $ | $d\\ =\\ 4$ |\r\n| $9$ | $8$ | $d$ 为质数 |\r\n| $10$ | $23$ | 无 |"}]}