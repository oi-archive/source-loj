{"title":"「JOISC 2017 Day 4」Dragon 2","time_limit":3000,"memory_limit":256,"tags":["2017","JOISC","子任务"],"operation":{"submit":"https://loj.ac/problem/2401#submit_code","submissions":"https://loj.ac/submissions?problem_id=2401","statistics":"https://loj.ac/problem/2401/statistics/fastest","testdata":"https://loj.ac/problem/2401/testdata","discussion":"https://loj.ac/discussion/problem/2401"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"**题目译自 [JOISC 2017](https://www.ioi-jp.org/camp/2017/2017-sp-tasks/index.html) Day4 T3「[ドラゴン 2](https://www.ioi-jp.org/camp/2017/2017-sp-tasks/2017-sp-d4.pdf) / [Dragon 2](https://www.ioi-jp.org/camp/2017/2017-sp-tasks/2017-sp-d4-en.pdf)」**\r\n\r\n在一个平面直角坐标系上有 $N$ 条龙，编号为 $1\\dots N$；龙有 $M$ 支种族，编号为 $1\\ldots M$。  \r\n$i$ 号龙 $(1\\le i\\le N)$ 位于 $(A_i, B_i)$，它属于种族 $C_i$。有可能有些种族已经没有龙了。  \r\nJOI 平原上有一条路，这条路可视为一条线段，端点坐标分别为 $(D_1, E_1)$ 和 $(D_2, E_2)$。  \r\n上文中提到的所有坐标互不相同，且没有三点共线。  \r\n不同种族的龙之间会发生冲突。现给出 $Q$ 种冲突，每种冲突用两个整数 $F_j, G_j$ 来描述 $(1\\le j\\le Q, 1\\le F_j, G_j\\le M)$，意为种族 $F_j$ 敌视种族 $G_j$。此时，种族 $F_j$ 的每一条龙会向种族 $G_j$ 的每一条龙发射一个火球。火球轨迹是一条**射线**，打到对方的龙身上后，火球会穿过龙，沿着刚才的方向继续飞行。保证此后种族 $F_j$ 不会再次敌视种族 $G_j$。  \r\n火球会烧坏道路。对于给出的 $Q$ 种冲突，求其中有多少个火球会烧坏道路。  "},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行有两个整数 $N, M$ ，用空格分隔。  \r\n在接下来的 $N$ 行中，第 $i$ 行 $(1\\le i\\le N)$ 有三个整数 $A_i, B_i, C_i$ 。  \r\n第 $N + 2$ 行有四个整数 $D_1, E_1, D_2, E_2$ ，用空格分隔。  \r\n第 $N + 3$ 行有一个整数 $Q$ 。  \r\n在接下来的 $Q$ 行中，第 $j$ 行 $(1\\le i\\le Q)$ 有两个用空格分隔的整数 $F_j, G_j$ 。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出共 $Q$ 行，每行一个整数，表示在第 $j$ 种冲突之中，有多少个火球会烧坏道路。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n4 2\r\n0 1 1\r\n0 -1 1\r\n1 2 2\r\n-6 1 2\r\n-2 0 2 0\r\n2\r\n1 2\r\n2 1\r\n```\r\n\r\n#### 样例输出 1\r\n```plain\r\n1\r\n2\r\n```\r\n\r\n#### 样例解释 1\r\n在第一种冲突中：\r\n* 2 号龙向 3 号龙发射的火球会烧坏道路。\r\n* 1 号龙向 3 号龙、1 号龙向 4 号龙、2 号龙向 4 号龙发射的火球不会烧坏道路。\r\n\r\n在第二种冲突中：\r\n* 3 号龙向 1 号龙、3 号龙向 2 号龙发射的火球会烧坏道路。\r\n* 4 号龙向 1 号龙、4 号龙向 2 号龙发射的火球不会烧坏道路。\r\n\r\n#### 样例输入 2\r\n```plain\r\n3 2\r\n-1000000000 -1 1\r\n-999999998 -1 1\r\n0 0 2\r\n999999997 1 999999999 1\r\n1\r\n1 2\r\n```\r\n\r\n#### 样例输出 2\r\n```plain\r\n1\r\n```\r\n\r\n#### 样例输入 3\r\n```plain\r\n6 3\r\n2 -1 1\r\n1 0 1\r\n0 3 2\r\n2 4 2\r\n5 4 3\r\n3 9 3\r\n0 0 3 3\r\n6\r\n1 2\r\n1 3\r\n2 1\r\n2 3\r\n3 1\r\n3 2\r\n```\r\n\r\n#### 样例输出 3\r\n```plain\r\n4\r\n2\r\n4\r\n0\r\n2\r\n1\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于 $15\\%$ 的数据，$N\\le 3000$。  \r\n对于另外 $45\\%$ 的数据，$Q\\le 100$。  \r\n对于所有数据，$2\\le M\\le N\\le 3\\times 10^4, 1\\le Q\\le 5\\times 10^4$ ，所有点的横坐标绝对值、纵坐标绝对值均 $\\le 10^9$ ，所有点互不相同，没有三点共线， "}]}