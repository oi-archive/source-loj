{"title":"「TJOI / HEOI2016」树","time_limit":1000,"memory_limit":256,"tags":["2016","TJOI","HEOI","并查集","树链剖分"],"operation":{"submit":"https://loj.ac/problem/2054#submit_code","submissions":"https://loj.ac/submissions?problem_id=2054","statistics":"https://loj.ac/problem/2054/statistics/fastest","testdata":"https://loj.ac/problem/2054/testdata","discussion":"https://loj.ac/discussion/problem/2054"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"在 2016 年，佳媛姐姐刚刚学习了树，非常开心。现在他想解决这样一个问题：给定一颗有根树（根为 $1$），有以下两种操作：\r\n\r\n1. 标记操作：对某个结点打上标记（在最开始，只有结点 $ 1 $ 有标记，其他结点均无标记，而且对于某个结点，可以打多次标记）。\r\n2. 询问操作：询问某个结点最近的一个打了标记的祖先（这个结点本身也算自己的祖先）。\r\n\r\n你能帮帮他吗?"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"输入第一行两个正整数 $ N $ 和 $ Q $ 分别表示节点个数和操作次数。  \r\n接下来 $ N-1 $ 行，每行两个正整数 $ u , v $（$ 1 \\leq u,v \\leq n $）表示 $ u $ 到 $ v $ 有一条有向边。  \r\n接下来 $ Q $ 行，形如 $\\text{oper}\\  \\text{num}$。$\\text{oper}$ 为 `C` 时表示这是一个标记操作，$\\text{oper}$ 为 `Q` 时表示这是一个询问操作。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出一个正整数，表示结果。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n```plain\r\n5 5\r\n1 2\r\n1 3\r\n2 4\r\n2 5\r\nQ 2\r\nC 2\r\nQ 2\r\nQ 5\r\nQ 3\r\n```\r\n\r\n#### 样例输出\r\n```plain\r\n1 \r\n2 \r\n2 \r\n1\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于每次询问操作，$1 \\leq N, Q \\leq 100000$。"}]}