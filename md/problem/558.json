{"title":"「Antileaf's Round」我们的 CPU 遭到攻击","time_limit":1000,"memory_limit":512,"tags":["Special Round","Link-Cut Tree","数据结构"],"operation":{"submit":"https://loj.ac/problem/558#submit_code","submissions":"https://loj.ac/submissions?problem_id=558","statistics":"https://loj.ac/problem/558/statistics/fastest","testdata":"https://loj.ac/problem/558/testdata","discussion":"https://loj.ac/discussion/problem/558"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"![攻击](https://img.51nod.com/upload/000FC451/08D576048B317F390000000000000086.png)\r\n\r\n给你一个有 $n$ 个点的森林，点有黑白两种颜色，初始时所有点都是白色，森林的每条边有边权，初始时这个森林有 $m$ 条边。  \r\n对这个森林进行 $k$ 次操作，操作有三种：\r\n\r\n* `L u v w`：添加一条连接 $u$ 和 $v$，长度为 $w$ 的边。  \r\n* `C u v`：删除连接 $u$ 和 $v$ 的边（保证存在）。  \r\n* `F u`：反转点 $u$ 的颜色（黑变白，白变黑）。  \r\n* `Q u`：询问所有与 $u$ 相连的黑点到 $u$ 的距离之和。（**相连指的是在同一连通块中**）"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行三个非负整数，分别表示 $n$，$m$，$k$。  \r\n以下 $m$ 行，每行三个整数 $u$，$v$，$w$，表示初始时有一条边连接 $u$ 和 $v$，长度为 $w$。  \r\n以下 $k$ 行，每行描述一个操作，格式如上所述。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"对于每个 $ Q $ 操作，单独一行输出一个整数表示答案。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n\r\n```plain\r\n5 2 7\r\n1 2 5\r\n3 5 -13\r\nQ 2\r\nF 5\r\nL 3 4 -2\r\nQ 4\r\nL 2 4 7\r\nC 1 2\r\nQ 2\r\n```\r\n\r\n#### 样例输出\r\n\r\n```plain\r\n0\r\n-15\r\n-8\r\n```\r\n\r\n#### 样例解释\r\n\r\n我已经想到了一个绝妙的解释，可是地方太小，写不下了。"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"$0\\le k< n\\le 10^5$，$m\\le 3\\times 10^5$，$|w|\\le 10^7$，保证任何时刻这个图均为森林（即不会出现环）。"}]}