{"title":"yww 与连通块计数","time_limit":1000,"memory_limit":512,"tags":["原创","树形 DP","FWT","DP"],"operation":{"submit":"https://loj.ac/problem/6400#submit_code","submissions":"https://loj.ac/submissions?problem_id=6400","statistics":"https://loj.ac/problem/6400/statistics/fastest","testdata":"https://loj.ac/problem/6400/testdata","discussion":"https://loj.ac/discussion/problem/6400"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"　　蒟蒻yww发现了一棵 $n$ 个点的树。树上的每个点都有一个权值 $a_i$ 。\r\n\r\n　　yww想选出一个连通块，这个连通块不能是空的。\r\n\r\n　　这个连通块必须满足某种条件。具体来说，连通块内的点必须满足所有点的点权的 $\\gcd=s1$ 且所有点的点权的 $\\operatorname{lcm}=s2$ 。\r\n\r\n　　yww想计算有多少种合法的方案，于是就来向你求助。\r\n\r\n　　由于方案数很多，所以你只需要输出方案数 $1000000007$ 的值。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"　　第一行有三个整数： $n,s1,s2$ 。\r\n\r\n　　第二行有 $n$ 个整数：第 $i$ 个数是 $a_i$ 。\r\n\r\n　　接下来 $n−1$ 行每行有两个整数： $x,y$ ，表示第 $x$ 个点和第 $y$ 个点之间有一条边。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"　　输出一个整数：答案。\r\n\r\n　　对 $1000000007$ 取模。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"### 样例一\r\n#### input\r\n<pre>\r\n3 1 2\r\n1 2 2\r\n1 2\r\n1 3\r\n\r\n</pre>\r\n\r\n#### output\r\n<pre>\r\n3\r\n\r\n</pre>\r\n\r\n#### explanation\r\n　　总共有 $3$ 种方案：$\\{1,2\\},\\{1,3\\},\\{1,2,3\\}$。"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"　　子任务 $1$（$5$ 分）：$n\\leq 20,s2\\leq {10}^3$。\r\n\r\n　　子任务 $2$（$5$ 分）：$n\\leq 1000,s2=1$。\r\n\r\n　　子任务 $3$（$10$ 分）：$n\\leq 1000,s2\\leq {10}^3$。\r\n\r\n　　子任务 $4$（$10$ 分）：$n\\leq 1000,s2\\leq {10}^5$。\r\n\r\n　　子任务 $5$（$10$ 分）：$n\\leq 1000,s2\\leq {10}^7$。\r\n\r\n　　子任务 $6$（$20$ 分）：$n\\leq 1000,s2\\leq {10}^{10}$。\r\n\r\n　　子任务 $7$（$40$ 分）：$n\\leq 1000,s2\\leq {10}^{18}$。\r\n\r\n　　对于 $100\\%$ 的数据，$1\\leq n\\leq 1000,1\\leq a_i,s1,s2\\leq {10}^{18},s1∣a_i,a_i∣s2$，保证 $s2$ 的所有质因子都不大于 $50$ 且 $\\nexists i>1$ 满足 $i^2\\mid s2$ （就是 $s2$ 没有平方因子的意思）。\r\n\r\n　　题目来源：全是水题的GDOI模拟赛 by yww"}]}