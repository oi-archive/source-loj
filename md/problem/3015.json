{"title":"「COCI 2014.12」MRAVI","time_limit":1000,"memory_limit":32,"tags":["2014","COCI"],"operation":{"submit":"https://loj.ac/problem/3015#submit_code","submissions":"https://loj.ac/submissions?problem_id=3015","statistics":"https://loj.ac/problem/3015/statistics/fastest","testdata":"https://loj.ac/problem/3015/testdata","discussion":"https://loj.ac/discussion/problem/3015"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"**译自 [COCI 2014/2015 Contest #4](https://www.hsin.hr/coci/archive/2014_2015/) T4「[MRAVI](https://www.hsin.hr/coci/archive/2014_2015/contest4_tasks.pdf)」**\r\n\r\n小 Bobi 每天起床后的首要任务是给他的宠物蚂蚁喂食。\r\n\r\n他把它们放在一个玻璃容器里，里面是一个管道系统，可以用一棵有 $N$ 个结点且根节点为 $1$ 的树表示，每条管道对应树中的边。  \r\n在这个系统中，液体**从某个结点流向这个结点的儿子**。\r\n\r\n我们知道每条管道的流量 $X_i$，即从父亲结点经过这条管道流到儿子结点的液体百分比。  \r\n让我们来研究一下这个例子：\r\n\r\n![Example](https://loj-img.upyun.menci.memset0.cn/2019/03/03/5c7b406bb5857.png)\r\n\r\n图中，结点 $1$ 有着 $12$ 升液体和两条管道连接。其中一条管道 $X_i = 30$，另一条 $X_i = 70$。  \r\n那么，结点 $2$ 将会获得 $3.6$ 升液体，结点 $3$ 将会获得 $8.4$ 升液体。  \r\n在给定的数据中，保证一个结点连接的所有管道的 $X_i$ 之和为 $100$。\r\n\r\n不过，Bobi 有些管道开了挂，可以让流经的液体变成原来的平方。  \r\n比如，如果上述第一条管道开了挂，那么结点 $2$ 获得的液体将会变成 $12.96$ 升，但结点 $3$ 获得的液体仍是 $8.4$ 升。  \r\n这个挂的神奇之处在于，一个结点流出的液体可能大于流进这个结点的液体！\r\n\r\n蚂蚁只住在叶子结点上。对于每个叶子结点，给定该结点的蚂蚁所需的液体量 $K_i$。Bobi 将会往根结点倒入 $L$ 升液体。  \r\nBobi 想知道，他至少要倒入多少升液体，才能喂饱所有蚂蚁，即求满足条件的最小的 $L$。\r\n\r\n数据保证 $L$ 不超过 $2 \\cdot 10^9$。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行，一个整数 $N$。  \r\n接下来 $N-1$ 行，每行四个整数 $A_i,B_i,X_i,T_i$，表示有一条连接 $A_i,B_i$ 的管道，流量为 $X_i$，开挂情况为 $T_i$，为 $1$ 时开挂否则不开。  \r\n接下来一行，$N$ 个整数 $K_i$，表示每个结点的蚂蚁所需的液体量。如果第 $i$ 个结点不是叶子，$K_i = -1$。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"一行，最小的 $L$。  \r\n误差最多为 $0.001$。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n5\r\n1 2 50 0\r\n1 3 50 0\r\n2 4 25 0\r\n2 5 75 1\r\n-1 -1 4 1 9\r\n```\r\n\r\n#### 样例输出 1\r\n```plain\r\n8.00\r\n```\r\n\r\n#### 样例解释 1\r\n如果 Bobi 往根结点倒入 $8$ 升液体，那么结点 $3,4,5$ 分别会获得 $4,1,9$。  \r\n这些都是叶子结点，并且得到的液体刚刚好。同时 $8$ 也是最优解。\r\n\r\n#### 样例输入 2\r\n```plain\r\n3\r\n1 2 20 1\r\n1 3 80 1\r\n-1 4 8\r\n```\r\n\r\n#### 样例输出 2\r\n```plain\r\n10.0000\r\n```\r\n\r\n#### 样例输入 3\r\n```plain\r\n6\r\n1 2 100 1\r\n2 3 20 0\r\n2 4 20 0\r\n2 5 60 0\r\n4 6 100 1\r\n-1 -1 1 -1 1 2\r\n```\r\n\r\n#### 样例输出 3\r\n```plain\r\n2.659\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"$1 \\le A_i,B_i \\le N \\le 1000,1 \\le X_i \\le 100,0 \\le T_i \\le 1$。"}]}