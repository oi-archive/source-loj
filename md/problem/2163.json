{"title":"「POI2011 R2 Day2」旋转树木 Tree Rotations ","time_limit":160,"memory_limit":256,"tags":["POI","2011","线段树","启发式合并","数据结构"],"operation":{"submit":"https://loj.ac/problem/2163#submit_code","submissions":"https://loj.ac/submissions?problem_id=2163","statistics":"https://loj.ac/problem/2163/statistics/fastest","testdata":"https://loj.ac/problem/2163/testdata","discussion":"https://loj.ac/discussion/problem/2163"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"**译自 POI 2011 Round 2. Day 2. A「[Tree Rotations](https://szkopul.edu.pl/problemset/problem/sUe3qzxBtasek-RAWmZaxY_p/site/?key=statement)」**\r\n\r\n园丁 Byteasar 正在种植一种叫 Rotatus Informatikus 的珍稀树种。它有一些有趣的特性：\r\n- 树包含直的树枝，分叉和叶子。从地上长出来的树干也算树枝；\r\n- 每根树枝要么以一个分叉点结束，要么以在顶端的一片叶子结束；\r\n- 从一根树枝末端的分叉点恰好长出两根树枝——左树枝和右树枝；\r\n- 树上每片叶子都用 $1\\ldots n$ 范围内的整数编号。叶子编号两两不同；\r\n- 通过一些园艺操作，在每个分叉点处可以进行一种叫「旋转」的操作，可以交换从这个分叉点长出的左右树枝。\r\n\r\n**树冠**是从左到右读取叶子上的数而得到的序列。\r\n\r\nByteasar 是 Byteburg 人，就像所有真正的 Byteburg 人一样，他赞美整洁和秩序。他想知道进行一些旋转操作后，他的树会变得多整洁。树的整洁度用树冠的逆序对数表示。即序列 $a_1,a_2,\\ldots ,a_n$ 中满足 $1\\le i<j\\le n,a_i\\gt a_j$ 的数对 $(i,j)$ 的个数。\r\n\r\n![rys-crop.gif](https://szkopul.edu.pl/problemset/problem/sUe3qzxBtasek-RAWmZaxY_p/site/images/OI18/rys-crop.gif)\r\n\r\n左边原树的树冠 $3,1,2$ 有两个逆序对。在一次旋转过后变成右边的数，树冠是 $1,3,2$，只有一个逆序对。这两棵树都有 $5$ 根树枝。\r\n\r\n写一个程序，求出 Byteasar 的树经过旋转后树冠的最少逆序对数。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行一个整数 $n$，表示表示 Byteasar 的树的叶子数。\r\n\r\n接下来描述这棵树，这棵树利用递归定义：\r\n- 如果在树干末端是一片标有 $p$ 的叶子（即，直接从地上长出来的树枝），那么对于这棵树的描述只包含一行一个整数 $p$；\r\n- 如果在树干末端有分叉，那么这棵树的描述包含以下三部分：\r\n    - 第一行包含一个整数 $0$；\r\n    - 接下来是对左子树的描述（假设从分叉点分出的左树枝是左子树的树干）；\r\n    - 最后是对右子树的描述（假设从分叉点分出的右树枝是右子树的树干）。\r\n"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"一行一个整数，表示树冠的最少逆序对数。\r\n"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入\r\n```plain\r\n3\r\n0\r\n0\r\n3\r\n1\r\n2\r\n```\r\n#### 样例输出\r\n```plain\r\n1\r\n```\r\n#### 样例说明\r\n树与旋转情况如「题目描述」中所示。\r\n"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于全部数据，$1\\le n\\le 2\\times 10^5,1\\le p\\le n$；\r\n\r\n对于 $30\\%$ 的分数，保证 $n\\le 5\\times 10^3$。\r\n\r\n\r\nTask authors: Tomasz Kociumaka, Tomasz Walen."}]}