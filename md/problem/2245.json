{"title":"「NOI2014」魔法森林","time_limit":1000,"memory_limit":256,"tags":["NOI","2014","Link-Cut Tree","数据结构"],"operation":{"submit":"https://loj.ac/problem/2245#submit_code","submissions":"https://loj.ac/submissions?problem_id=2245","statistics":"https://loj.ac/problem/2245/statistics/fastest","testdata":"https://loj.ac/problem/2245/testdata","discussion":"https://loj.ac/discussion/problem/2245"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"为了得到书法大家的真传，小 E 同学下定决心去拜访住在魔法森林中的隐士。\r\n\r\n魔法森林可以被看成一个包含 $N$ 个节点 $M$ 条边的无向图，节点标号为 $1,\\ldots,N$，边标号为 $1,\\ldots,M$。初始时小 E 同学在号节点 $1$，隐士则住在 $N$ 号节点。小 E 需要通过这一片魔法森林，才能够拜访到隐士。\r\n\r\n魔法森林中居住了一些妖怪。每当有人经过一条边的时候，这条边上的妖怪就会对其发起攻击。幸运的是，在 $1$ 号节点住着两种守护精灵：$A$ 型守护精灵与 $B$ 型守护精灵。小 E 可以借助它们的力量，达到自己的目的。\r\n\r\n只要小 E 带上足够多的守护精灵，妖怪们就不会发起攻击了。具体来说，无向图中的每一条边 $E_i$ 包含两个权值 $A_i$ 与 $B_i$。若身上携带的 A 型守护精灵个数不少于 $A_i$，且 $B$ 型守护精灵个数不少于 $B_i$，这条边上的妖怪就不会对通过这条边的人发起攻击。当且仅当通过这片魔法森林的过程中没有任意一条边的妖怪向小 E 发起攻击，他才能成功找到隐士。\r\n\r\n由于携带守护精灵是一件非常麻烦的事，小 E 想要知道，要能够成功拜访到隐士，最少需要携带守护精灵的总个数。守护精灵的总个数为 $A$ 型守护精灵的个数与 $B$ 型守护精灵的个数之和。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行包含两个整数 $N,M$，表示无向图共有 $N$ 个节点，$M$ 条边。  \r\n接下来 $M$ 行，第 $i$ 行包含四个正整数 $X_i,Y_i,A_i,B_i$，描述第 $i$ 条无向边。其中 $X_i$ 与 $Y_i$ 为该边两个端点的标号，$A_i$ 与 $B_i$ 的含义如题所述。 \r\n\r\n**注意**：数据中可能包含重边与自环。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出一行一个整数：如果小 E 可以成功拜访到隐士，输出小 E 最少需要携带的守护精灵的总个数；  \r\n如果无论如何小 E 都无法拜访到隐士，输出 “``-1``”（不含引号）。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n4 5\r\n1 2 19 1\r\n2 3 8 12\r\n2 4 12 15\r\n1 3 17 8\r\n3 4 1 17\r\n```\r\n\r\n#### 样例输出 1\r\n```plain\r\n32\r\n```\r\n\r\n#### 样例解释 1\r\n如果小 E 走路径 $1\\rightarrow2\\rightarrow4$，需要携带 $19+15=34$ 个守护精灵；  \r\n如果小 E 走路径 $1\\rightarrow3\\rightarrow4$，需要携带 $17+17=34$ 个守护精灵；  \r\n如果小 E 走路径 $1\\rightarrow2\\rightarrow3\\rightarrow4$，需要携带 $19+17=36$ 个守护精灵；  \r\n如果小 E 走路径 $1\\rightarrow3\\rightarrow2\\rightarrow4$，需要携带 $17+15=32$ 个守护精灵。  \r\n综上所述，小 E 最少需要携带 $32$ 个守护精灵。\r\n\r\n#### 样例输入 2\r\n```plain\r\n3 1\r\n1 2 1 1\r\n```\r\n\r\n#### 样例输出 2\r\n```plain\r\n-1\r\n```\r\n\r\n#### 样例解释 2\r\n小 E 无法从 $1$ 号节点到达 $3$ 号节点，故输出 ``-1``。"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对所有的数据，$2 \\leq n \\leq 50000,\\ 0 \\leq m \\leq 100000,\\ 1 \\leq a_i ,b_i \\leq 50000$。"}]}