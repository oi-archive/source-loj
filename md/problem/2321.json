{"title":"「清华集训 2017」无限之环","time_limit":1000,"memory_limit":512,"tags":["2017","清华集训","费用流","状态压缩","轮廓线 DP","插头 DP","网络流","DP"],"operation":{"submit":"https://loj.ac/problem/2321#submit_code","submissions":"https://loj.ac/submissions?problem_id=2321","statistics":"https://loj.ac/problem/2321/statistics/fastest","testdata":"https://loj.ac/problem/2321/testdata","discussion":"https://loj.ac/discussion/problem/2321"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"曾经有一款流行的游戏，叫做 ***Infinity Loop***，先来简单的介绍一下这个游戏:    \r\n\r\n游戏在一个 $n \\times m$ 的网格状棋盘上进行，其中有些小方格中会有水管，水管可能在方格某些方向的边界的中点有接口，所有水管的粗细都相同，所以如果两个相邻方格的公共边界的中点都有接头，那么可以看作这两个接头互相连接。水管有以下 $15$ 种形状：\r\n\r\n<img width = 39% src=\"https://i.loli.net/2017/12/04/5a252045dc57f.png\" alt=\"Screen Shot 2017-12-04 at 18.13.48.png\" title=\"Screen Shot 2017-12-04 at 18.13.48.png\" />\r\n<img width = 40% src=\"https://i.loli.net/2017/12/04/5a25204638476.png\" alt=\"Screen Shot 2017-12-04 at 18.13.55.png\" title=\"Screen Shot 2017-12-04 at 18.13.55.png\" />\r\n\r\n游戏开始时，棋盘中水管可能存在漏水的地方。  \r\n\r\n形式化地:如果存在某个接头，没有和其它接头相连接，那么它就是一个漏水的地方。  \r\n\r\n玩家可以进行一种操作：选定一个含有**非直线型**水管的方格，将其中的水管绕方格中心顺时针或逆时针旋转 $90$ 度。  \r\n\r\n直线型水管是指左图里中间一行的两种水管。  \r\n\r\n现给出一个初始局面，请问最少进行多少次操作可以使棋盘上不存在漏水的地方。\r\n\r\n\r\n"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行两个正整数 $n,m$，代表网格的大小。  \r\n\r\n接下来 $n$ 行每行 $m$ 个数，每个数是 $[0,15]$ 中的一个，你可以将其看作一个 $4$ 位的二进制数，从低到高每一位分别代表初始局面中这个格子上、右、下、左方向上是否有 水管接头。  \r\n\r\n特别地，如果这个数是 $0$，则意味着这个位置没有水管。  \r\n\r\n比如 $3(0011_{(2)})$ 代表上和右有接头，也就是一个 L 型，而 $12(1100_{(2)})$ 代表下和左有接头，也就是将 L 型旋转 $180$ 度。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出共一行，表示最少操作次数。如果无法达成目标，输出 $-1$.\r\n"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain \r\n2 3\r\n3 14 12\r\n3 11 12\r\n```\r\n\r\n#### 样例输出 1\r\n```plain \r\n2 \r\n```\r\n\r\n#### 样例输入 2\r\n```plain \r\n3 2 \r\n1 8 \r\n5 10 \r\n2 4\r\n```\r\n\r\n#### 样例输出 2\r\n```plain \r\n-1\r\n```\r\n#### 样例输入 3\r\n```plain \r\n3 3\r\n9 11 3\r\n13 15 7 \r\n12 14 6\r\n```\r\n\r\n#### 样例输出 3\r\n```plain \r\n16\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"<!-- BEGIN: Migrated markdown table -->\n\n| 测试点编号 | $n\\times m$ 的范围 | 特殊约定 |\n|:-:|:-:|:-:|\n| 1 | $n\\times m \\le 16$ | 无特殊要求 |\n| 2 | $n\\times m \\le 16$ | 无特殊要求 |\n| 3 | $n \\times m \\le 2000$ | $\\min(n,m) \\le 15$ |\n| 4 | $n \\times m \\le 2000$ | $\\min(n,m) \\le 15$ |\n| 5 | $n \\times m \\le 2000$ | $\\min(n,m) \\le 15$ |\n| 6 | $n \\times m \\le 2000$ | $\\min(n,m) \\le 15$ |\n| 7 | $n \\times m \\le 2000$ | $\\min(n,m) \\le 15$ |\n| 8 | $n \\times m \\le 2000$ | $\\min(n,m) \\le 15$ |\n| 9 | $n \\times m \\le 2000$ | 无特殊要求 |\n| 10 | $n \\times m \\le 2000$ | 无特殊要求 |\n| 11 | $n \\times m \\le 2000$ | 无特殊要求 |\n| 12 | $n \\times m \\le 2000$ | 无特殊要求 |\n| 13 | $n \\times m \\le 2000$ | 无特殊要求 |\n| 14 | $n \\times m \\le 2000$ | 无特殊要求 |\n| 15 | $n \\times m \\le 2000$ | 无特殊要求 |\n| 16 | $n \\times m \\le 2000$ | 无特殊要求 |\n| 17 | $n \\times m \\le 2000$ | 无特殊要求 |\n| 18 | $n \\times m \\le 2000$ | 无特殊要求 |\n| 19 | $n \\times m \\le 2000$ | 无特殊要求 |\n| 20 | $n \\times m \\le 2000$ | 无特殊要求 |\n\n<!-- Migrated from original HTML table:\n<table><thead>\r\n<tr>\r\n<th style='text-align:center'>测试点编号</th><th style='text-align:center'>$n\\times m$ 的范围</th><th style='text-align:center'>特殊约定</th></tr>\r\n</thead><tbody>\r\n<tr>\r\n<td style='text-align:center'>1</td><td style='text-align:center' rowspan='2'>$n\\times m \\le 16$ </td><td style='text-align:center' rowspan='2'>无特殊要求</td></tr>\r\n<tr>\r\n<td style='text-align:center'>2</td></tr>\r\n<tr>\r\n<td style='text-align:center'>3</td><td style='text-align:center' rowspan='18'>$n \\times m \\le 2000$ </td><td style='text-align:center' rowspan='6'>$\\min(n,m) \\le 15$ </td></tr>\r\n<tr>\r\n<td style='text-align:center'>4</td></tr>\r\n<tr>\r\n<td style='text-align:center'>5</td></tr>\r\n<tr>\r\n<td style='text-align:center'>6</td></tr>\r\n<tr>\r\n<td style='text-align:center'>7</td></tr>\r\n<tr>\r\n<td style='text-align:center'>8</td></tr>\r\n<tr>\r\n<td style='text-align:center'>9</td><td style='text-align:center' rowspan='12'>无特殊要求</td></tr>\r\n<tr>\r\n<td style='text-align:center'>10</td></tr>\r\n<tr>\r\n<td style='text-align:center'>11</td></tr>\r\n<tr>\r\n<td style='text-align:center'>12</td></tr>\r\n<tr>\r\n<td style='text-align:center'>13</td></tr>\r\n<tr>\r\n<td style='text-align:center'>14</td></tr>\r\n<tr>\r\n<td style='text-align:center'>15</td></tr>\r\n<tr>\r\n<td style='text-align:center'>16</td></tr>\r\n<tr>\r\n<td style='text-align:center'>17</td></tr>\r\n<tr>\r\n<td style='text-align:center'>18</td></tr>\r\n<tr>\r\n<td style='text-align:center'>19</td></tr>\r\n<tr>\r\n<td style='text-align:center'>20</td></tr>\r\n</tbody></table>\n-->\n\n<!-- END: Migrated markdown table -->\r\n"}]}