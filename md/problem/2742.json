{"title":"「JOI Open 2016」销售基因链","time_limit":1500,"memory_limit":1024,"tags":["2016","JOI","线段树","离线","字典树"],"operation":{"submit":"https://loj.ac/problem/2742#submit_code","submissions":"https://loj.ac/submissions?problem_id=2742","statistics":"https://loj.ac/problem/2742/statistics/fastest","testdata":"https://loj.ac/problem/2742/testdata","discussion":"https://loj.ac/discussion/problem/2742"},"statement":[{"title":"题目描述","type":"description","format":"markdown","require":["katex"],"content":"**译自 [JOI Open 2016](https://contests.ioi-jp.org/open-2016/index.html) T2 「RNA 鎖の販売 / Selling RNA Strands」**\r\n\r\n基因库中有 $N$ 个字符串，这些字符串仅由 `A`, `G`, `U`, `C`组成（保证每个字符串都包含四种字母）。  \r\n由 $M$ 组查询，每组查询包含两个字符串 $P,Q$，试求：基因库中有多少个字符串同时存在前缀 $P$ 和后缀 $Q$。  \r\n举个例子，`GAC` 存在前缀 `G`, `GA`, `GAC`，存在后缀 `C`, `AC`, `GAC`，那么我们可以说：`GAC` 同时存在前缀 `GA` 和后缀 `AC`。"},{"title":"输入格式","type":"input_format","format":"markdown","require":["katex"],"content":"第一行有两个整数 $N, M$。  \r\n在接下来的 $N$ 行中，每行一个字符串 $S_i$，表示基因库中的一个字符串。  \r\n在接下来的 $M$ 行中，每行有两个用空格分隔的字符串，表示一组查询。"},{"title":"输出格式","type":"output_format","format":"markdown","require":["katex"],"content":"输出共 $M$ 行，每行一个整数，表示符合查询条件的字符串的数量。"},{"title":"样例","type":"example","format":"markdown","require":["katex"],"content":"#### 样例输入 1\r\n```plain\r\n2 3\r\nAUGC\r\nAGC\r\nG C\r\nAU C\r\nA C\r\n```\r\n\r\n#### 样例输出 1\r\n```plain\r\n0\r\n1\r\n2\r\n```\r\n\r\n#### 样例说明 1\r\n第一组查询：找不到。  \r\n第二组查询：`AUGC` 满足条件。  \r\n第三组查询：`AUGC` 和 `AGC` 满足条件。\r\n\r\n#### 样例输入 2\r\n```plain\r\n3 3\r\nAA\r\nAA\r\nAGA\r\nAA AA\r\nAG GA\r\nAG GA\r\n```\r\n\r\n#### 样例输出 2\r\n```plain\r\n2\r\n1\r\n1\r\n```\r\n\r\n#### 样例说明 2\r\n注意基因库中的字符串可以重复。\r\n\r\n#### 样例输入 3\r\n```plain\r\n8 7\r\nGCGCUACCCCAACACAAGGCAAGAUAUA\r\nG\r\nGGAC\r\nGCGG\r\nU\r\nGCGCUACCCCAACACAAGGCAAGAUGGUC\r\nGCCG\r\nGCGCUGA\r\nGCGCUACCC A\r\nGCGCUACCCC AC\r\nGCG C\r\nGCGC A\r\nG G\r\nG C\r\nG GGA\r\n```\r\n\r\n#### 样例输出 3\r\n```plain\r\n1\r\n0\r\n1\r\n2\r\n3\r\n2\r\n0\r\n```"},{"title":"数据范围与提示","type":"limit_and_hint","format":"markdown","require":["katex"],"content":"对于所有数据，$1\\le N, M,$ $\\textrm{len}(S_i),$ $\\textrm{len}(P_j),$ $\\textrm{len}(Q_j)$ $\\le 10^5,$ $1\\le\\sum\\textrm{len}(S_i),$ $\\sum\\textrm{len}(P_j),$ $\\sum\\textrm{len}(Q_j)$ $\\le 2\\times 10^6$。  \r\n\r\n**子任务 1（10 分）** $\\ \\ N, M, $ $\\textrm{len}(S_i),$ $\\textrm{len}(P_j),$ $\\textrm{len}(Q_j)$ $\\le 100$。  \r\n**子任务 2（25 分）** $\\ \\ N, M\\le 5000$。  \r\n**子任务 3（25 分）** $\\ \\ \\sum\\textrm{len}(S_i),$ $\\sum\\textrm{len}(P_j),$ $\\sum\\textrm{len}(Q_j)$ $\\le 10^5$。  \r\n**子任务 4（40 分）** $\\ \\ $没有额外限制。"}]}